if (self.CavalryLogger) { CavalryLogger.start_js(["MZX97"]); }

__d("MessengerRTCFunnelLogger",["RTCP2PConstants","FunnelLogger","FBRTCConstants","URI","UserAgentData","RTCGroupCallActionTypes","FBRTCCallControlActions","RTCP2PCallActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h=c("RTCP2PConstants").ConnectionStatus,i=c("FBRTCConstants").SignalingProtocol,j="WEB_MESSENGER_RTC_FUNNEL",k=c("FBRTCCallControlActions").Types,l=j+"_append",m=j+"_tags",n=j+"_end",o=null;function p(z){c("FunnelLogger").startFunnel(j);r([z]);q()}function q(){var z={bn:c("UserAgentData").browserName,bv:c("UserAgentData").browserVersion,os:c("UserAgentData").platformName,dn:c("URI").getRequestURI().getDomain().split(".").slice(-2).join(".")};Object.keys(z).forEach(function(A){c("FunnelLogger").addFunnelTag(j,A+":"+(z[A]||"unknown"))})}function r(z){if(window.opener&&window.opener.postMessage&&o){window.opener.postMessage({type:m,nonce:o,tags:z},window.location.origin);return}z.forEach(function(A){c("FunnelLogger").addFunnelTag(j,A)})}function s(z,A){if(window.opener&&window.opener.postMessage&&o){window.opener.postMessage({type:j+"_append",nonce:o,action:z,actionTag:A},window.location.origin);return}if(A===undefined)c("FunnelLogger").appendActionIfNew(j,z);else c("FunnelLogger").appendActionWithTag(j,z,A)}function t(z){if(window.opener&&window.opener.postMessage&&o){window.opener.postMessage({type:j+"_end",nonce:o,action:z},window.location.origin);return}if(z)s(z);c("FunnelLogger").endFunnel(j)}function u(z){o=z}function v(z){var A=function A(event){if(event.origin!==window.location.origin||!event.data||event.data.nonce!==z)return;if(event.data.type===l)s(event.data.action,event.data.actionTag);else if(event.data.type===m)r(event.data.tags);else if(event.data.type===n){t(event.data.action);window.removeEventListener("message",A)}};window.addEventListener("message",A)}function w(z,A){switch(z){case k.RECEIVED_SIGNALING_MESSAGE:break;case"END_CALL":s(z,A);t();break;default:s(z,A)}}function x(z,A){switch(A.type){case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:case c("RTCGroupCallActionTypes").SET_CALL_SUMMARY:case c("RTCGroupCallActionTypes").SET_DOMINANT_SPEAKER:case c("RTCGroupCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS:case c("RTCGroupCallActionTypes").SET_GRID_VIEW:case c("RTCGroupCallActionTypes").SET_STRIP_VIEW:case c("RTCP2PCallActionTypes").SET_REMOTE_SIGNALING_EXPERIMENTS:case c("RTCP2PCallActionTypes").SET_CALL_TYPE:case c("RTCP2PCallActionTypes").P2P_INIT_NUX_STATE:break;case c("RTCP2PCallActionTypes").P2P_PROCESS_MESSAGE:var B=[];if(A.message&&!A.message.isRemoteVideoSupported())B.push("remove_video_unsupported");if(A.message&&A.message.isFromMobile())B.push("peer_on_mobile");else B.push("peer_on_web");r(B);break;case c("RTCP2PCallActionTypes").SET_CONNECTION_STATUS:s(A.connectionStatus);break;case c("RTCP2PCallActionTypes").SET_END_CALL_REASON:s(A.type,A.endCallReason&&A.endCallReason.toStrName(true));setTimeout(t,1e3);break;case c("RTCGroupCallActionTypes").INIT:if(A.protocol===i.P2P)r(["p2p","v2"]);break;case c("RTCGroupCallActionTypes").SET_LAYOUT:s(A.type,A.layout);break;case c("RTCGroupCallActionTypes").SET_MW_CALL_TYPE:s(A.type,A.callType);break;case c("RTCGroupCallActionTypes").END_CALL:s(A.type,A.endCallReason);break;default:s(A.type)}return z}var y={appendAction:s,addFunnelTags:r,endFunnel:t,startFunnel:p,setWindowNonce:u,listenCrossWindowAction:v,logRTCCallAction:x,logRTCP2PV1Action:w};f.exports=y}),null);