if (self.CavalryLogger) { CavalryLogger.start_js(["rd6h9"]); }

__d("FBRTCCapability",[],(function a(b,c,d,e,f,g){f.exports={SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3}}),null);
__d("FBRTCDeviceStatus",[],(function a(b,c,d,e,f,g){f.exports={OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10}}),null);
__d("FBRTCMediaType",[],(function a(b,c,d,e,f,g){f.exports={AUDIO:0,VIDEO:1,DATA:2}}),null);
__d("FBRTCMessageType",[],(function a(b,c,d,e,f,g){f.exports={JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,EXPERIMENT:12,P2P_PROTOCOL:13,P2P_ANSWER:14,P2P_ICE_CANDIDATE:15,CONNECT:16,APPROVAL:17}}),null);
__d("FBRTCVideoQuality",[],(function a(b,c,d,e,f,g){f.exports={LOW:0,MEDIUM:1,HIGH:2,HD:3}}),null);
__d("BonfireUserFetcherQuery.graphql",[],(function a(b,c,d,e,f,g){"use strict";var h=function(){var i=[{kind:"LocalArgument",name:"userId",type:"ID!",defaultValue:null}],j=[{kind:"Variable",name:"id",variableName:"userId",type:"ID!"}],k={kind:"ScalarField",alias:null,args:null,name:"id",storageKey:null},l={kind:"LinkedField",alias:null,args:null,concreteType:"BonfireUser",name:"bonfire_user",plural:false,selections:[k,{kind:"ScalarField",alias:null,args:null,name:"display_name",storageKey:null},{kind:"ScalarField",alias:null,args:null,name:"username",storageKey:null},{kind:"ScalarField",alias:null,args:null,name:"profile_picture_uri",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:i,kind:"Fragment",metadata:null,name:"BonfireUserFetcherQuery",selections:[{kind:"LinkedField",alias:null,args:j,concreteType:null,name:"node",plural:false,selections:[{kind:"InlineFragment",type:"User",selections:[k,l]}],storageKey:null}],type:"Query"},id:"1583148155077981",kind:"Batch",metadata:{},name:"BonfireUserFetcherQuery",query:{argumentDefinitions:i,kind:"Root",name:"BonfireUserFetcherQuery",operation:"query",selections:[{kind:"LinkedField",alias:null,args:j,concreteType:null,name:"node",plural:false,selections:[{kind:"ScalarField",alias:null,args:null,name:"__typename",storageKey:null},k,{kind:"InlineFragment",type:"User",selections:[l]}],storageKey:null}]},text:null}}();f.exports=h}),null);
__d("BonfireUserFetcher",["regeneratorRuntime","Promise","LogHistory","RelayFBEnvironment","RTCUser","immutable","RelayModern","idx","nullthrows","BonfireUserFetcherQuery.graphql"],(function a(b,c,d,e,f,g){"use strict";var h,i=c("immutable").Set,j=c("immutable").List,k=c("immutable").Map,l=c("RelayModern").graphql,m=c("RelayModern").fetchQuery;function n(u){return c("regeneratorRuntime").async(function v(w){while(1)switch(w.prev=w.next){case 0:w.prev=0;w.next=3;return c("regeneratorRuntime").awrap(m(c("RelayFBEnvironment"),h||(h=function h(){return c("BonfireUserFetcherQuery.graphql")}),{userId:u}));case 3:return w.abrupt("return",w.sent);case 6:w.prev=6;w.t0=w["catch"](0);c("LogHistory").getInstance("bonfire_fetcher").error("fetch_error",JSON.stringify(w.t0));throw w.t0;case 10:case"end":return w.stop()}},null,this,[[0,6]])}function o(u){var v,w,x,y,z,A=u.node,B=(v=A)!=null?(v=v.bonfire_user)!=null?v.id:v:v,C=(w=A)!=null?w.id:w;if(!B||!C)return null;var D=c("nullthrows")((x=A)!=null?(x=x.bonfire_user)!=null?x.display_name:x:x),E=c("nullthrows")((y=A)!=null?(y=y.bonfire_user)!=null?y.username:y:y),F=c("nullthrows")((z=A)!=null?(z=z.bonfire_user)!=null?z.profile_picture_uri:z:z);return new(c("RTCUser"))({FBID:C,profileUrl:null,profilePictureUrl:F,isMessengerUser:false,userName:D,userShortName:E})}function p(u){var v,w,x,y,z,A=u.node,B=(v=A)!=null?(v=v.bonfire_user)!=null?v.id:v:v,C=(w=A)!=null?w.id:w;if(!B||!C)return null;var D=c("nullthrows")((x=A)!=null?(x=x.bonfire_user)!=null?x.display_name:x:x),E=c("nullthrows")((y=A)!=null?(y=y.bonfire_user)!=null?y.username:y:y),F=c("nullthrows")((z=A)!=null?(z=z.bonfire_user)!=null?z.profile_picture_uri:z:z);return{accepts_messenger_user_feedback:false,big_image_src:F,employee:false,fbid:C,gender:0,href:null,id:"fbid:"+C,image_src:F,is_business_enabled:null,is_employee_away:null,is_friend:null,is_messenger_user:null,is_messenger_platform_bot:null,is_parties_user:true,is_verified:null,name:D,short_name:D,type:null,vanity:E,timezone:null,personal_id:null,work_id:null}}function q(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(n(u));case 2:v=x.sent;return x.abrupt("return",p(v));case 4:case"end":return x.stop()}},null,this)}function r(u){var v,w,x,y;return c("regeneratorRuntime").async(function z(A){while(1)switch(A.prev=A.next){case 0:v=j(u);w=v.map(function(B){return q(B)}).toArray();A.next=4;return c("regeneratorRuntime").awrap(c("Promise").all(w));case 4:x=A.sent;y=k(v.zip(x));return A.abrupt("return",y);case 7:case"end":return A.stop()}},null,this)}function s(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(q(u));case 2:v=x.sent;return x.abrupt("return",c("nullthrows")(v));case 4:case"end":return x.stop()}},null,this)}function t(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(n(u));case 2:v=x.sent;return x.abrupt("return",o(v));case 4:case"end":return x.stop()}},null,this)}f.exports={fetchAllParticipants:r,fetchParticipant:s,fetchUser:t}}),null);
__d("FBRTCMultiwayMessage",["ChannelManager","CurrentUser","FBRTCMessageType","RTCUtils"],(function a(b,c,d,e,f,g){c("ChannelManager").startChannelManager();function h(i){"use strict";this.$FBRTCMultiwayMessage1=i}h.prototype.isRequest=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.responseStatusCode==null};h.prototype.isType=function(i){"use strict";return this.header().type==i};h.prototype.transactionId=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.transactionId};h.prototype.conferenceName=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.conferenceName};h.prototype.serverInfoData=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.serverInfoData};h.prototype.message=function(){"use strict";return this.$FBRTCMultiwayMessage1};h.prototype.endpoint=function(){"use strict";return this.$FBRTCMultiwayMessage1.endpoint};h.prototype.header=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header};h.prototype.body=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.body};h.prototype.incrementRetryCount=function(){"use strict";this.$FBRTCMultiwayMessage1.jsonPayload.header.retryCount++};h.prototype.ringRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").RING)?this.body().ringRequest:null};h.prototype.dismissRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").DISMISS)?this.body().dismissRequest:null};h.prototype.serverMediaUpdateRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null};h.prototype.conferenceStateRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").CONFERENCE_STATE)?this.body().conferenceStateRequest:null};h.prototype.createResponse=function(i,j){"use strict";var k={endpoint:{appId:"229895473858072",deviceId:c("ChannelManager").getCompleteConfig().sessionID,userId:c("CurrentUser").getID()},jsonPayload:{header:c("RTCUtils").createResponseHeader(this.header(),i),body:j||{}}};return new h(k)};f.exports=h}),null);
__d("XGroupCallSendMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/sendmessage/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("RTCMessageSender",["Promise","CurrentUser","XGroupCallSendMessageController","SiteData","Fbtrace","AsyncRequest"],(function a(b,c,d,e,f,g){var h=6e3;function i(){"use strict"}i.prototype.send=function(j){"use strict";return new(c("Promise"))(function(k,l){var m=j.jsonPayload.header.conferenceName,n={conference_name:m,user_id:c("CurrentUser").getID(),message:j,app_id:256281040558,app_version:String(c("SiteData").client_revision||"dev"),op:"RTCMessageSender.send",policy:"WebRTC"},o=c("Fbtrace").requestReceive("browser",String(c("SiteData").client_revision||"dev"),n),p=c("XGroupCallSendMessageController").getURIBuilder().setInt("webrtc_fbtrace",o.isOn()?1:0).getURI();c("Fbtrace").withDefaultNode(o,function(){var q=new(c("AsyncRequest"))(p).setMethod("POST").setData({message:JSON.stringify(j)}).setAllowCrossPageTransition(true).setHandler(function(r){k(r)}).setErrorHandler(function(r){var s=r.getErrorDescription(),t=Error(s!=null?s.toString():"AsyncRequest error");l(t)}).setTimeoutHandler(h,function(){l("Timeout")});q.send()})})};f.exports=i}),null);
__d("FBRTCTransactions",["Promise","Map","RTCMessageSender"],(function a(b,c,d,e,f,g){"use strict";var h=6e4,i={INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3};function j(){this.$FBRTCTransactionOwner1=new(c("Map"))()}j.prototype.findTransaction=function(l){return this.$FBRTCTransactionOwner1.get(l)};j.prototype.addTransaction=function(l){this.$FBRTCTransactionOwner1.set(l.id,l)};j.prototype.removeTransaction=function(l){this.$FBRTCTransactionOwner1["delete"](l.id)};j.prototype.getTransaction=function(l){return this.findTransaction(l.transactionId())||new k(this,l)};function k(l,m){this.id=m.transactionId();this.$FBRTCServerTransaction1=i.INIT;this.$FBRTCServerTransaction2=m;this.$FBRTCServerTransaction3=null;this.$FBRTCServerTransaction4=l;this.$FBRTCServerTransaction5=new Error("Unknown");this.$FBRTCServerTransaction6=null;this.$FBRTCServerTransaction7=new(c("RTCMessageSender"))();this.$FBRTCServerTransaction8();this.$FBRTCServerTransaction4.addTransaction(this)}k.prototype.start=function(){if(this.$FBRTCServerTransaction1==i.INIT){this.$FBRTCServerTransaction9(i.PROCESSING);return c("Promise").resolve(this.$FBRTCServerTransaction2)}else if(this.$FBRTCServerTransaction1==i.PROCESSING)return c("Promise").resolve(null);else if(this.$FBRTCServerTransaction1==i.COMPLETED){this.$FBRTCServerTransaction10();return c("Promise").resolve(null)}return c("Promise").reject(this.$FBRTCServerTransaction5)};k.prototype.sendResponse=function(l){this.$FBRTCServerTransaction3=l;this.$FBRTCServerTransaction9(i.COMPLETED);return this.$FBRTCServerTransaction7.send(l.message()).then(function(m){},function(m){this.$FBRTCServerTransaction5=m;this.$FBRTCServerTransaction9(i.TERMINATED)}.bind(this))};k.prototype.$FBRTCServerTransaction10=function(){if(this.$FBRTCServerTransaction3!=null){var l=this.$FBRTCServerTransaction3;l.incrementRetryCount();this.sendResponse(l)}};k.prototype.$FBRTCServerTransaction9=function(l){if(l!=this.$FBRTCServerTransaction1){this.$FBRTCServerTransaction1=l;if(this.$FBRTCServerTransaction1!=i.TERMINATED)this.$FBRTCServerTransaction8();if(this.$FBRTCServerTransaction1==i.TERMINATED){this.$FBRTCServerTransaction5=new Error("Terminated");this.$FBRTCServerTransaction4.removeTransaction(this)}}};k.prototype.$FBRTCServerTransaction8=function(){if(this.$FBRTCServerTransaction6){clearTimeout(this.$FBRTCServerTransaction6);this.$FBRTCServerTransaction6=null}this.$FBRTCServerTransaction6=setTimeout(function(){this.$FBRTCServerTransaction9(i.TERMINATED)}.bind(this),h)};f.exports={FBRTCTransactionOwner:j,FBRTCServerTransaction:k}}),null);
__d("XGroupCallSendRequestController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/sendrequest/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("MultiwayRequests",["Promise","AsyncRequest","FBRTCCapability","FBRTCMessageType","RTCConfig","RTCUtils","XGroupCallSendRequestController"],(function a(b,c,d,e,f,g){"use strict";var h=15e3;function i(){}i.prototype.sendJoinRequest=function(j,k,l,m,n,o){var p=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").JOIN,k,l),q={offer:{sdpString:m.toSdp()},deviceCapabilities:[c("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,c("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],userCapabilities:JSON.stringify({CAN_BE_MUTED:c("RTCConfig").RtcRemoteMuteCapability})};if(n&&n.length>0)q.usersToCall=n;if(o)q.mediaStatus=o;var r={endpoint:j,jsonPayload:{header:p,body:{joinRequest:q}}};return this.$MultiwayRequests1(r)};i.prototype.sendHangupRequest=function(j,k,l,m,n){var o=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").HANGUP,k,l),p={reason:m,detailedReasonString:n},q={endpoint:j,jsonPayload:{header:o,body:{hangupRequest:p}}};return this.$MultiwayRequests1(q)};i.prototype.sendAddParticipantsRequest=function(j,k,l,m){var n=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").ADD_PARTICIPANTS,k,l),o={usersToInvite:m},p={endpoint:j,jsonPayload:{header:n,body:{addParticipantsRequest:o}}};return this.$MultiwayRequests1(p)};i.prototype.sendSubscriptionRequest=function(j,k,l,m){return this.$MultiwayRequests1({endpoint:j,jsonPayload:{header:c("RTCUtils").createRequestHeader(c("FBRTCMessageType").SUBSCRIPTION,k,l),body:{subscriptionRequest:{subscriptions:m}}}})};i.prototype.sendClientMediaUpdateRequest=function(j,k,l,m,n,o){return this.$MultiwayRequests1({endpoint:j,jsonPayload:{header:c("RTCUtils").createRequestHeader(c("FBRTCMessageType").CLIENT_MEDIA_UPDATE,k,l),body:{clientMediaUpdateRequest:{fromVersion:m,toVersion:n,mediaUpdates:o}}}})};i.prototype.$MultiwayRequests1=function(j){return new(c("Promise"))(function(k,l){var m=c("XGroupCallSendRequestController").getURIBuilder().getURI(),n=new(c("AsyncRequest"))(m).setMethod("POST").setData({request:JSON.stringify(j)}).setAllowCrossPageTransition(true).setHandler(function(o){k(o.payload)}).setErrorHandler(function(o){var p=o.getErrorDescription(),q=Error(p!=null?p.toString():"AsyncRequest error");l(q)}).setTimeoutHandler(h,function(){l("Timeout")});n.send()})};f.exports=new i()}),null);
__d("RTCConferenceState",[],(function a(b,c,d,e,f,g){"use strict";var h={NEW:"NEW",AWAITING_USER_START:"AWAITING_USER_START",CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",TERMINATING:"TERMINATING",TERMINATED:"TERMINATED"};f.exports=h}),null);
__d("RTCGroupCallDialogController",["DOM","FBRTCGroupCallVideoEscalationDialog.react","React","ReactDOM","RTCGroupCallAddMembersDialog.react"],(function a(b,c,d,e,f,g){"use strict";var h={_container:c("DOM").create("div"),showAddGroupMembersDialog:function i(j,k,l,m){c("ReactDOM").render(c("React").createElement(c("RTCGroupCallAddMembersDialog.react"),{participants:j,participantStates:k,thread:l,viewerID:m,onUnmount:function(){return this._onUnmount()}.bind(this)}),this._container)},showVideoEscalationDialog:function i(j,k){c("ReactDOM").render(c("React").createElement(c("FBRTCGroupCallVideoEscalationDialog.react"),{userName:j,onToggle:function(){this._onUnmount();k()}.bind(this)}),this._container)},_onUnmount:function i(){c("ReactDOM").unmountComponentAtNode(this._container)}};f.exports=h}),null);
__d("FBRTCCallSummaryReducer",["FBRTCCallSummaryStore","FBRTCParticipantCallState","FBRTCLogger","RTCCallActionTypes","RTCCallStore","RTCConferenceState","RTCGroupCallActionTypes","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCLogger").Key,i={setCallSummary:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").SET_CALL_SUMMARY:return k.set("callSummary",l.callSummary)}return k},setMWCallType:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").SET_MW_CALL_TYPE:k.callSummary.setCallType(l.callType);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k},onCallStarted:function j(k,l){switch(l.type){case c("RTCCallActionTypes").INCOMING_CALL_SUCCESS:case c("RTCGroupCallActionTypes").CALL_SUCCESS:var m=function m(){var n=c("RTCCallStore").getState().callInfo.conferenceState;if(n!==c("RTCConferenceState").TERMINATED){k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());setTimeout(m,1e4)}};m();return k}return k},onMessageSignaling:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").ON_JOIN_REQUEST_SENT:if(k.callSummary.isCaller())k.callSummary.setOfferSentTime();else k.callSummary.setAnswerSentTime();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE:if(!k.callSummary.isCaller()){k.callSummary.onCallConnected();k.callSummary.onNetworkReady();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}k.callSummary.setServerInfoData(l.serverInfoData);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS:if(k.callSummary.isCaller()){k.callSummary.setAnswerReceivedTime();if(k.callSummary.isNetworkReady())k.callSummary.onCallConnected();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}return k;case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var m=c("RTCCallStore").getState().callInfo.conferenceName;if(c("RTCUtils").isGroupCall(m)){k.callSummary.onNetworkReady();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}var n=l.request.conferenceStateRequest(),o=n.participantStates;Object.keys(o).forEach(function(p){if(p!==c("RTCCallStore").getState().localUser.FBID)switch(o[p].state){case c("FBRTCParticipantCallState").UNKNOWN:case c("FBRTCParticipantCallState").CONTACTING:case c("FBRTCParticipantCallState").UNREACHABLE:return;case c("FBRTCParticipantCallState").CONNECTED:k.callSummary.onNetworkReady();if(k.callSummary.isAnswerReceived())k.callSummary.onCallConnected();default:if(k.callSummary.isCaller())k.callSummary.setOfferAckReceivedTime();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}});return k}return k},onCallEnded:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").CALL_ERROR:case c("RTCGroupCallActionTypes").HANGUP:case c("RTCGroupCallActionTypes").END_CALL:k.callSummary.onCallEnded(l.endCallReason,false,false,l.endCallSubreason);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").DISMISS:k.callSummary.onCallEnded(l.endCallReason,true,false,l.endCallSubreason);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k},onSurveyResult:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").RATING_SHOWN:k.callSummary.addExtraInfo(h.RATING_SHOWN,"1");k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").FEEDBACK_SHOWN:k.callSummary.addExtraInfo(h.SURVEY_SHOWN,"1");k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").SUBMIT_RATING:k.callSummary.addExtraInfo(h.RATING,l.rating);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").SUBMIT_FEEDBACK:k.callSummary.addExtraInfo(h.SURVEY_DETAILS,l.feedback);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k}};f.exports=i}),null);
__d("RTCCallControlReducer",["RTCGroupCallActionTypes"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){switch(j.type){case c("RTCGroupCallActionTypes").AUDIO_MUTED:case c("RTCGroupCallActionTypes").AUDIO_UNMUTED:return i.set("localUser",i.localUser.toggleMuteAudio());case c("RTCGroupCallActionTypes").VIDEO_MUTED:case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:return i.set("localUser",i.localUser.toggleMuteVideo())}return i}f.exports={toggleLocalStream:h}}),null);
__d("RTCCallReducer",["invariant","FBRTCParticipantCallState","FBRTCRtcResponseStatusCode","immutable","RTCCallActionTypes","RTCConferenceState","RTCGroupCallActionTypes","RTCUser","RTCUtils","URI"],(function a(b,c,d,e,f,g,h){"use strict";function i(y,z){switch(z.type){case c("RTCGroupCallActionTypes").INIT:return y.set("callInfo",y.callInfo.set("conferenceName",z.conferenceName).set("serverInfoData",z.serverInfoData).set("protocol",z.protocol));case c("RTCCallActionTypes").RESET:return y.set("callInfo",y.callInfo.set("conferenceState",c("RTCConferenceState").NEW).set("conferenceName",z.conferenceName)).set("callSummary",null).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}))}return y}function j(y,z){switch(z.type){case c("RTCGroupCallActionTypes").CALL:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTING).set("connections",y.connections.add(z.peerConnection));case c("RTCGroupCallActionTypes").CALL_ERROR:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED);case c("RTCGroupCallActionTypes").CALL_SUCCESS:if(z.connected)return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTED);return y}return y}function k(y,z){switch(z.type){case c("RTCCallActionTypes").INCOMING_CALL_SUCCESS:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTED)}return y}function l(y,z){switch(z.type){case c("RTCGroupCallActionTypes").HANGUP:y.connections.forEach(function(A){return A.close()});return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATING).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}));case c("RTCGroupCallActionTypes").DISMISS:z.transaction.sendResponse(z.request.createResponse(c("FBRTCRtcResponseStatusCode").OK,{}));case c("RTCGroupCallActionTypes").END_CALL:y.connections.forEach(function(A){return A.close()});return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}));case c("RTCGroupCallActionTypes").HANGUP_ERROR:case c("RTCGroupCallActionTypes").HANGUP_SUCCESS:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED)}return y}function m(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED:var A=y.remoteUsers.map(function(B){return B.FBID});return y.set("remoteUsers",y.remoteUsers.union(Object.keys(z.participants).filter(function(B){return!A.has(z.participants[B].fbid)}).map(function(B){var C=z.participants[B],D=C.big_image_src||C.image_src;if(z.images&&z.images[B])D=z.images[B];C.fbid||h(0);return new(c("RTCUser"))({FBID:C.fbid,profileUrl:new(c("URI"))(C.href),profilePictureUrl:D,isMessengerUser:!!C.is_messenger_user,isPartiesUser:!!C.is_parties_user,userName:C.name,userShortName:C.short_name,vanity:C.vanity})})))}return y}function n(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var A=z.transaction,B=z.request,C=z.request.conferenceStateRequest();if(z.conferenceStateVersion>=C.version){A.sendResponse(B.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ConferenceStateResponse:{currentVerison:z.conferenceStateVersion}}));return y}z.resolve(C.version);var D=y.remoteUsers.map(function(G){var H=C.participantStates[G.FBID];return H?G.setParticipantState(H):G}),E=D.some(function(G){var H=G.participantState;return H&&H.state===c("FBRTCParticipantCallState").CONNECTED}),F=E?c("RTCConferenceState").CONNECTED:y.callInfo.conferenceState;A.sendResponse(B.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ConferenceStateResponse:{currentVerison:z.conferenceStateVersion}}));return y.setIn(["remoteUsers"],D).setIn(["callInfo","conferenceState"],F)}return y}function o(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE:return y.setIn(["callInfo","serverInfoData"],z.serverInfoData)}return y}function p(y,z){switch(z.type){case c("RTCGroupCallActionTypes").INIT_LOCAL_USER:return y.set("localUser",z.localUser);case c("RTCGroupCallActionTypes").INIT_REMOTE_USERS:return y.set("remoteUsers",z.remoteUsers)}return y}function q(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_STREAM:return y.set("localUser",y.localUser.addStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_LOCAL_STREAM:return y.set("localUser",y.localUser.removeStream(z.stream));case c("RTCGroupCallActionTypes").REPLACE_LOCAL_STREAM:return y.set("localUser",y.localUser.replaceStream(z.oldStream,z.newStream));case c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_STREAMS:if(z.stopStreams)for(var A=y.localUser.streams,B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}var E=D;c("RTCUtils").stopMediaStream(E)}return y.set("localUser",y.localUser.removeAllStreams())}return y}function r(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_SCREEN_STREAM:return y.set("localUser",y.localUser.addScreenStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_LOCAL_SCREEN_STREAM:return y.set("localUser",y.localUser.removeScreenStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_SCREEN_STREAMS:if(z.stopStreams)for(var A=y.localUser.screenStreams,B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}var E=D;c("RTCUtils").stopMediaStream(E)}return y.set("localUser",y.localUser.removeAllScreenStreams())}return y}function s(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.addStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_ALL_REMOTE_STREAMS:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeAllStreams().removeAllScreenStreams()))}return y}function t(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_TRACK:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.clone()));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_TRACK:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.clone()))}return y}function u(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_SCREEN_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.addScreenStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_SCREEN_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeScreenStream(z.stream)))}return y}function v(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM:return y.set("remoteUsers",Object.entries(z.mediaStatus).reduce(function(B,C){var D=C[0],E=C[1],F=B.reduce(function(H,A){var G=A.streams.map(function(I){return I.getTracks().find(function(G){return G.id===D})}).find(Boolean);return G?{user:A,track:G}:H},{}),A=F.user,G=F.track;if(A&&G){if(G.kind==="audio"&&A.isAudioMuted()===E)return B["delete"](A).add(A.toggleMuteAudio());if(G.kind==="video"&&A.isVideoMuted()===E)return B["delete"](A).add(A.toggleMuteVideo())}return B},y.remoteUsers));case c("RTCCallActionTypes").REMOTE_VIDEO_MUTED:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.toggleMuteVideo(true)));case c("RTCCallActionTypes").REMOTE_VIDEO_UNMUTED:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.toggleMuteVideo(false)))}return y}function w(y,z){return y.remoteUsers.find(function(A){if(z.userID)return A.FBID==z.userID;return A.FBID===z.stream.id.split(":")[0]})}function x(y,z){switch(z.type){case c("RTCGroupCallActionTypes").WAIT_FOR_USER_INPUT:if(y.callInfo.conferenceState===c("RTCConferenceState").NEW)return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").AWAITING_USER_START);return y}return y}f.exports={callInit:i,callStart:j,callEnd:l,onParticipantsChanged:m,incomingCallStart:k,initUsers:p,processLocalStream:q,processLocalScreenStream:r,processRemoteStream:s,processRemoteScreenStream:u,processRemoteTrack:t,toggleRemoteStream:v,processConferenceState:n,processJoinResponse:o,waitForUserInput:x}}),null);
__d("RTCCallStoreState",["CurrentUser","immutable","RTCConferenceState","RTCUser"],(function a(b,c,d,e,f,g){"use strict";var h,i,j,k,l={debugID:0,conferenceState:c("RTCConferenceState").NEW,conferenceName:"",protocol:"",serverInfoData:""};h=babelHelpers.inherits(m,c("immutable").Record(l));i=h&&h.prototype;function m(){h.apply(this,arguments)}var n={connections:c("immutable").Set(),localUser:new(c("RTCUser"))({FBID:c("CurrentUser").getID()}),remoteUsers:c("immutable").Set(),callInfo:new m(),callSummary:null};j=babelHelpers.inherits(o,c("immutable").Record(n));k=j&&j.prototype;function o(){j.apply(this,arguments)}f.exports=o}),null);
__d("RTCCallStore",["FBRTCCallSummaryReducer","FluxReduceStore","RTCCallControlReducer","RTCCallReducer","MessengerRTCFunnelLogger","RTCCallStoreState","RTCGroupCallDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=[c("FBRTCCallSummaryReducer").onCallEnded,c("FBRTCCallSummaryReducer").onCallStarted,c("FBRTCCallSummaryReducer").onMessageSignaling,c("FBRTCCallSummaryReducer").onSurveyResult,c("FBRTCCallSummaryReducer").setCallSummary,c("FBRTCCallSummaryReducer").setMWCallType,c("RTCCallControlReducer").toggleLocalStream,c("RTCCallReducer").callEnd,c("RTCCallReducer").callInit,c("RTCCallReducer").callStart,c("RTCCallReducer").incomingCallStart,c("RTCCallReducer").initUsers,c("RTCCallReducer").onParticipantsChanged,c("RTCCallReducer").processConferenceState,c("RTCCallReducer").processJoinResponse,c("RTCCallReducer").processLocalScreenStream,c("RTCCallReducer").processLocalStream,c("RTCCallReducer").processRemoteScreenStream,c("RTCCallReducer").processRemoteStream,c("RTCCallReducer").processRemoteTrack,c("RTCCallReducer").toggleRemoteStream,c("RTCCallReducer").waitForUserInput,c("MessengerRTCFunnelLogger").logRTCCallAction];h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;k.prototype.getInitialState=function(){return new(c("RTCCallStoreState"))()};k.prototype.reduce=function(l,m){return j.reduce(function(l,n){return n(l,m)},l)};function k(){h.apply(this,arguments)}f.exports=new k(c("RTCGroupCallDispatcher"))}),null);
__d("RTCGroupCallActions",["RTCGroupCallActionTypes","RTCGroupCallDispatcher","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h={setMWCallType:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_MW_CALL_TYPE,callType:j})},setLayout:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_LAYOUT,layout:j})},setDominantSpeaker:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_DOMINANT_SPEAKER,dominantSpeakerFBID:j})},setPinnedSpeaker:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_PINNED_SPEAKER,pinnedSpeakerFBID:j})},setUseDominantSpeakeView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_USE_DOMINANT_SPEAKE_VIEW,useDominantSpeakeView:j})},setUseGridView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_GRID_VIEW,useGridView:j})},setUseStripView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_STRIP_VIEW,useStripView:j})},initThread:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").INIT_THREAD,thread:j,participants:k})},onParticipantLeft:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_PARTICIPANT_LEFT,participantFBID:j})},onParticipantsAdded:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED,participants:j,images:k})},addParticipantsToRing:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_PARTICIPANTS_TO_RING,participantFBIDs:j})},toggleRemoteStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM,mediaStatus:j})},handleDismissRequest:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").DISMISS,transaction:j,request:k,endCallReason:c("RTCUtils").endCallReasonFromDismissRequest(k.dismissRequest())})},handleConferenceStateRequest:function i(j,k,l,m){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE,transaction:j,request:k,conferenceStateVersion:l,resolve:m})},onJoinRequestSent:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_JOIN_REQUEST_SENT})},onJoinResponse:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE,serverInfoData:j})},onServerMediaUpdateSuccess:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS})},onClientMediaUpdateResponse:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE,responseStatusCode:j,currentVersion:k})}};f.exports=h}),null);
__d("RTCMWSessionDescription",["Promise","FBRTCMediaType","RTCCallStore","RTCConfig","RTCGroupCallActions","RTCGroupCallDialogController"],(function a(b,c,d,e,f,g){"use strict";var h={_videoEnabled:{},serverMediaUpdate:function i(j,k){var l,m=j.fromVersion,n=j.toVersion,o=j.mediaUpdates,p=c("RTCCallStore").getState().connections.first(),q=p.getLocalDescription(),r=p.getRemoteDescription(),s=r.sessionDescription.getVersion();if(s!==m){k(s);return}var t=function(){o.forEach(function(u){r.processServerMediaUpdate(u);u.media.forEach(function(v){var w=v.type,x=v.enabled;if(w===c("FBRTCMediaType").VIDEO)this._videoEnabled[u.sourceKey]=x}.bind(this))}.bind(this));r.sessionDescription.setVersion(n);c("Promise").all([p.setLocalDescription(q),p.setRemoteDescription(r)]).then(function(){var v;c("RTCGroupCallActions").toggleRemoteStream((v=[]).concat.apply(v,o.map(function(w){var x=w.media;return x})).reduce(function(w,x){var y=x.id,z=x.enabled;w[y]=z;return w},{}));k(n)},function(){return k(s)})["catch"](function(v){})}.bind(this),u=o.find(function(v){var w=v.sourceKey,x=v.media;return!this._videoEnabled[w]&&x.some(function(y){var z=y.type,A=y.enabled;return z===c("FBRTCMediaType").VIDEO&&A})}.bind(this));if(c("RTCConfig").RtcConferencingVideoGK&&!c("RTCCallStore").getState().localUser.hasVideo()&&u)(function(){var v=u.sourceKey.split(":"),w=v[0],x=c("RTCCallStore").getState().remoteUsers.find(function(x){return x.FBID===w});c("RTCGroupCallDialogController").showVideoEscalationDialog(x.userName,t)})();else t()}};f.exports=h}),null);
__d("MultiwayParticipantFetcher",["Promise","regeneratorRuntime","BonfireUserFetcher","ImmutableObject","MercuryIDs","MercuryParticipants","immutable","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("immutable").Set,i=c("immutable").Map;function j(o){var p=c("MercuryIDs").getParticipantIDFromUserID(o);return new(c("Promise"))(function(q,r){try{c("MercuryParticipants").get(p,function(t){q(t)})}catch(s){r(s)}})}function k(o,p){var q=o.map(function(r){return c("MercuryIDs").getParticipantIDFromUserID(r)});return new(c("Promise"))(function(r,s){try{c("MercuryParticipants").getBigImageMulti(q.toArray(),function(u){r(c("immutable").fromJS(u))},p)}catch(t){s(t)}})}function l(o){var p=o.map(function(q){return c("MercuryIDs").getParticipantIDFromUserID(q)});return new(c("Promise"))(function(q,r){try{c("MercuryParticipants").getMulti(p.toArray(),function(t){q(c("immutable").fromJS(t))})}catch(s){r(s)}})}function m(o,p){var q,r=this,s,q;return c("regeneratorRuntime").async(function t(u){while(1)switch(u.prev=u.next){case 0:u.next=2;return c("regeneratorRuntime").awrap(l(o));case 2:s=u.sent;if(!p.profileImageSize){u.next=9;break}u.next=6;return c("regeneratorRuntime").awrap(function v(){var w;return c("regeneratorRuntime").async(function x(y){while(1)switch(y.prev=y.next){case 0:y.next=2;return c("regeneratorRuntime").awrap(k(o,p.profileImageSize));case 2:w=y.sent;return y.abrupt("return",{v:s.withMutations(function(z){w.forEach(function(A,B){var C=z.get(B);if(C){var D=c("ImmutableObject").setProperty(C,"big_image_src",A);z.set(B,D)}})})});case 4:case"end":return y.stop()}},null,r)}());case 6:q=u.sent;if(!(typeof q==="object")){u.next=9;break}return u.abrupt("return",q.v);case 9:return u.abrupt("return",s);case 10:case"end":return u.stop()}},null,this)}var n={fetchParticipant:function o(p,q){return c("regeneratorRuntime").async(function r(s){while(1)switch(s.prev=s.next){case 0:if(!c("RTCUtils").isPartiesCall(p)){s.next=6;break}s.next=3;return c("regeneratorRuntime").awrap(c("BonfireUserFetcher").fetchParticipant(q));case 3:return s.abrupt("return",s.sent);case 6:s.next=8;return c("regeneratorRuntime").awrap(j(q));case 8:return s.abrupt("return",s.sent);case 9:case"end":return s.stop()}},null,this)},fetchAllParticipants:function o(p,q){var r=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return c("regeneratorRuntime").async(function s(t){while(1)switch(t.prev=t.next){case 0:if(!c("RTCUtils").isPartiesCall(p)){t.next=6;break}t.next=3;return c("regeneratorRuntime").awrap(c("BonfireUserFetcher").fetchAllParticipants(q));case 3:return t.abrupt("return",t.sent);case 6:t.next=8;return c("regeneratorRuntime").awrap(m(q,r));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},null,this)}};f.exports=n}),null);
__d("RTCMultiwayMessageHandler",["Arbiter","ChannelConstants","CurrentUser","FBRTCCallSummary","FBRTCCapability","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCMultiwayMessage","FBRTCRtcResponseStatusCode","FBRTCTransactions","immutable","MultiwayParticipantFetcher","RTCCallActions","RTCCallStore","RTCGroupCallActions","RTCMWProtocolHandler","RTCMWSessionDescription","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCTransactions").FBRTCServerTransaction,i=c("FBRTCTransactions").FBRTCTransactionOwner;function j(){this.$RTCMultiwayMessageHandler3=-1;this.$RTCMultiwayMessageHandler5()}j.prototype.initialize=function(k,l){this.$RTCMultiwayMessageHandler1=k;this.$RTCMultiwayMessageHandler2=l};j.initHandler=function(k,l){new j().initialize(k,l)};j.close=function(){if(j.$RTCMultiwayMessageHandler4){c("Arbiter").unsubscribe(j.$RTCMultiwayMessageHandler4);j.$RTCMultiwayMessageHandler4=null}};j.prototype.$RTCMultiwayMessageHandler5=function(){j.$RTCMultiwayMessageHandler4=c("Arbiter").subscribe([c("ChannelConstants").getArbiterType("rtc_live_json"),c("ChannelConstants").getArbiterType("rtc_multi_json")],function(k,l){this.$RTCMultiwayMessageHandler6(l.obj)}.bind(this))};j.prototype.$RTCMultiwayMessageHandler6=function(k){var l,m=this,n=new(c("FBRTCMultiwayMessage"))(k);if(!n.isRequest())return;if(this.$RTCMultiwayMessageHandler1===n.conferenceName())this.$RTCMultiwayMessageHandler7(n);else if(n.ringRequest())(function(){var o=new h(new i(),n);o.start().done(function(p){var q=c("RTCUtils").generateRandomInt(),r=new(c("FBRTCCallSummary"))({peerID:c("RTCUtils").isGroupCall(p.conferenceName())?-1:c("RTCUtils").getPeerID(p.conferenceName()),callID:q,isCaller:false});o.sendResponse(this.$RTCMultiwayMessageHandler8(p,q,r)).done(function(){return c("RTCMWProtocolHandler").otherUserInAnotherCall(n.conferenceName(),n.serverInfoData(),c("FBRTCHangupReason").IN_ANOTHER_CALL,"InAnotherCall")})}.bind(m))})()};j.prototype.$RTCMultiwayMessageHandler8=function(k,l,m){var n=k.ringRequest(),o=k.serverInfoData();if(n==null||o==null)return k.createResponse(c("FBRTCRtcResponseStatusCode").BAD_REQUEST);var p={deviceCapabilities:[c("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,c("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],deviceStatus:c("FBRTCDeviceStatus").OK};return k.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ringResponse:p})};j.prototype.$RTCMultiwayMessageHandler7=function(k){var l=new h(new i(),k);l.start().then(function(m){var n,o=this;if(m!=null)if(m.dismissRequest()!=null){var p=c("RTCCallStore").getState(),q=p.callInfo,r=p.connections;if(m.serverInfoData()===q.serverInfoData){c("RTCGroupCallActions").handleDismissRequest(l,m);j.close();r.forEach(function(s){return s.close()});c("RTCCallActions").removeAllLocalStreams(true)}}else if(m.serverMediaUpdateRequest()!=null)c("RTCMWSessionDescription").serverMediaUpdate(m.serverMediaUpdateRequest(),function(s){c("RTCGroupCallActions").onServerMediaUpdateSuccess();l.sendResponse(m.createResponse(c("FBRTCRtcResponseStatusCode").OK,{serverMediaUpdateResponse:{currentVersion:s}}))});else if(m.conferenceStateRequest()!=null)(function(){var s=c("RTCCallStore").getState(),t=s.remoteUsers,u=t.map(function(x){return x.FBID}),v=Object.keys(m.conferenceStateRequest().participantStates),w=v.filter(function(x){return x!==c("CurrentUser").getID()&&!u.has(x)});if(w.length>0)c("MultiwayParticipantFetcher").fetchAllParticipants(o.$RTCMultiwayMessageHandler1,c("immutable").Set(w),{profileImageSize:100}).done(function(x){c("RTCGroupCallActions").onParticipantsAdded(x.toJS());c("RTCGroupCallActions").handleConferenceStateRequest(l,m,this.$RTCMultiwayMessageHandler3,function(y){this.$RTCMultiwayMessageHandler3=y}.bind(this))}.bind(o));else c("RTCGroupCallActions").handleConferenceStateRequest(l,m,o.$RTCMultiwayMessageHandler3,function(x){this.$RTCMultiwayMessageHandler3=x}.bind(o))})()}.bind(this)).done()};f.exports=j}),null);
__d("FBRTCClientMediaUpdateReducer",["FBRTCRtcResponseStatusCode","RTCCallStore","RTCGroupCallActionTypes","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g){"use strict";var h={configureAudio:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").AUDIO_MUTED:return i(l,"audio",false);case c("RTCGroupCallActionTypes").AUDIO_UNMUTED:return i(l,"audio",true)}return l},configureVideo:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").VIDEO_MUTED:return i(l,"video",false);case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:return i(l,"video",true)}return l},onClientMediaUpdateResponse:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE:if(m.responseStatusCode!==c("FBRTCRtcResponseStatusCode").OK)return l;l=l.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],m.currentVersion);if(l.clientMediaUpdateInfo.pendingResponse){l=l.setIn(["clientMediaUpdateInfo","pendingResponse"],false);if(l.clientMediaUpdateInfo.pendingUpdate)return j(l.setIn(["clientMediaUpdateInfo","pendingUpdate"],false))}return l}return l}};function i(k,l,m){var n=c("RTCCallStore").getState().connections.first().getLocalStreams()[0].getTracks().reduce(function(n,o){n[o.id]=o.kind===l?m:o.enabled;return n},{});return j(k.setIn(["clientMediaUpdateInfo","localMediaUpdates"],k.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:n})))}function j(k){if(k.clientMediaUpdateInfo.pendingResponse)return k.setIn(["clientMediaUpdateInfo","pendingUpdate"],true);var l=k.clientMediaUpdateInfo.localMediaUpdates.reduce(function(m,n,o){if(o>=k.clientMediaUpdateInfo.lastSyncedClientVersion)m.push(n);return m},[]);if(l.length===0)return k;c("RTCMWProtocolHandler").clientMediaUpdate(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,k.clientMediaUpdateInfo.lastSyncedClientVersion,k.clientMediaUpdateInfo.localMediaUpdates.size,l);return k.setIn(["clientMediaUpdateInfo","pendingResponse"],true)}f.exports=h}),null);
__d("FBRTCGroupCallParticipantsReducer",["MercuryIDs","RTCCallStore","RTCGroupCallActionTypes","RTCMWProtocolHandler","Set"],(function a(b,c,d,e,f,g){"use strict";var h={_participantsToRing:new(c("Set"))(),initThread:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").INIT_THREAD:return j.merge({participants:k.participants,thread:k.thread})}return j},onParticipantsChanged:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").ON_PARTICIPANT_LEFT:return j.set("participants",j.participants["delete"](c("MercuryIDs").getParticipantIDFromUserID(k.participantFBID)));case c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED:var l=Object.keys(k.participants).map(function(m){return k.participants[m].fbid}).filter(function(m){return h._participantsToRing.has(m)});if(l.length!==0){l.forEach(function(m){return h._participantsToRing["delete"](m)});c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,l)}return j.set("participants",j.participants.merge(k.participants))}return j},addParticipantsToRing:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").ADD_PARTICIPANTS_TO_RING:k.participantFBIDs.forEach(function(l){return h._participantsToRing.add(l)});return j}return j}};f.exports=h}),null);
__d("FBRTCGroupCallReducer",["FBRTCParticipantCallState","RTCCallStore","RTCEndCallReason","RTCGroupCallActionTypes","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g){"use strict";var h={setDominantSpeaker:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_DOMINANT_SPEAKER:return j.set("dominantSpeakerFBID",k.dominantSpeakerFBID);case c("RTCGroupCallActionTypes").SET_PINNED_SPEAKER:var l=c("RTCCallStore").getState(),m=l.callInfo,n=l.connections;c("RTCMWProtocolHandler").subscription(m.conferenceName,m.serverInfoData,n.first().getRemoteStreams(),j.layout,k.pinnedSpeakerFBID);return j.set("pinnedSpeakerFBID",k.pinnedSpeakerFBID);case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var o=k.request.conferenceStateRequest(),p=o.participantStates,q=p[j.pinnedSpeakerFBID];if(q&&q.state!==c("FBRTCParticipantCallState").CONNECTED)return j.set("pinnedSpeakerFBID",null);return j}return j},setLayout:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_LAYOUT:var l=c("RTCCallStore").getState(),m=l.callInfo,n=l.connections;if(n.size>0)c("RTCMWProtocolHandler").subscription(m.conferenceName,m.serverInfoData,n.first().getRemoteStreams(),k.layout,j.pinnedSpeakerFBID);return j.set("layout",k.layout)}return j},setGKSettings:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_USE_DOMINANT_SPEAKE_VIEW:return j.set("useDominantSpeakeView",k.useDominantSpeakeView);case c("RTCGroupCallActionTypes").SET_GRID_VIEW:return j.set("useGridView",k.useGridView);case c("RTCGroupCallActionTypes").SET_STRIP_VIEW:return j.set("useStripView",k.useStripView)}return j},processEndCallReason:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").CALL_ERROR:case c("RTCGroupCallActionTypes").HANGUP:case c("RTCGroupCallActionTypes").END_CALL:case c("RTCGroupCallActionTypes").DISMISS:return j.set("endCallReason",j.endCallReason||new(c("RTCEndCallReason"))(k.endCallReason))}return j}};f.exports=h}),null);
__d("RTCStreamDurationTracker",["performanceNow"],(function a(b,c,d,e,f,g){"use strict";function h(){var i=arguments.length<=0||arguments[0]===undefined?"mixed":arguments[0];this.$RTCStreamDurationTracker3=0;this.$RTCStreamDurationTracker4=0;this.$RTCStreamDurationTracker5=false;this.update=function(){if(!this.$RTCStreamDurationTracker5)return;if(this.$RTCStreamDurationTracker6()){if(this.$RTCStreamDurationTracker4===0)this.$RTCStreamDurationTracker4=c("performanceNow")()}else{this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker4=0}}.bind(this);this.$RTCStreamDurationTracker1=i}h.prototype.isStarted=function(){return this.$RTCStreamDurationTracker5};h.prototype.track=function(i){if(i===this.$RTCStreamDurationTracker2){this.update();return}if(this.$RTCStreamDurationTracker2&&this.$RTCStreamDurationTracker5){var j=this.$RTCStreamDurationTracker2;j.removeEventListener("addtrack",this.update);j.removeEventListener("removetrack",this.update)}if(i){this.$RTCStreamDurationTracker2=i;if(this.$RTCStreamDurationTracker5)this.start()}else this.stop()};h.prototype.$RTCStreamDurationTracker6=function(){if(!this.$RTCStreamDurationTracker2)return false;return this.$RTCStreamDurationTracker7().some(function(i){return i.enabled})};h.prototype.$RTCStreamDurationTracker7=function(){if(!this.$RTCStreamDurationTracker2)return[];switch(this.$RTCStreamDurationTracker1){case"audio":return this.$RTCStreamDurationTracker2.getAudioTracks();case"video":return this.$RTCStreamDurationTracker2.getVideoTracks();default:return this.$RTCStreamDurationTracker2.getTracks()}};h.prototype.getDuration=function(){return this.$RTCStreamDurationTracker4===0?this.$RTCStreamDurationTracker3:this.$RTCStreamDurationTracker3+c("performanceNow")()-this.$RTCStreamDurationTracker4};h.prototype.start=function(){this.$RTCStreamDurationTracker5=true;if(this.$RTCStreamDurationTracker6())this.$RTCStreamDurationTracker4=c("performanceNow")();if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.addEventListener("addtrack",this.update);i.addEventListener("removetrack",this.update)}};h.prototype.stop=function(){if(!this.$RTCStreamDurationTracker5)return;this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker5=false;this.$RTCStreamDurationTracker4=0;if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.removeEventListener("addtrack",this.update);i.removeEventListener("removetrack",this.update)}};f.exports=h}),null);
__d("FBRTCGroupCallStoreState",["immutable","RTCStreamDurationTracker"],(function a(b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n={pendingResponse:false,pendingUpdate:false,lastSyncedClientVersion:2,localMediaUpdates:c("immutable").List([{mediaStatus:{}},{mediaStatus:{}}])};h=babelHelpers.inherits(o,c("immutable").Record(n));i=h&&h.prototype;function o(){h.apply(this,arguments)}var p={localVideoDurationTracker:new(c("RTCStreamDurationTracker"))("video"),remoteVideoDurationTracker:new(c("RTCStreamDurationTracker"))("video")};j=babelHelpers.inherits(q,c("immutable").Record(p));k=j&&j.prototype;function q(){j.apply(this,arguments)}var r={dominantSpeakerFBID:null,endCallReason:null,layout:null,participants:null,pinnedSpeakerFBID:null,thread:null,clientMediaUpdateInfo:new o(),useDominantSpeakeView:false,useGridView:false,useStripView:false,videoDurationTrackerInfo:new q()};l=babelHelpers.inherits(s,c("immutable").Record(r));m=l&&l.prototype;function s(){l.apply(this,arguments)}f.exports=s}),null);
__d("FBRTCVideoDurationTrackerReducer",["FBRTCCallSummaryStore","RTCCallStore","RTCGroupCallActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h={track:function i(j,k){var l=j.videoDurationTrackerInfo,m=l.localVideoDurationTracker,n=l.remoteVideoDurationTracker;switch(k.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_STREAM:m.start();m.track(k.stream);return j;case c("RTCGroupCallActionTypes").ADD_REMOTE_STREAM:case c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM:var o=c("RTCCallStore").getState(),p=o.remoteUsers,q=p.find(function(q){return!q.isVideoMuted()});n.stop();n.start();n.track(q&&q.streams.first());return j}return j},update:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").VIDEO_MUTED:case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:j.videoDurationTrackerInfo.localVideoDurationTracker.update()}return j},stop:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").DISMISS:case c("RTCGroupCallActionTypes").END_CALL:case c("RTCGroupCallActionTypes").HANGUP:var l=j.videoDurationTrackerInfo,m=c("RTCCallStore").getState(),n=m.callSummary;n.setVideoDurations(l.localVideoDurationTracker.getDuration(),l.remoteVideoDurationTracker.getDuration());n.save(c("FBRTCCallSummaryStore").getInstance());return j}return j}};f.exports=h}),null);
__d("FBRTCGroupCallStore",["FBRTCClientMediaUpdateReducer","FBRTCGroupCallParticipantsReducer","FBRTCGroupCallReducer","FBRTCGroupCallStoreState","FBRTCVideoDurationTrackerReducer","FluxReduceStore","RTCGroupCallDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=[c("FBRTCClientMediaUpdateReducer").configureAudio,c("FBRTCClientMediaUpdateReducer").configureVideo,c("FBRTCClientMediaUpdateReducer").onClientMediaUpdateResponse,c("FBRTCGroupCallParticipantsReducer").addParticipantsToRing,c("FBRTCGroupCallParticipantsReducer").initThread,c("FBRTCGroupCallParticipantsReducer").onParticipantsChanged,c("FBRTCGroupCallReducer").processEndCallReason,c("FBRTCGroupCallReducer").setDominantSpeaker,c("FBRTCGroupCallReducer").setGKSettings,c("FBRTCGroupCallReducer").setLayout,c("FBRTCVideoDurationTrackerReducer").track,c("FBRTCVideoDurationTrackerReducer").update,c("FBRTCVideoDurationTrackerReducer").stop];h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;k.prototype.getInitialState=function(){return new(c("FBRTCGroupCallStoreState"))()};k.prototype.reduce=function(l,m){return j.reduce(function(l,n){return n(l,m)},l)};function k(){h.apply(this,arguments)}f.exports=new k(c("RTCGroupCallDispatcher"))}),null);
__d("FBRTCGroupCallVideoEscalationDialog.react",["fbt","FBRTCConstants","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","React","RTCGroupCallActions","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("FBRTCConstants").CallType,j=function j(k){var l=k.userName,m=k.onToggle;return c("React").createElement(c("MessengerDialog.react"),{onToggle:m},c("React").createElement(c("MessengerDialogBody.react"),null,h._("{name} added video chat. Would you like to share your video?",[h.param("name",l)])),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),{onClick:function n(){return c("RTCGroupCallActions").setMWCallType(i.ESCALATION_DECLINED)}}),c("React").createElement(c("MessengerDialogButton.react"),{label:h._("Share Video"),onClick:function n(){c("RTCMWProtocolHandler").videoEscalation();m()},type:"primary"})))};f.exports=j}),null);
__d("RTCGroupCallAddMembersDialog.react",["cx","fbt","FluxContainer","immutable","MercuryIDs","MercuryLogMessageType","MercuryMessageActions","MercuryMessageObject","MercuryTriodeSourceUtil","MessengerAdminGroupUtils","MessengerDialog.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerGraphQLTokenizer.react","MessengerRTCGroupCallContactList.react","MessengerRTCGroupCallThreadRow.react","React","RTCCallStore","RTCConferenceState","RTCGroupCallActions","RTCGroupCallDispatcher","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent,m=460;j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.getStores=function(){return[c("RTCCallStore")]};n.calculateState=function(){return{remoteUsers:c("RTCCallStore").getState().remoteUsers}};function n(o){k.constructor.call(this,o);this.state={isParticipantSelected:this.props.participants.mapEntries(function(p){var q=p[0],r=p[1];return[q,false]}),newParticipants:c("immutable").List(),remoteUsers:c("immutable").Set()};this.$RTCGroupCallAddMembersDialog1=function(p){this.setState({isParticipantSelected:this.state.isParticipantSelected.set(p,!this.state.isParticipantSelected.get(p))})}.bind(this);this.$RTCGroupCallAddMembersDialog2=function(){var p=this.props,q=p.onUnmount,r=p.thread;q();var s=this.state.newParticipants.toArray().map(function(u){return u.getUniqueID()}),t=this.$RTCGroupCallAddMembersDialog3().map(function(u){var v=u.fbid;return v||""});if(r){c("RTCGroupCallActions").addParticipantsToRing(s);this.$RTCGroupCallAddMembersDialog7(r);if(t.length>0)c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,t)}else c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,[].concat(s,t))}.bind(this);this.$RTCGroupCallAddMembersDialog4=function(p){this.setState({newParticipants:this.state.newParticipants.push(p)})}.bind(this);this.$RTCGroupCallAddMembersDialog6=function(p){var q=p.getUniqueID(),r=this.state.newParticipants,s=r.findIndex(function(t){return t.getUniqueID()===q});if(s!==-1)this.setState({newParticipants:r["delete"](s)})}.bind(this);this.$RTCGroupCallAddMembersDialog5=function(){this.setState({newParticipants:c("immutable").List()})}.bind(this);c("RTCGroupCallDispatcher").explicitlyRegisterStores([c("RTCCallStore")])}n.prototype.render=function(){var o=this.props,p=o.participants,q=o.thread,r=o.viewerID,s=c("RTCCallStore").getState().callInfo.conferenceState;if(s!==c("RTCConferenceState").CONNECTED)return null;var t=c("React").createElement("div",{className:"_2t45"},c("React").createElement("div",{className:"_225b"},i._("Group Members")),c("React").createElement(c("MessengerRTCGroupCallContactList.react"),{isParticipantSelected:this.state.isParticipantSelected,onClick:this.$RTCGroupCallAddMembersDialog1,remoteUsers:this.state.remoteUsers.toArray().sort(function(u,v){return u.userName.localeCompare(v.userName)}),participantStates:c("immutable").Map(this.state.remoteUsers.map(function(u){return[u.FBID,u.participantState]}))}));return c("React").createElement(c("MessengerDialog.react"),{onToggle:this.props.onUnmount,type:"default",width:m},c("React").createElement("div",{className:"_5zad"},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),null),c("React").createElement(c("MessengerDialogTitle.react"),null,i._("Add group members")),c("React").createElement(c("MessengerDialogButton.react"),{label:i._("Ring"),onClick:this.$RTCGroupCallAddMembersDialog2,disabled:this.$RTCGroupCallAddMembersDialog3().length+this.state.newParticipants.size===0,type:"primary"})),c("React").createElement(c("MessengerRTCGroupCallThreadRow.react"),{displayAddMemberWarning:true,participants:p,thread:q,viewerID:r}),c("React").createElement(c("MessengerGraphQLTokenizer.react"),{autoFocus:false,context:null,className:"_2el3",defaultEntries:t,enableMessageSearch:false,entries:this.state.newParticipants,excludeGroups:true,excludePages:true,forceHideClearButton:true,hasHoverState:false,hideViewWithEntries:false,onAddEntryAttempt:this.$RTCGroupCallAddMembersDialog4,onClear:this.$RTCGroupCallAddMembersDialog5,onRemoveEntryAttempt:this.$RTCGroupCallAddMembersDialog6,originalEntryIDs:c("immutable").Set(this.props.participants.keySeq().toArray().map(function(u){return c("MercuryIDs").getUserIDFromParticipantID(u)||u})),placeholder:i._("Add to group:"),showDefaultEntries:true,shouldQueryInternalBot:false,shouldQueryVCEndpoint:false,scrollableViewClassName:"_2el2",useLayer:false,viewer:this.props.viewerID,width:m})))};n.prototype.$RTCGroupCallAddMembersDialog7=function(o){if(this.state.newParticipants.size)if(c("MessengerAdminGroupUtils").isJoinableThread(o))this.state.newParticipants.forEach(function(q){var p=c("MercuryIDs").getThreadIDFromUserID(q.getUniqueID());this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructUserGeneratedMessageObject(o.joinable_mode.link,c("MercuryTriodeSourceUtil").getMercuryTriodeSource(),p))}.bind(this));else{var p="thread:"+(o.thread_fbid||o.thread_id.split(".")[1]);this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructLogMessageObject(c("MercuryTriodeSourceUtil").getMercuryTriodeSource(),p,c("MercuryLogMessageType").SUBSCRIBE,{added_participants:this.state.newParticipants.map(function(q){return c("MercuryIDs").getParticipantIDFromUserID(q.getUniqueID())}).toArray()}))}};n.prototype.$RTCGroupCallAddMembersDialog8=function(){return c("MercuryMessageActions").getForFBID(this.props.viewerID)};n.prototype.$RTCGroupCallAddMembersDialog9=function(){return c("MercuryMessageObject").getForFBID(this.props.viewerID)};n.prototype.$RTCGroupCallAddMembersDialog3=function(){return this.props.participants.filter(function(o,p){return this.state.isParticipantSelected.get(p)}.bind(this)).toArray()};f.exports=c("FluxContainer").create(n)}),null);
__d("RTCIceCandidate",[],(function a(b,c,d,e,f,g){"use strict";f.exports=window.RTCIceCandidate||window.mozRTCPeerConnection}),null);
__d("RTCPeerConnection",[],(function a(b,c,d,e,f,g){"use strict";f.exports=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection}),null);
__d("RTCSessionDescription",["FBRTCMediaType","FBRTCSdpUtils","FBRTCConstants"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCConstants").SignalingProtocol,i=window.RTCSessionDescription||window.mozRTCSessionDescription,j=2,k="o",l="m",m="a",n="rtpmap",o="ssrc-group",p="ssrc",q="cname",r="msid",s="mslabel",t="label",u="sendonly",v="recvonly",w="sendrecv",x="inactive",y="offer",z="answer",A="=",B=" ",C=":",D="\r\n",E="audio",F="video",G="application",H=function H(O,P){return O.startsWith(P+A)},I=function I(O){return O.substr(j)},J=function J(O,P){return O.startsWith(P+D)||O.startsWith(P+C)},K=function K(O,P){return O.substr(P.length+1)};function L(O){this.$SessionDescription1=[];this.$SessionDescription2="-";this.$SessionDescription3="multiway";this.$SessionDescription4=1;this.$SessionDescription5="IN";this.$SessionDescription6="IP4";this.$SessionDescription7="127.0.0.1";O.forEach(function(P){if(H(P,k)){var Q=I(P).split(B);if(Q.length==6){this.$SessionDescription2=Q[0];this.$SessionDescription3=Q[1];this.$SessionDescription4=parseInt(Q[2],10);this.$SessionDescription5=Q[3];this.$SessionDescription6=Q[4];this.$SessionDescription7=Q[5]}}this.$SessionDescription1.push(P)}.bind(this))}L.prototype.setVersion=function(O){this.$SessionDescription4=O};L.prototype.getVersion=function(){return this.$SessionDescription4};L.prototype.toSdp=function(){return this.$SessionDescription1.map(function(O){if(H(O,k))return k+A+this.$SessionDescription2+B+this.$SessionDescription3+B+this.$SessionDescription4+B+this.$SessionDescription5+B+this.$SessionDescription6+B+this.$SessionDescription7;else return O}.bind(this)).join(D)};function M(O,P){var Q=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$MediaDescription1=[];var R={},S=[],T=[];O.forEach(function(U){var V=I(U);if(H(U,l))this.$MediaDescription4=V.split(B)[0];if(H(U,m)&&J(V,n)){var W=K(V,n),X=W.split(B),Y=X[0],Z=X[1];R[Z]=Y}if(H(U,m)&&J(V,p))this.$MediaDescription6(V,S);else if(H(U,m)&&J(V,o))this.$MediaDescription7(V,T);else if(H(U,m)&&(V===u||V===v||V===w||V===x))this.$MediaDescription5=V;else this.$MediaDescription1.push(U)}.bind(this));Object.keys(Q).forEach(function(U){if(R[U]){var V=Object.keys(Q[U]).map(function(W){return W+"="+Q[U][W]}).join(";");this.$MediaDescription1.push("a=fmtp:"+R[U]+" "+V)}}.bind(this));this.$MediaDescription3={};this.$MediaDescription2={};S.forEach(function(U){if(Object.prototype.hasOwnProperty.call(U,q)){var V=U.cname;if(!this.$MediaDescription3[V])this.$MediaDescription3[V]=[U];else this.$MediaDescription3[V].push(U);var W=this.findSsrcGroupForSsrc(T,U.ssrc);if(W){if(!this.$MediaDescription2[V])this.$MediaDescription2[V]=[W];else this.$MediaDescription2[V].push(W);this.removeSsrcGroup(W,T)}}}.bind(this));if(this.$MediaDescription4!==G)if(P===y)if(S.length===0)this.$MediaDescription5=v;else this.$MediaDescription5=w;else if(P===z)this.$MediaDescription5=w}M.prototype.getMediaType=function(){return this.$MediaDescription4};M.prototype.findSsrcGroupForSsrc=function(O,P){return O.find(function(Q){var R=Q.ssrcs;return R.some(function(S){return S===P})})};M.prototype.addStreamsForEndpoint=function(O,P){this.$MediaDescription3[O]=P};M.prototype.addSsrcGroupsForEndpoint=function(O,P){this.$MediaDescription3[O].forEach(function(Q){var R=Q.ssrc,S=this.findSsrcGroupForSsrc(P,R);if(S){if(!this.$MediaDescription2[O])this.$MediaDescription2[O]=[S];else this.$MediaDescription2[O].push(S);this.removeSsrcGroup(S,P)}}.bind(this))};M.prototype.removeSsrcGroup=function(O,P){var Q=P.indexOf(O);if(Q!==-1)P.splice(Q,1)};M.prototype.$MediaDescription7=function(O,P){var Q=K(O,o);if(Q){var R=Q.split(B),S=R[0],T=R.slice(1);P.push({semantics:S,ssrcs:T.map(function(U){return parseInt(U,10)})})}};M.prototype.$MediaDescription6=function(O,P){var Q=O.indexOf(B),R=O.substr(0,Q),S=parseInt(K(R,p),10),T=O.substr(Q+1),U=P.find(function(U){return U.ssrc===S});if(!U){U={};U.ssrc=S;P.push(U)}if(J(T,q))U.cname=K(T,q);else if(J(T,r)){var V=K(T,r).split(B);U.msid={id:V[0],appdata:V[1]}}else if(J(T,s))U.mslabel=K(T,s);else if(J(T,t))U.label=K(T,t)};M.prototype.toSdp=function(){var O=[];this.$MediaDescription1.forEach(function(R){O.push(R)});for(var P in this.$MediaDescription2)this.$MediaDescription2[P].forEach(function(R){O.push(m+A+o+C+R.semantics+B+R.ssrcs.join(B))});O.push(m+A+this.$MediaDescription5);for(var Q in this.$MediaDescription3)this.$MediaDescription3[Q].forEach(function(R){if(R.cname)O.push(m+A+p+C+R.ssrc+B+q+C+R.cname);if(R.msid)O.push(m+A+p+C+R.ssrc+B+r+C+R.msid.id+(R.msid.appdata?B+R.msid.appdata:""));if(R.mslabel)O.push(m+A+p+C+R.ssrc+B+s+C+R.mslabel);if(R.label)O.push(m+A+p+C+R.ssrc+B+t+C+R.label)});return O.join(D)};function N(O){var P=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],Q=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],R=P.type,S=R===undefined?"offer":R,T=P.sdp,U=T===undefined?"":T;this.$RTCSessionDescription2=O;this.type=S;switch(O){case h.CUSTOM:this.$RTCSessionDescription1=U;return;case h.MULTIWAY:this.$RTCSessionDescription3(U,Q);return;case h.P2P:this.$RTCSessionDescription4(U,Q);return}}N.prototype.$RTCSessionDescription3=function(O,P){var Q=O.trim().split(D),R=[],S=0;while(S<Q.length&&!H(Q[S],l)){R.push(Q[S]);S++}this.sessionDescription=new L(R);this.mediaDescriptions=[];while(S<Q.length){var T=[];T.push(Q[S]);S++;while(S<Q.length&&!H(Q[S],l)){T.push(Q[S]);S++}this.mediaDescriptions.push(new M(T,this.type,P.FORMAT_PARAMETERS))}};N.prototype.$RTCSessionDescription4=function(O,P){var Q=[];if(this.type==="offer"){if(P.DISABLE_VIDEO)Q.push(function(O){return c("FBRTCSdpUtils").disableVideo(O)});Q.push(function(O){return c("FBRTCSdpUtils").addIceOptionToSdp(O,"fb-force-5245")},function(O){return c("FBRTCSdpUtils").replaceRTPSAVPFProfile(O)},function(O){return c("FBRTCSdpUtils").preferIsac(O)},function(O){return c("FBRTCSdpUtils").removeSdparta(O)},function(O){return c("FBRTCSdpUtils").addNullVideo(O)},function(O){return c("FBRTCSdpUtils").addSetup(O)});if(P.ADD_AUDIO_NACK)Q.push(function(O){return c("FBRTCSdpUtils").addAudioNack(O)})}else{Q.push(function(O){return c("FBRTCSdpUtils").addIceOptionToSdp(O,"fb-force-5245")},function(O){return c("FBRTCSdpUtils").addNullVideo(O)});if(P.USE_DTLS_OVER_CRYPTO)Q.push(function(O){return c("FBRTCSdpUtils").useDTLSOverCrypto(O)})}this.$RTCSessionDescription1=Q.reduce(function(O,R){return R(O)},O)};N.prototype.processServerMediaUpdate=function(O){var P=O.sourceKey,Q=O.media,R=O.ssrcGroups,S=[],T=[];Q.forEach(function(U){U.ssrcs.forEach(function(V){var W={ssrc:V,cname:P,msid:{id:P,appdata:U.id},label:U.id,mslabel:P};if(c("FBRTCMediaType").AUDIO===U.type)S.push(W);else if(c("FBRTCMediaType").VIDEO===U.type)T.push(W)})});this.mediaDescriptions.forEach(function(U){if(U.getMediaType()===E){U.addStreamsForEndpoint(P,S);U.addSsrcGroupsForEndpoint(P,R)}else if(U.getMediaType()===F){U.addStreamsForEndpoint(P,T);U.addSsrcGroupsForEndpoint(P,R)}})};N.prototype.toDesc=function(){return new i({type:this.type,sdp:this.toSdp()})};N.prototype.toSdp=function(){var O=this.$RTCSessionDescription2;switch(O){case h.MULTIWAY:return[this.sessionDescription.toSdp(),this.mediaDescriptions.map(function(P){return P.toSdp()}).join(D),""].join(D);case h.CUSTOM:case h.P2P:default:return this.$RTCSessionDescription1}};N.prototype.strongDiff=function(O){var P=this.toSdp(),Q=O.toSdp();return P!==Q&&this.$RTCSessionDescription5(P)!==this.$RTCSessionDescription5(Q)};N.prototype.$RTCSessionDescription5=function(O){return this.$RTCSessionDescription6(O).split("\r\n").filter(function(P){return!/^a=(candidate|setup):/.test(P)}).join("\r\n")};N.prototype.$RTCSessionDescription6=function(O){return O.replace(/(o=\S+\s\S+)\s\S+\s/,"$1 - ")};f.exports=N}),null);
__d("FBRTCPeerConnection",["Promise","regeneratorRuntime","FBRTCSdpUtils","Map","RTCIceCandidate","RTCPeerConnection","RTCSessionDescription","UserAgent"],(function a(b,c,d,e,f,g){"use strict";function h(w){var x=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],y=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection7=new(c("Map"))();this.addEventListener=function(z,A){var B=this.$FBRTCPeerConnection7.get(z);if(!Array.isArray(B)){B=[];this.$FBRTCPeerConnection7.set(z,B)}B.push(A);this.$FBRTCPeerConnection5.addEventListener(z,A)};this.removeEventListener=function(z,A){var B=this.$FBRTCPeerConnection7.get(z);if(Array.isArray(B)){B=B.filter(function(C){return C!==A});if(B.length<1)this.$FBRTCPeerConnection7["delete"](z);else this.$FBRTCPeerConnection7.set(z,B)}this.$FBRTCPeerConnection5.removeEventListener(z,A)};this.$FBRTCPeerConnection9=function(z){var A=z.candidate;if(A)this.$FBRTCPeerConnection4.push(A)}.bind(this);this.$FBRTCPeerConnection10=function(z){var A=z.channel;this.$FBRTCPeerConnection11(A)}.bind(this);this.$FBRTCPeerConnection6=w;this.$FBRTCPeerConnection1=x;this.$FBRTCPeerConnection2=y;this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8()}h.prototype.$FBRTCPeerConnection8=function(){var w=new(c("RTCPeerConnection"))(this.$FBRTCPeerConnection1,this.$FBRTCPeerConnection2);w.addEventListener("icecandidate",this.$FBRTCPeerConnection9);w.addEventListener("datachannel",this.$FBRTCPeerConnection10);for(var x=this.$FBRTCPeerConnection7.entries(),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}var B=A,C=B[0],D=B[1];for(var E=D,F=Array.isArray(E),G=0,E=F?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var H;if(F){if(G>=E.length)break;H=E[G++]}else{G=E.next();if(G.done)break;H=G.value}var I=H;w.addEventListener(C,I)}}return w};h.prototype.reset=function(){var w=this.$FBRTCPeerConnection5;for(var x=this.$FBRTCPeerConnection7.entries(),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}var B=A,C=B[0],D=B[1];for(var E=D,F=Array.isArray(E),G=0,E=F?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var H;if(F){if(G>=E.length)break;H=E[G++]}else{G=E.next();if(G.done)break;H=G.value}var I=H;w.removeEventListener(C,I)}}w.removeEventListener("datachannel",this.$FBRTCPeerConnection9);w.removeEventListener("icecandidate",this.$FBRTCPeerConnection9);this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8();for(var J=w.getLocalStreams(),K=Array.isArray(J),L=0,J=K?J:J[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var M;if(K){if(L>=J.length)break;M=J[L++]}else{L=J.next();if(L.done)break;M=L.value}var N=M;this.addStream(N)}return c("Promise").race([new(c("Promise"))(function(O){var P=this.$FBRTCPeerConnection5,Q=function Q(R){var S=R.target;if(S.iceConnectionState!=="checking"&&S.iceConnectionState!=="new"){O();P.removeEventListener("iceconnectionstatechange",Q);q(w)}};P.addEventListener("iceconnectionstatechange",Q)}.bind(this)),new(c("Promise"))(function(O){return setTimeout(O,5e3)})])["catch"](function(O){return c("Promise").resolve()}).then(function(){q(w)})};h.prototype.close=function(){q(this.$FBRTCPeerConnection5)};h.prototype.getCreatedIceCandidates=function(){return this.$FBRTCPeerConnection4};h.prototype.$FBRTCPeerConnection11=function(w){w.addEventListener("close",function(){this.$FBRTCPeerConnection3=this.$FBRTCPeerConnection3.filter(function(x){return x!==w})}.bind(this));this.$FBRTCPeerConnection3.push(w)};h.prototype.onReceivedRemoteIceCandidate=function(w){var x=w.sdp,y=w.label,z=w.sdp_mid,A=new(c("RTCIceCandidate"))({sdpMLineIndex:y,candidate:c("FBRTCSdpUtils").fixMobileIceSdp(x),sdpMid:z});this.$FBRTCPeerConnection5.addIceCandidate(A)};h.prototype.getLocalStreams=function(){return this.$FBRTCPeerConnection5.getLocalStreams()};h.prototype.getRemoteStreams=function(){return this.$FBRTCPeerConnection5.getRemoteStreams()};h.prototype.addStream=function(w,x){if(r("addTrack"))for(var y=w.getTracks(),z=Array.isArray(y),A=0,y=z?y:y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var B;if(z){if(A>=y.length)break;B=y[A++]}else{A=y.next();if(A.done)break;B=A.value}var C=B,D=this.$FBRTCPeerConnection5.addTrack(C,w);if(x)x(D)}else this.$FBRTCPeerConnection5.addStream(w)};h.prototype.removeStream=function(w){var x,y=this;if(r("removeTrack")&&r("getSenders"))(function(){var z=w.getTracks(),A=y.$FBRTCPeerConnection5.getSenders().filter(function(F){return z.includes(F.track)});for(var B=A,C=Array.isArray(B),D=0,B=C?B:B[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(C){if(D>=B.length)break;E=B[D++]}else{D=B.next();if(D.done)break;E=D.value}var F=E;y.$FBRTCPeerConnection5.removeTrack(F)}})();else this.$FBRTCPeerConnection5.removeStream(w)};h.prototype.createOffer=function w(){var x=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],y=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],z=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return c("regeneratorRuntime").async(function A(B){while(1)switch(B.prev=B.next){case 0:return B.abrupt("return",j(this.$FBRTCPeerConnection5,x).then(function(C){return v(C,z)}).then(function(C){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,C,{FORMAT_PARAMETERS:y})}.bind(this)));case 1:case"end":return B.stop()}},null,this)};h.prototype.createAnswer=function w(){return c("regeneratorRuntime").async(function x(y){while(1)switch(y.prev=y.next){case 0:return y.abrupt("return",k(this.$FBRTCPeerConnection5).then(function(z){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,z)}.bind(this)));case 1:case"end":return y.stop()}},null,this)};h.prototype.setLocalDescription=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:return z.abrupt("return",o(this.$FBRTCPeerConnection5,x.toDesc()).then(function(){return x}));case 1:case"end":return z.stop()}},null,this)};h.prototype.setRemoteDescription=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:return z.abrupt("return",p(this.$FBRTCPeerConnection5,x.toDesc()).then(function(){return x}));case 1:case"end":return z.stop()}},null,this)};h.prototype.getLocalDescription=function(){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.localDescription||{})};h.prototype.getRemoteDescription=function(){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.remoteDescription||{})};h.prototype.getSignalingState=function(){return this.$FBRTCPeerConnection5.signalingState};h.prototype.getIceGatheringState=function(){return this.$FBRTCPeerConnection5.iceGatheringState};h.prototype.getIceConnectionState=function(){return this.$FBRTCPeerConnection5.iceConnectionState};h.prototype.getStats=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:if(!(x!=null)){z.next=2;break}return z.abrupt("return",c("Promise").reject(new Error("getStats() doesn't support selector (yet)")));case 2:if(!c("UserAgent").isBrowser("Edge")){z.next=4;break}return z.abrupt("return",c("Promise").resolve(new(c("Map"))()));case 4:if(!c("UserAgent").isBrowser("Firefox")){z.next=6;break}return z.abrupt("return",c("Promise").resolve(this.$FBRTCPeerConnection5.getStats()).then(function(A){if(c("UserAgent").isBrowser("Firefox >= 48"))return A;return t(A)}).then(function(A){if(c("UserAgent").isBrowser("Firefox >= 53"))return A;try{A.forEach(function(C){C.type=u(C.type)})}catch(B){if(B.name!=="TypeError")throw B;A.forEach(function(C,D){A.set(D,babelHelpers["extends"]({},C,{type:u(C.type)}))})}return A}));case 6:if(!(c("UserAgent").isBrowser("Chrome")||c("UserAgent").isBrowser("Opera"))){z.next=8;break}return z.abrupt("return",new(c("Promise"))(function(A,B){this.$FBRTCPeerConnection5.getStats(A,B)}.bind(this)).then(function(A){var B={};for(var C=A.result(),D=Array.isArray(C),E=0,C=D?C:C[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var F;if(D){if(E>=C.length)break;F=C[E++]}else{E=C.next();if(E.done)break;F=E.value}var G=F,H={id:G.id,timestamp:G.timestamp,type:u(G.type)};for(var I=G.names(),J=Array.isArray(I),K=0,I=J?I:I[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var L;if(J){if(K>=I.length)break;L=I[K++]}else{K=I.next();if(K.done)break;L=K.value}var M=L;H[M]=G.stat(M)}B[H.id]=H}return B}).then(t));case 8:return z.abrupt("return",c("Promise").reject(new Error("getStats() not supported")));case 9:case"end":return z.stop()}},null,this)};h.prototype.createDataChannel=function(w,x){if(this.$FBRTCPeerConnection5.createDataChannel){var y=this.$FBRTCPeerConnection5.createDataChannel(w,x);this.$FBRTCPeerConnection11(y);return y}return null};h.prototype.getDataChannelByLabel=function(w){return this.$FBRTCPeerConnection3.find(function(x){return x.label===w})};var i=c("UserAgent").isBrowser("Chrome < 52")||c("UserAgent").isBrowser("Opera < 39")||c("UserAgent").isBrowser("Firefox < 37");function j(w,x){if(i)return new(c("Promise"))(function(y,z){return w.createOffer(y,z,m(x))});return c("Promise").resolve(w.createOffer(m(x)))}function k(w){if(i)return new(c("Promise"))(function(x,y){return w.createAnswer(x,y)});return c("Promise").resolve(w.createAnswer())}var l=c("UserAgent").isBrowser("Chrome < 38")||c("UserAgent").isBrowser("Opera < 26");function m(w){var x=w.offerToReceiveAudio,y=x===undefined?true:x,z=w.offerToReceiveVideo,A=z===undefined?true:z,B=babelHelpers.objectWithoutProperties(w,["offerToReceiveAudio","offerToReceiveVideo"]);if(l){if(Object.keys(B).length>0)return{mandatory:{OfferToReceiveAudio:y,OfferToReceiveVideo:A},optional:babelHelpers["extends"]({},s(B))};return{mandatory:{OfferToReceiveAudio:y,OfferToReceiveVideo:A}}}return babelHelpers["extends"]({offerToReceiveAudio:y,offerToReceiveVideo:A},B)}var n=c("UserAgent").isBrowser("Chrome < 51")||c("UserAgent").isBrowser("Opera < 38")||c("UserAgent").isBrowser("Firefox < 37");function o(w,x){if(n)return new(c("Promise"))(function(y,z){return w.setLocalDescription(x,y,z)});return c("Promise").resolve(w.setLocalDescription(x))}function p(w,x){if(n)return new(c("Promise"))(function(y,z){return w.setRemoteDescription(x,y,z)});return c("Promise").resolve(w.setRemoteDescription(x))}function q(w){if(w&&w.signalingState!=="closed")w.close()}function r(w){return w in c("RTCPeerConnection").prototype}function s(w){var x={};for(var y=Object.keys(w),z=Array.isArray(y),A=0,y=z?y:y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var B;if(z){if(A>=y.length)break;B=y[A++]}else{A=y.next();if(A.done)break;B=A.value}var C=B,D=""+C.substr(0,1).toUpperCase()+C.substr(1);x[D]=w[C]}return x}function t(w){return new(c("Map"))(Object.keys(w).map(function(x){return[x,w[x]]}))}function u(w){switch(w){case"inbound-rtp":return"inboundrtp";case"outbound-rtp":return"outboundrtp";case"candidate-pair":return"candidatepair";case"local-candidate":return"localcandidate";case"remote-candidate":return"remotecandidate";default:return w}}function v(w,x){var y=x.audio,z=x.video,A=w.sdp,B=w.type;if(y)A=c("FBRTCSdpUtils").preferCodec(A,y,false);if(z)A=c("FBRTCSdpUtils").preferCodec(A,z,true);return c("Promise").resolve({sdp:A,type:B})}f.exports=h}),null);
__d("RTCMWProtocolHandler",["regeneratorRuntime","Promise","AsyncRequest","FBRTCConstants","Base64","ChannelManager","CurrentUser","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCGroupCallStore","FBRTCPeerConnection","FBRTCRtcResponseStatusCode","FBRTCSdpUtils","FBRTCVideoQuality","MercuryIDs","MercuryParticipants","MercuryParticipantsConstants","MultiwayParticipantFetcher","MultiwayRequests","RTCCallActions","RTCCallStore","RTCConfig","RTCGroupCallActions","RTCMultiwayMessageHandler","RTCSessionDescription","RTCUtils","emptyFunction"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCConstants").CallEndReason,i=c("FBRTCConstants").CallType,j=c("FBRTCConstants").GroupVideoViewLayout,k=c("FBRTCConstants").IceConnectionState,l=c("FBRTCConstants").SignalingProtocol,m="229895473858072",n=18e4,o={appId:m,deviceId:c("ChannelManager").getCompleteConfig().sessionID,userId:c("CurrentUser").getID()};c("ChannelManager").startChannelManager();function p(){var r=arguments.length<=0||arguments[0]===undefined?null:arguments[0];this.$RTCMWProtocolHandler4=false;this.$RTCMWProtocolHandler7=function(s){var t=s.target;c("RTCCallActions").emit("onIceConnectionStateChange",t.iceConnectionState);switch(t.iceConnectionState){case k.DISCONNECTED:case k.FAILED:if(!this.$RTCMWProtocolHandler2)this.$RTCMWProtocolHandler2=setTimeout(function(){c("RTCCallActions").endCall(h.CONNECTION_DROPPED,"ConnectionDropped");var u=c("RTCCallStore").getState(),v=u.connections;c("RTCMultiwayMessageHandler").close();v.forEach(function(w){return w.close()});c("RTCCallActions").removeAllLocalStreams(true)},n);break;default:clearTimeout(this.$RTCMWProtocolHandler2);this.$RTCMWProtocolHandler2=null}}.bind(this);this.$RTCMWProtocolHandler1=r}p.prototype.startCall=function(r,s,t,u){var v=u.addStreamCallback,w=v===undefined?c("emptyFunction"):v,x=u.callTrigger,y=u.formatParameters,z=y===undefined?{}:y,A=u.preferredCodecs,B=A===undefined?{}:A,C=u.serverInfoData,D=u.shouldSetDescriptions,E=D===undefined?true:D;c("RTCCallActions").initialize(l.MULTIWAY,t,C,this.$RTCMWProtocolHandler1,x);var F=c("FBRTCCallSummary").restoreOrInitialize(c("FBRTCCallSummaryStore").getInstance(),c("RTCUtils").isGroupCall(t)?-1:c("RTCUtils").getPeerID(t),this.$RTCMWProtocolHandler1,!C);x&&F.onCallStarted(x);F.setIsUsingMultiway(1);F.onPopupOpened();F.setConferenceName(t);F.setServerInfoData(C);F.save(c("FBRTCCallSummaryStore").getInstance());c("RTCCallActions").setCallSummary(F);c("RTCGroupCallActions").setMWCallType(s.some(function(J){return J.getVideoTracks().length>0})?i.DIRECT_VIDEO:i.VOIP);var G={mandatory:{},optional:[{googNumUnsignalledRecvStreams:10},{googHighBitrate:true},{googVeryHighBitrate:true},{RtpDataChannels:true}]};if(!c("RTCConfig").RtcUseDtlsGK)G.optional.push({DtlsSrtpKeyAgreement:false});var H=new(c("FBRTCPeerConnection"))(l.MULTIWAY,{iceServers:[]},G),I=H.createDataChannel("data");if(I)I.onmessage=function(J){var K=J.data;try{var L=JSON.parse(K),M=L.body;this.$RTCMWProtocolHandler5(M)}catch(N){}}.bind(this);H.addEventListener("addstream",function(event){this.$RTCMWProtocolHandler6(t,event.stream)}.bind(this));H.addEventListener("removestream",function(event){c("RTCCallActions").removeRemoteStream(event.stream)});H.addEventListener("iceconnectionstatechange",this.$RTCMWProtocolHandler7);this.$RTCMWProtocolHandler8(H,s,t,C,r,w,z,B,E);if(!C)c("RTCCallActions").call(r,H);else c("RTCCallActions").join(H);return H};p.prototype.$RTCMWProtocolHandler6=function(r,s){s.onaddtrack=function(u){var v=u.target,w=u.track;c("RTCCallActions").addRemoteTrack(v,w)};s.onremovetrack=function(u){var v=u.target,w=u.track;c("RTCCallActions").removeRemoteTrack(v,w)};var t=s.id.split(":")[0];if(t!==c("CurrentUser").getID())c("MultiwayParticipantFetcher").fetchParticipant(r,t).done(function(u){var v={},w=c("MercuryIDs").getParticipantIDFromUserID(t);c("MercuryParticipants").getBigImageMulti([w],function(x){v[w]=u;c("RTCGroupCallActions").onParticipantsAdded(v,x);c("RTCCallActions").addRemoteStream(s);var y=c("RTCCallStore").getState(),z=y.callInfo,A=y.connections,B=c("FBRTCGroupCallStore").getState(),C=B.layout,D=B.pinnedSpeakerFBID;p.subscription(z.conferenceName,z.serverInfoData,A.first().getRemoteStreams(),C,D)},c("MercuryParticipantsConstants").WWW_INCALL_THUMBNAIL_SIZE)})};p.prototype.$RTCMWProtocolHandler5=function(r){if(r.genericMessage&&r.genericMessage.data){var s=JSON.parse(c("Base64").decode(r.genericMessage.data)),t=!c("RTCCallStore").getState().localUser.isAudioMuted();if(s.RTC_REMOTE_COMMAND==="MUTE_SELF"&&t)c("RTCCallActions").toggleMuteAudio(false)}else if(r.dominantSpeakerNotification){var u=r.dominantSpeakerNotification.userId;c("RTCGroupCallActions").setDominantSpeaker(u)}};p.prototype.setDescriptions=function(){this.$RTCMWProtocolHandler4=true;var r=c("RTCCallStore").getState().connections.first();if(this.$RTCMWProtocolHandler3)r.setRemoteDescription(this.$RTCMWProtocolHandler3)};p.videoEscalation=function(){return c("RTCUtils").initLocalStream(true).then(function(r){var s=c("RTCCallStore").getState(),t=s.callInfo,u=t.conferenceName,v=t.serverInfoData,w=s.connections,x=s.localUser;r.getTracks().forEach(function(z){if(z.kind==="audio")z.enabled=!x.isAudioMuted()});var y=x.streams.first();w.first().removeStream(y);return q(w.first(),[r],u,v,[]).then(function(){c("RTCCallActions").removeLocalStream(y);c("RTCCallActions").addLocalStream(r);c("RTCGroupCallActions").setMWCallType(i.ESCALATED)})})};p.endCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];p.genEndCall(r,s,t,u).done()};p.genEndCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];c("RTCMultiwayMessageHandler").close();c("RTCCallActions").removeAllLocalStreams(true);c("RTCCallActions").hangup(t,u);return c("MultiwayRequests").sendHangupRequest(o,r,s,t,u||"Hangup by user").then(function(){c("RTCCallActions").hangupSuccess()})["catch"](function(v){c("RTCCallActions").hangupError();throw v})};p.otherUserInAnotherCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];c("MultiwayRequests").sendHangupRequest(o,r,s,t,u||"User receiving this call is in another call").done()};p.prototype.iceRestart=function(r,s){q(c("RTCCallStore").getState().connections.first(),[],r,s,[],{iceRestart:true})};p.addParticipants=function(r,s,t){c("MultiwayRequests").sendAddParticipantsRequest(o,r,s,t)};p.subscription=function(r,s,t,u,v){var w=u===j.DOMINANT_SPEAKER?c("FBRTCVideoQuality").LOW:u===j.GRID?c("FBRTCVideoQuality").MEDIUM:c("FBRTCVideoQuality").HIGH,x=t.map(function(y){var z=y.id;return{cname:z,options:{videoQuality:u===j.DOMINANT_SPEAKER&&v===z.split(":")[0]?c("FBRTCVideoQuality").HIGH:w}}});if(u===j.DOMINANT_SPEAKER&&!v)x.push({cname:""});c("MultiwayRequests").sendSubscriptionRequest(o,r,s,x)};p.clientMediaUpdate=function(r,s,t,u,v){c("MultiwayRequests").sendClientMediaUpdateRequest(o,r,s,t,u,v).then(function(w){var x=w.header.responseStatusCode,y=w.body.clientMediaUpdateResponse.currentVersion;return c("RTCGroupCallActions").onClientMediaUpdateResponse(x,y)})["catch"](function(w){})};p.prototype.$RTCMWProtocolHandler8=function(r,s,t,u,v,w,x,y,z){this.$RTCMWProtocolHandler9(t,u);q(r,s,t,u,v,{},w,x,y,z).done(function(A){this.$RTCMWProtocolHandler3=A;if(this.$RTCMWProtocolHandler4)this.setDescriptions();c("RTCCallActions").callSuccess()}.bind(this),function(A){c("RTCCallActions").callError(A);var B=c("RTCCallStore").getState(),C=B.connections;c("RTCMultiwayMessageHandler").close();C.forEach(function(D){return D.close()});c("RTCCallActions").removeAllLocalStreams(true)})};p.prototype.$RTCMWProtocolHandler9=function(r,s){c("RTCMultiwayMessageHandler").initHandler(r,s)};function q(r,s,t,u,v){var w=arguments.length<=5||arguments[5]===undefined?{}:arguments[5],x=arguments.length<=6||arguments[6]===undefined?c("emptyFunction"):arguments[6],y=arguments.length<=7||arguments[7]===undefined?{}:arguments[7],z=arguments.length<=8||arguments[8]===undefined?{}:arguments[8],A=arguments.length<=9||arguments[9]===undefined?true:arguments[9],B,C,D,E,F,G;return c("regeneratorRuntime").async(function H(I){while(1)switch(I.prev=I.next){case 0:B={};C=[];s.forEach(function(J){C.concat(J.getTracks());r.addStream(J,x)});C.forEach(function(J){B[J.id]=true});I.next=6;return c("regeneratorRuntime").awrap(r.createOffer(w,y,z));case 6:D=I.sent;if(c("FBRTCSdpUtils").validateOfferSdp(t,D.toSdp())){I.next=9;break}throw c("FBRTCRtcResponseStatusCode").BAD_REQUEST;case 9:I.next=11;return c("regeneratorRuntime").awrap(r.setLocalDescription(D));case 11:c("RTCGroupCallActions").onJoinRequestSent();I.next=14;return c("regeneratorRuntime").awrap(c("MultiwayRequests").sendJoinRequest(o,t,u,D,v.length>0?v:null,C.length>0?B:null));case 14:E=I.sent;F=E.header.responseStatusCode;if(!(F!==c("FBRTCRtcResponseStatusCode").OK)){I.next=18;break}return I.abrupt("return",new(c("Promise"))(function(J,K){K(F)}));case 18:c("RTCGroupCallActions").onJoinResponse(E.header.serverInfoData);G=new(c("RTCSessionDescription"))(l.MULTIWAY,{type:"answer",sdp:E.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:y});if(!A){I.next=23;break}I.next=23;return c("regeneratorRuntime").awrap(r.setRemoteDescription(G));case 23:c("RTCGroupCallActions").toggleRemoteStream(E.body.joinResponse.mediaStatus);return I.abrupt("return",G);case 25:case"end":return I.stop()}},null,this)}f.exports=p}),null);
__d("RTCDialogProvider.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("React").PureComponent,k=c("React").PropTypes;h=babelHelpers.inherits(l,j);i=h&&h.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.state={dialog:null},this.$RTCDialogProvider1=function(r){this.setState({dialog:r})}.bind(this),this.$RTCDialogProvider2=function(){var r=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(!r)this.setState({dialog:null})}.bind(this),n}l.prototype.getChildContext=function(){return{dialogShow:this.$RTCDialogProvider1,dialogHide:this.$RTCDialogProvider2}};l.prototype.render=function(){return c("React").createElement("div",this.props,this.props.children,this.state.dialog)};l.childContextTypes={dialogShow:k.func,dialogHide:k.func};f.exports=l}),null);
__d("RTCAppView.react",["cx","React","RTCDialogProvider.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.isAudioCall,m=l===undefined?false:l,n=babelHelpers.objectWithoutProperties(j,["children","isAudioCall"]);return c("React").createElement(c("RTCDialogProvider.react"),babelHelpers["extends"]({className:"_32ut"+(m?" _32uu":"")},n),k)};f.exports=i}),null);
__d("Fragment.react",["React"],(function a(b,c,d,e,f,g){"use strict";function h(i){var j=i.children;return j}f.exports=h}),null);
__d("RTCSVGIcon.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").Children,i=function i(j){var k=j.children,l=babelHelpers.objectWithoutProperties(j,["children"]);return c("React").cloneElement(h.only(k),babelHelpers["extends"]({preserveAspectRatio:"xMidYMid meet"},l))};f.exports=i}),null);
__d("RTCUserMediaRequestState",["keyMirror"],(function a(b,c,d,e,f,g){"use strict";var h=c("keyMirror")({FULFILLED:null,PENDING:null,REJECTED:null});f.exports=h}),null);
__d("RTCGrantUserMediaAccessView.react",["cx","fbt","FBRTCConfig","Fragment.react","Link.react","React","RTCSVGIcon.react","RTCUserMediaRequestState","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=function j(n){var o=n.children,p=n.className,q=n.isAudioCall,r=q===undefined?false:q,s=n.userMediaRequest,t=babelHelpers.objectWithoutProperties(n,["children","className","isAudioCall","userMediaRequest"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")(p,"_5ajm"+(r?" _4w_w":""))},t),c("React").createElement(k,{isAudioCall:r,userMediaRequest:s}),c("React").createElement("p",{className:"_5b2y"},r?i._("To make a call on Facebook, you need to turn your microphone on. This will let people hear you during the call."):i._("To make a call on Facebook, you need to turn your camera and microphone on. This will let people see and hear you during the call.")),c("React").createElement("p",{className:"_5b2y"},r?i._("You can turn this off later."):i._("You can turn these off later.")," ",c("React").createElement(c("Link.react"),{href:c("FBRTCConfig").userMediaPermissionErrorUrl(),target:"_blank"},i._("Learn more"))))},k=function k(n){var o=n.isAudioCall,p=n.userMediaRequest;return c("React").createElement("header",{className:"_5ajs"},c("React").createElement("div",{className:"_5b02"},o?null:c("React").createElement(c("RTCSVGIcon.react"),{className:"_5b34"+(p.state===c("RTCUserMediaRequestState").REJECTED?" _4w_y":"")},c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:"M36 29h1V19h-1v10zm-6-2.727L35 29V19l-5 2.727v4.546zM19.344 17H26c1.126 0 2 .938 2 2v10c0 .54-.225 1.047-.595 1.415L19.345 17zm-3.5 0H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h9.257l-8.413-14zm11.408 17.044l.857-.516-12.362-20.572-.857.516 12.362 20.572z",fillRule:"evenodd"}))),c("React").createElement(c("RTCSVGIcon.react"),{className:"_5b34"+(p.state===c("RTCUserMediaRequestState").REJECTED?" _4w_y":"")},c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:"M25 31c.7-.1 1.3-.3 1.9-.6l-.5-.9c-.6.3-1.2.5-1.9.5-2.5 0-4.5-2.2-4.5-5v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3zm-.5-2c.5 0 1-.1 1.4-.3L21 20.6v4.9c0 1.9 1.6 3.5 3.5 3.5zm-5.8-16l-.9.5L30.3 34l.9-.5L18.7 13zM30 25.2V20h-1v5c0 .8-.2 1.6-.5 2.2l.6 1c.6-.8.9-1.9.9-3zm-2 .3v-9c0-1.9-1.6-3.5-3.5-3.5-1.5 0-2.7.9-3.2 2.2L28 26.3v-.8z"})))),c("React").createElement(l,{isAudioCall:o,userMediaRequest:p}))},l=function l(n){var o=n.isAudioCall,p=n.userMediaRequest;if(p.state===c("RTCUserMediaRequestState").REJECTED)return c("React").createElement(c("Fragment.react"),null,c("React").createElement("h1",{className:"_5b03"},o?i._("An Error occured when trying to get access to Microphone:"):i._("An Error occured when trying to get access to Camera and\/or Microphone:")),c("React").createElement("p",{className:"_4x0t"},m(p)));return c("React").createElement("h1",{className:"_5b03"},o?i._("Please allow microphone access"):i._("Please allow camera and microphone access"))};function m(n){var o=n.error;if(o==null)return"Unknown Error";if(o.message)return o.message;switch(o.name){case"AbortError":return"Hardware Access aborted.";case"NotAllowedError":return"Access to Media Devices has been denied.";case"NotFoundError":return"Devices matching requirements were not found or were not accessible.";case"NotReadableError":return"Hardware Access Error.";case"OverconstrainedError":return"Media Constraints not met.";case"SecurityError":return"User media support is disabled.";case"TypeError":return"Media Constraints corrupted.";default:return"Unknown Error"}}f.exports=j}),null);
__d("RTCAudio.react",["cx","FBRTCUtils","MediaStream","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("audio",{autoPlay:true,className:c("joinClasses")(this.props.className,"_8md"),controls:false,muted:this.props.muted,ref:function(m){return this.$RTCAudio1=m}.bind(this)})};l.prototype.componentDidMount=function(){this.$RTCAudio2();this.$RTCAudio3()};l.prototype.$RTCAudio2=function(){if(!this.$RTCAudio1)return;var m=this.props.mediaStream;if(m&&m.getVideoTracks().length>0){var n=new(c("MediaStream"))();for(var o=m.getAudioTracks(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;n.addTrack(s)}c("FBRTCUtils").attachMediaStream(this.$RTCAudio1,n)}else c("FBRTCUtils").attachMediaStream(this.$RTCAudio1,m)};l.prototype.$RTCAudio3=function(){if(!this.$RTCAudio1)return;var m=this.props.audioSinkID;if(m&&this.$RTCAudio1.setSinkId)this.$RTCAudio1.setSinkId(m)};l.prototype.componentDidUpdate=function(m){var n=m.audioSinkID,o=m.mediaStream;if(o!==this.props.mediaStream)this.$RTCAudio2();if(n!==this.props.audioSinkID)this.$RTCAudio3()};function l(){i.apply(this,arguments)}l.defaultProps={muted:false};f.exports=l}),null);
__d("RTCIncallAudio.react",["React","RTCAudio.react"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("React").PureComponent;h=babelHelpers.inherits(k,j);i=h&&h.prototype;k.prototype.render=function(){var l=this.props,m=l.audioSinkID,n=l.className,o=l.mediaStream,p=babelHelpers.objectWithoutProperties(l,["audioSinkID","className","mediaStream"]);return c("React").createElement("div",p,c("React").createElement(c("RTCAudio.react"),{audioSinkID:m,mediaStream:o}))};function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("RTCMediaStreamReadyContainer.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.state={active:false},this.$RTCMediaStreamReadyContainer2=function(){var p=this.props.mediaStream;if(!p)return;if("active"in p){var q=p.active;this.setState({active:q});if(!q)this.$RTCMediaStreamReadyContainer1=setTimeout(this.$RTCMediaStreamReadyContainer2,100)}else{var r=p.getVideoTracks();if(r.some(function(w){return w.readyState==="live"}))this.setState({active:true});else for(var s=r,t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var v;if(t){if(u>=s.length)break;v=s[u++]}else{u=s.next();if(u.done)break;v=u.value}var w=v;w.addEventListener("started",this.$RTCMediaStreamReadyContainer3)}}}.bind(this),this.$RTCMediaStreamReadyContainer3=function(){var p=this.props.mediaStream;if(!p)return;this.setState({active:true});for(var q=p.getVideoTracks(),r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t;u.removeEventListener("started",this.$RTCMediaStreamReadyContainer3)}}.bind(this),l}j.prototype.render=function(){return this.props.children(this.state.active)};j.prototype.componentDidMount=function(){this.$RTCMediaStreamReadyContainer2()};j.prototype.componentWillReceiveProps=function(k){var l=k.mediaStream;if(l!==this.props.mediaStream){this.setState({active:false});clearTimeout(this.$RTCMediaStreamReadyContainer1);this.$RTCMediaStreamReadyContainer2()}};j.prototype.componentWillUnmount=function(){this.setState({active:false});clearTimeout(this.$RTCMediaStreamReadyContainer1)};f.exports=j}),null);
__d("RTCIncallVideo.react",["cx","React","FBRTCVideo.react","RTCMediaStreamReadyContainer.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={mounted:false},this.$RTCIncallVideo1=function(r){var s=this.props,t=s.audioSinkID,u=s.className,v=s.mediaStream,w=s.muted,x=babelHelpers.objectWithoutProperties(s,["audioSinkID","className","mediaStream","muted"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")(u,"_chh"+(r&&!w&&this.state.mounted?" active":""))},x),c("React").createElement(c("FBRTCVideo.react"),{audioSinkID:t,mediaStream:v}),this.props.children)}.bind(this),n}l.prototype.render=function(){return c("React").createElement(c("RTCMediaStreamReadyContainer.react"),{mediaStream:this.props.mediaStream},this.$RTCIncallVideo1)};l.prototype.componentDidMount=function(){setTimeout(function(){return this.setState({mounted:true})}.bind(this))};l.defaultProps={muted:false};f.exports=l}),null);
__d("FBRTCGroupCallIncallVideo.react",["cx","fbt","Image.react","React","RTCIncallAudio.react","RTCIncallVideo.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=function j(k){var l=k.displayNone,m=l===undefined?false:l,n=k.isAudioCall,o=n===undefined?false:n,p=k.user,q=p.streams.first();return q&&!p.areAllTracksMuted(q.getVideoTracks())?c("React").createElement(c("RTCIncallVideo.react"),{className:"_5k9_"+(m?" none":""),mediaStream:q}):c("React").createElement("div",{className:"_5k9_"+(m?" none":"")+(o?" hidden":"")},c("React").createElement("div",{className:"_2_gq"},c("React").createElement(c("Image.react"),{className:"_2_gr",src:p.profilePictureUrl}),c("React").createElement(c("Image.react"),{className:"_2_gs",src:p.profilePictureUrl,alt:i._("Profile picture")}),c("React").createElement("p",{className:"_5ka3"},i._("{name}'s camera is off",[i.param("name",p.userShortName)])),c("React").createElement(c("RTCIncallAudio.react"),{mediaStream:q})))};f.exports=j}),null);
__d("XMessengerDotComMainController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/t/{?thread_key}/",{thread_key:{type:"String"},mid:{type:"String"},ref:{type:"String"},messaging_source:{type:"Enum",enumType:1},game:{type:"String"}})}),null);
__d("FBRTCGroupCallUserPopoverMenu.react",["cx","fbt","MessengerMenu.react","MessengerPopoverMenu.react","React","XFacebookMessengerInboxController","XMessengerDotComMainController","URI","isMessengerDotComURI"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=c("MessengerMenu.react").Item,k=c("MessengerMenu.react").Separator,l=function l(o){var p=o.children,q=o.user,r=c("React").createElement(c("MessengerMenu.react"),{className:"_2vmq"},c("React").createElement(j,{label:q.userName,disabled:true}),c("React").createElement(k,null),c("React").createElement(j,{label:i._("Message"),onclick:function s(){return m(q.FBID)}}),c("React").createElement(j,{label:i._("View profile"),onclick:function s(){return n(q.profileUrl)}}));return c("React").createElement(c("MessengerPopoverMenu.react"),{menu:r},p)};function m(o){var p=c("isMessengerDotComURI")(c("URI").getRequestURI())?c("XMessengerDotComMainController"):c("XFacebookMessengerInboxController");window.open(p.getURIBuilder().setString("thread_key",o).getURI())}function n(o){o&&window.open(o)}f.exports=l}),null);
__d("RTCRemoteViewPopoverMenuButton.react",["cx","FBRTCGroupCallUserPopoverMenu.react","React","RTCSVGIcon.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(k){var l=k.user;return c("React").createElement(c("FBRTCGroupCallUserPopoverMenu.react"),{user:l},c("React").createElement("div",{className:"_1b12",onClick:j,role:"presentation"},c("React").createElement(c("RTCSVGIcon.react"),null,c("React").createElement("svg",{viewBox:"-10 -6 24 24"},c("React").createElement("path",{d:"M2.157 11.057c-1.013 0-1.843.83-1.843 1.843 0 1.014.83 1.843 1.843 1.843C3.17 14.743 4 13.913 4 12.9c0-1.014-.83-1.843-1.843-1.843zm0-1.843C3.17 9.214 4 8.384 4 7.37c0-1.012-.83-1.84-1.843-1.84S.314 6.357.314 7.37c0 1.015.83 1.844 1.843 1.844zm0-5.528C3.17 3.686 4 2.856 4 1.843 4 .83 3.17 0 2.157 0S.314.83.314 1.843s.83 1.843 1.843 1.843z"})))))};function j(k){k.stopPropagation()}f.exports=i}),null);
__d("FBRTCGroupCallFixedSquaresView.react",["cx","FBRTCGroupCallIncallVideo.react","immutable","React","RTCRemoteViewPopoverMenuButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.state={rootHeightStyle:"",rootWidthStyle:"",streamStyle:""},this.$FBRTCGroupCallFixedSquaresView1=function(){var q=this.props.remoteUsers.size,r=window,s=r.innerHeight,t=r.innerWidth,u=c("immutable").Range(1,q+1).map(function(x){return Math.min(t/x,s/Math.ceil(q/x))}).toArray(),v=u.indexOf(Math.max.apply(Math,u))+1,w=Math.ceil(this.props.remoteUsers.size/v);if(t/v<s/w)this.setState({rootHeightStyle:100/v*w+"vw",rootWidthStyle:"100vw",streamStyle:100/v+"vw"});else this.setState({rootHeightStyle:"100vh",rootWidthStyle:100/w*v+"vh",streamStyle:100/w+"vh"})}.bind(this),m}k.prototype.componentDidMount=function(){this.$FBRTCGroupCallFixedSquaresView1();window.addEventListener("resize",this.$FBRTCGroupCallFixedSquaresView1)};k.prototype.componentDidUpdate=function(){this.$FBRTCGroupCallFixedSquaresView1()};k.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.$FBRTCGroupCallFixedSquaresView1)};k.prototype.render=function(){var l=this.state,m=l.rootHeightStyle,n=l.rootWidthStyle,o=l.streamStyle;return c("React").createElement("div",{className:"_20h7"+(this.props.isAudioCall?" isAudioCall":""),style:{height:m,width:n}},this.props.remoteUsers.map(function(p){return c("React").createElement("div",{className:"_20hc"+(this.props.remoteUsers.size>1?" cover":""),key:p.FBID,style:{height:o,width:o}},c("React").createElement(c("FBRTCGroupCallIncallVideo.react"),{user:p}),c("React").createElement("div",{className:"_20hd"},c("React").createElement(c("RTCRemoteViewPopoverMenuButton.react"),{user:p})))}.bind(this)))};f.exports=k}),null);
__d("FBRTCGroupCallFluidGridView.react",["cx","immutable","React"],(function a(b,c,d,e,f,g,h){"use strict";var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;function k(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={landscape:true},this.$FBRTCGroupCallFluidGridView1=function(){this.setState({landscape:window.innerHeight<=window.innerWidth})}.bind(this),o}k.prototype.componentDidMount=function(){this.$FBRTCGroupCallFluidGridView1();window.addEventListener("resize",this.$FBRTCGroupCallFluidGridView1)};k.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.$FBRTCGroupCallFluidGridView1)};k.prototype.render=function(){return c("React").createElement("div",{className:"_2rid"+(!this.state.landscape?" column":"")+(this.props.hidden?" hide":"")},c("React").createElement(l,{landscape:this.state.landscape,remoteUsers:this.props.remoteUsers,renderUser:this.props.renderUser}))};var l=function l(n){var o=n.remoteUsers,p=n.landscape,q=n.renderUser;if(o.size===1)return q(o.first());return m(o).map(function(r,s){return c("React").createElement("div",{className:"_2rip"+(p?" column":"")+(r.size===3?" big":""),key:s},c("React").createElement(l,{landscape:!p,remoteUsers:r,renderUser:q}))})};function m(n){if(n.size===2)return n.map(function(o){return c("immutable").List([o])});else if(n.size<7||n.size%2==0)return c("immutable").Range(0,n.size,2).map(function(o){return n.slice(o,o+2)}).toList();else return c("immutable").Range(0,n.size-3,2).map(function(o){return n.slice(o,o+2)}).toList().push(n.takeLast(3))}f.exports=k}),null);
__d("FBRTCGroupCallGridView.react",["cx","FBRTCGroupCallIncallVideo.react","immutable","React","RTCRemoteViewPopoverMenuButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={isLandscape:true},this.$FBRTCGroupCallGridView1=function(){this.setState({isLandscape:window.innerHeight/window.innerWidth<=this.props.aspectRatio})}.bind(this),p}l.prototype.componentDidMount=function(){this.$FBRTCGroupCallGridView1();window.addEventListener("resize",this.$FBRTCGroupCallGridView1)};l.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.$FBRTCGroupCallGridView1)};l.prototype.render=function(){var o=this.props,p=o.aspectRatio,q=o.remoteUsers.size,r=this.state.isLandscape?p*4/((q===2?6:q%2===0?0:3)+q):p*((q===2?6:q%2===0?0:3)+q)/4;return c("React").createElement("div",{className:"_3__o"+(this.props.hidden?" hidden":"")+(!this.state.isLandscape?" column":""),style:{height:100*r+"vw",maxWidth:100/r+"vh"}},n(this.props.remoteUsers).map(function(s,t){return c("React").createElement("div",{className:"_cdu"+(s.size===1?" big":"")+(this.state.isLandscape?" column":""),key:t},s.map(function(u){return c("React").createElement("div",{className:"_cdv",key:u.FBID},c("React").createElement("div",{className:"_4lp3",style:{paddingTop:100*p+"%"}}),c("React").createElement(m,{user:u}))}))}.bind(this)))};var m=function m(o){var p=o.user;return c("React").createElement("div",{className:"_cdw"},c("React").createElement(c("FBRTCGroupCallIncallVideo.react"),{user:p}),c("React").createElement("div",{className:"_5-as"},c("React").createElement(c("RTCRemoteViewPopoverMenuButton.react"),{user:p})))};function n(o){if(o.size===2)return o.map(function(q){return c("immutable").List([q])});var p=c("immutable").List();while(!o.isEmpty()){p=p.unshift(o.takeLast(2));o=o.skipLast(2)}return p}f.exports=l}),null);
__d("FBRTCGroupCallIncallView.react",["cx","FBRTCGroupCallFixedSquaresView.react","FBRTCGroupCallFluidGridView.react","FBRTCGroupCallGridView.react","FBRTCGroupCallIncallVideo.react","FBRTCGroupCallStore","FluxContainer","FBRTCConstants","React","RTCRemoteViewPopoverMenuButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("FBRTCConstants").GroupVideoViewLayout,j=6,k=function k(n){var o=n.aspectRatio,p=n.dominantSpeakerFBID,q=n.gridLayout,r=n.isAudioCall,s=n.layout,t=n.pinnedSpeakerFBID,u=n.remoteUsers;switch(s){case i.DOMINANT_SPEAKER:var v=u.find(function(v){return v.FBID===(t||p)});return v?c("React").createElement("div",{className:"_ncs"},c("React").createElement(c("FBRTCGroupCallIncallVideo.react"),{isAudioCall:r,user:v})):null;case i.GRID:if(q==="fixed_squares")return c("React").createElement(c("FBRTCGroupCallFixedSquaresView.react"),{isAudioCall:r,remoteUsers:u});else if(q==="fluid_grid")return c("React").createElement(c("FBRTCGroupCallFluidGridView.react"),{hidden:r,remoteUsers:u,renderUser:function w(v){return c("React").createElement("div",{className:"_2rik"},c("React").createElement(c("FBRTCGroupCallIncallVideo.react"),{user:v}),c("React").createElement("div",{className:"_2ril"},c("React").createElement(c("RTCRemoteViewPopoverMenuButton.react"),{user:v})))}});else return c("React").createElement(c("FBRTCGroupCallGridView.react"),{aspectRatio:o,hidden:r,remoteUsers:u});default:return c("React").createElement("div",{className:"_ncs"},u.map(function(v,w){return c("React").createElement(c("FBRTCGroupCallIncallVideo.react"),{displayNone:w>=j,isAudioCall:r,key:v.FBID,user:v})}))}};function l(){return[c("FBRTCGroupCallStore")]}function m(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],o=arguments[1],p=c("FBRTCGroupCallStore").getState(),q=p.dominantSpeakerFBID,r=p.pinnedSpeakerFBID;return babelHelpers["extends"]({dominantSpeakerFBID:q,pinnedSpeakerFBID:r},o)}f.exports=c("FluxContainer").createFunctional(k,l,m,{withProps:true})}),null);
__d("RTCAppSpinner.react",["cx","MessengerSpinner.react","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.className;return c("React").createElement(c("MessengerSpinner.react"),{className:c("joinClasses")("_4ywx",k),color:"blue",size:32})};f.exports=i}),null);
__d("RTCAppViewMain.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=j.fullBleed,n=m===undefined?true:m,o=babelHelpers.objectWithoutProperties(j,["children","className","fullBleed"]);return c("React").createElement("section",babelHelpers["extends"]({className:c("joinClasses")("_3cb2"+(n?" fullBleed":""),l)},o),k)};f.exports=i}),null);
__d("RTCP2PConstants",["keyMirror"],(function a(b,c,d,e,f,g){"use strict";var h=c("keyMirror")({INIT:null,CONTACTING:null,RINGING:null,CONNECTING:null,RECONNECTING:null,CONNECTED:null,DISCONNECTED:null});f.exports={ConnectionStatus:h}}),null);
__d("RTCCallConnectionStatus.react",["cx","fbt","FBRTCCallTimer.react","React","RTCP2PConstants","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("RTCP2PConstants").ConnectionStatus,m=c("React").PureComponent;j=babelHelpers.inherits(n,m);k=j&&j.prototype;n.prototype.render=function(){var o=this.props,p=o.children,q=o.className,r=babelHelpers.objectWithoutProperties(o,["children","className"]);return c("React").createElement("p",babelHelpers["extends"]({className:c("joinClasses")(q,"_46la")},r),p!=null?p:this.$RTCCallConnectionStatus2())};n.prototype.$RTCCallConnectionStatus2=function(){switch(this.props.connectionStatus){case l.CONTACTING:return i._("Contacting...");case l.RINGING:return i._("Ringing...");case l.CONNECTING:return i._("Connecting...");case l.RECONNECTING:return i._("Reconnecting...");case l.CONNECTED:if(!this.$RTCCallConnectionStatus1)this.$RTCCallConnectionStatus1=Math.floor(Date.now()/1e3);return c("React").createElement(c("FBRTCCallTimer.react"),{start:this.$RTCCallConnectionStatus1});case l.DISCONNECTED:return i._("Call ended");default:return null}};function n(){j.apply(this,arguments)}f.exports=n}),null);
__d("RTCCallStateInfo.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=babelHelpers.objectWithoutProperties(j,["children","className"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")("_2_my",l)},m),k)};f.exports=i}),null);
__d("RTCCallControlsButton.react",["cx","AbstractButton.react","React","RTCSVGIcon.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$RTCCallControlsButton1=function(event){var r=this.props,s=r.disabled,t=r.onClick;if(!t)return;else if(s){event.preventDefault();return}t(event)}.bind(this),n}l.prototype.render=function(){var m=this.props,n=m.highlighted,o=m.children,p=m.className,q=m.disabled,r=m.title,s=babelHelpers.objectWithoutProperties(m,["highlighted","children","className","disabled","title"]),t=c("React").createElement(c("RTCSVGIcon.react"),{className:"_4uwr"},o);return c("React").createElement(c("AbstractButton.react"),babelHelpers["extends"]({"aria-disabled":q,className:c("joinClasses")(p,"_4uwq"+(!q&&n?" highlighted":"")),"data-hover":q?"none":"tooltip","data-tooltip-alignh":"center","data-tooltip-content":r,image:t,label:r,labelIsHidden:true},s,{onClick:this.$RTCCallControlsButton1}))};l.defaultProps={highlighted:false,disabled:false};f.exports=l}),null);
__d("RTCCallControlsAddGroupMembersButton.react",["fbt","cx","React","immutable","RTCCallControlsButton.react","RTCGroupCallDialogController"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCCallControlsAddGroupMembersButton1=function(){var s=this.props,t=s.localUser,u=s.participants,v=s.remoteUsers,w=s.thread;c("RTCGroupCallDialogController").showAddGroupMembersDialog(u.filter(function(x){var y=x.fbid;return y!==t.FBID}),c("immutable").Map(v.map(function(x){return[x.FBID,x.participantState]})),w,t.FBID)}.bind(this),o}m.prototype.render=function(){var n;if(this.props.thread)n=h._("Add Group Members");else n=h._("See call participants");return c("React").createElement(c("RTCCallControlsButton.react"),{className:"add semiopaque icon-48",onClick:this.$RTCCallControlsAddGroupMembersButton1,title:n},c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:"M24 12v24M12 24h24",fill:"none"})))};f.exports=m}),null);
__d("RTCGroupCallDraggableComponent.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("React").PureComponent,k=5;h=babelHelpers.inherits(l,j);i=h&&h.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.$RTCGroupCallDraggableComponent2=false,this.$RTCGroupCallDraggableComponent3=0,this.$RTCGroupCallDraggableComponent4=0,this.$RTCGroupCallDraggableComponent5=0,this.$RTCGroupCallDraggableComponent10=function(r){if(r)this.$RTCGroupCallDraggableComponent1=r}.bind(this),this.$RTCGroupCallDraggableComponent8=function(r){if(this.$RTCGroupCallDraggableComponent2){r.stopPropagation();this.$RTCGroupCallDraggableComponent2=false}}.bind(this),this.$RTCGroupCallDraggableComponent9=function(r){var s=r.clientX,t=r.clientY;if(this.$RTCGroupCallDraggableComponent1){this.$RTCGroupCallDraggableComponent3=s;this.$RTCGroupCallDraggableComponent4=t;this.$RTCGroupCallDraggableComponent5=this.$RTCGroupCallDraggableComponent1.scrollLeft+s;document.addEventListener("mousemove",this.$RTCGroupCallDraggableComponent6);document.addEventListener("mouseup",this.$RTCGroupCallDraggableComponent7)}}.bind(this),this.$RTCGroupCallDraggableComponent6=function(r){var s=r.clientX,t=r.clientY;if(this.$RTCGroupCallDraggableComponent1){this.$RTCGroupCallDraggableComponent1.scrollLeft=this.$RTCGroupCallDraggableComponent5-s;if(Math.abs(s-this.$RTCGroupCallDraggableComponent3)>k||Math.abs(t-this.$RTCGroupCallDraggableComponent4)>k)this.$RTCGroupCallDraggableComponent2=true}}.bind(this),this.$RTCGroupCallDraggableComponent7=function(){document.removeEventListener("mousemove",this.$RTCGroupCallDraggableComponent6);document.removeEventListener("mouseup",this.$RTCGroupCallDraggableComponent7)}.bind(this),n}l.prototype.componentWillUnmount=function(){document.removeEventListener("mousemove",this.$RTCGroupCallDraggableComponent6);document.removeEventListener("mouseup",this.$RTCGroupCallDraggableComponent7)};l.prototype.render=function(){return c("React").createElement("div",{className:this.props.className,onClickCapture:this.$RTCGroupCallDraggableComponent8,onMouseDown:this.$RTCGroupCallDraggableComponent9,ref:this.$RTCGroupCallDraggableComponent10},this.props.children)};f.exports=l}),null);
__d("RTCGroupCallRosterUser.react",["cssVar","cx","fbt","AudioContextSingleton","DOM","FBRTCParticipantCallState","MessengerContactImage.react","React","ReactDOM","Tooltip"],(function a(b,c,d,e,f,g,h,i,j){"use strict";var k,l,m=c("React").PureComponent,n="rgba(0, 132, 255, 0.5)",o=48;k=babelHelpers.inherits(p,m);l=k&&k.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=l.constructor).call.apply(q,[this].concat(t)),this.state={audioLevel:0},this.$RTCGroupCallRosterUser1=c("DOM").create("div"),this.$RTCGroupCallRosterUser2=false,this.$RTCGroupCallRosterUser3=0,r}p.prototype.componentDidMount=function(){this.$RTCGroupCallRosterUser4();this.$RTCGroupCallRosterUser5()};p.prototype.componentDidUpdate=function(q){var r=q.user,s=this.props.user.participantState,t=r.participantState;if(!s||!t)return;if(s.state!==t.state)this.$RTCGroupCallRosterUser4();this.$RTCGroupCallRosterUser5()};p.prototype.componentWillUnmount=function(){this.$RTCGroupCallRosterUser6()};p.prototype.render=function(){var q=this.props.user.participantState;if(!q)return null;return c("React").createElement("div",{className:"_2bcu",style:{boxShadow:"0 0 0 "+this.state.audioLevel+"px "+n}},c("React").createElement(c("MessengerContactImage.react"),{ref:"image",className:"_2z_7"+(q.state!==c("FBRTCParticipantCallState").CONNECTED?" _25d9":""),size:o,src:this.props.user.profilePictureUrl}))};p.prototype.$RTCGroupCallRosterUser4=function(){c("ReactDOM").render(c("React").createElement("div",{className:"_25d6"},c("React").createElement("div",{className:"_25d7"},this.props.user.userName),c("React").createElement("div",{className:"_25d8"},this.$RTCGroupCallRosterUser7())),this.$RTCGroupCallRosterUser1);c("Tooltip").set(c("ReactDOM").findDOMNode(this.refs.image),this.$RTCGroupCallRosterUser1,"above","center")};p.prototype.$RTCGroupCallRosterUser5=function(){var q=this.props.user.streams.first();if(!this.$RTCGroupCallRosterUser2&&q&&q.getAudioTracks().length>0){this.$RTCGroupCallRosterUser2=true;var r=c("AudioContextSingleton").get(),s=r.createMediaStreamSource(q),t=r.createAnalyser(),u=new Uint8Array(t.frequencyBinCount);s.connect(t);this.$RTCGroupCallRosterUser8(t,u)}};p.prototype.$RTCGroupCallRosterUser6=function(){this.$RTCGroupCallRosterUser2=false;cancelAnimationFrame(this.$RTCGroupCallRosterUser3)};p.prototype.$RTCGroupCallRosterUser8=function(q,r){this.$RTCGroupCallRosterUser3=requestAnimationFrame(function(){if(this.$RTCGroupCallRosterUser2){q.getByteFrequencyData(r);var s=r.reduce(function(t,u){return t+u});this.setState({audioLevel:Math.floor(s/q.frequencyBinCount/256*40)});this.$RTCGroupCallRosterUser8(q,r)}}.bind(this))};p.prototype.$RTCGroupCallRosterUser7=function(){var q=this.props.user.participantState;if(!q)return null;switch(q.state){case c("FBRTCParticipantCallState").CONTACTING:return j._("Contacting...");case c("FBRTCParticipantCallState").RINGING:return j._("Ringing...");case c("FBRTCParticipantCallState").CONNECTING:return j._("Connecting...");case c("FBRTCParticipantCallState").CONNECTED:return j._("Connected");default:return null}};f.exports=p}),null);
__d("RTCGroupCallRosterRow.react",["cx","FBRTCGroupCallUserPopoverMenu.react","FBRTCParticipantCallState","MessengerContactImage.react","React","RTCGroupCallDraggableComponent.react","RTCGroupCallRosterUser.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=48,j=function j(l){var m=l.localUser,n=l.remoteUsers;return c("React").createElement(c("RTCGroupCallDraggableComponent.react"),{className:"_1a8c"},n.filter(function(o){return k(o.participantState)}).map(function(o){return c("React").createElement(c("FBRTCGroupCallUserPopoverMenu.react"),{key:o.FBID,isMessengerUser:m.isMessengerUser,user:o},c("React").createElement(c("RTCGroupCallRosterUser.react"),{user:o}))}),c("React").createElement(c("MessengerContactImage.react"),{className:"_1a8d",isMessengerUser:m.isMessengerUser,size:i,src:m.profilePictureUrl}))};function k(l){if(l)switch(l.state){case c("FBRTCParticipantCallState").CONTACTING:case c("FBRTCParticipantCallState").RINGING:case c("FBRTCParticipantCallState").CONNECTING:case c("FBRTCParticipantCallState").CONNECTED:return true}return false}f.exports=j}),null);
__d("RTCGroupCallStateInfo.react",["cx","fbt","CurrentUser","FBRTCCallTimer.react","FBRTCConstants","MercuryParticipantsImage.react","MercuryThreadTitle.react","messengerProfileImageWrapperReact","messengerThreadImageReact","React","RTCCallControlsAddGroupMembersButton.react","RTCCallTitle.react","RTCConferenceState","RTCGroupCallRosterRow.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("FBRTCConstants").GroupVideoViewLayout,m=c("messengerProfileImageWrapperReact").jsComponent,n=c("messengerThreadImageReact").jsComponent,o=c("React").PureComponent;j=babelHelpers.inherits(p,o);k=j&&j.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.state={start:0},r}p.prototype.componentWillReceiveProps=function(q){var r=q.conferenceState;if(this.state.start===0&&r===c("RTCConferenceState").CONNECTED)this.setState({start:Math.floor(Date.now()/1e3)})};p.prototype.render=function(){return c("React").createElement("div",{className:"_4j_i"},this.$RTCGroupCallStateInfo1())};p.prototype.$RTCGroupCallStateInfo1=function(){var q=!this.props.isAudioCall&&this.props.conferenceState!==c("RTCConferenceState").TERMINATED;return q?null:c("React").createElement("div",{className:"_4j_i"},this.renderPeerImage(),this.renderMessage(),this.renderSubMessage(),this.renderParticipants())};p.prototype.renderPeerImage=function(){var q=this.props.participants.filter(function(s,t){return!s.is_parties_user}),r=Array.from(this.props.participants.filter(function(s,t){return s.is_parties_user}).map(function(s,t){return s.image_src}).values());return this.props.thread?c("React").createElement(n,{className:"_4j_j",participants:this.props.participants,size:100,thread:this.props.thread,viewer:c("CurrentUser").getID()}):c("React").createElement(m,{className:"_4j_j",size:100,showBadge:false},c("React").createElement(c("MercuryParticipantsImage.react"),{participants:Object.keys(q.toJS()),partiesProfileImages:r,size:100}))};p.prototype.renderMessage=function(){if(this.props.conferenceState===c("RTCConferenceState").AWAITING_USER_START)return this.props.thread?c("React").createElement("p",{className:"_fjp"},i._("Ready to call {name}?",[i.param("name",c("React").createElement(c("MercuryThreadTitle.react"),{thread:this.props.thread,viewer:c("CurrentUser").getID()}))])):c("React").createElement("p",{className:"_fjp"},i._("Ready to call {name}?",[i.param("name",c("React").createElement(c("RTCCallTitle.react"),{participants:this.props.participants,viewer:c("CurrentUser").getID()}))]));return this.props.thread?c("React").createElement("p",{className:"_fjp"},c("React").createElement(c("MercuryThreadTitle.react"),{thread:this.props.thread,viewer:c("CurrentUser").getID()})):c("React").createElement("p",{className:"_fjp"},c("React").createElement(c("RTCCallTitle.react"),{participants:this.props.participants,viewer:c("CurrentUser").getID()}))};p.prototype.renderSubMessage=function(){var q=this.props.callMessage;return c("React").createElement("p",{className:"_fjq"},q||this.$RTCGroupCallStateInfo2(this.props.conferenceState))};p.prototype.$RTCGroupCallStateInfo2=function(q){switch(q){case c("RTCConferenceState").CONNECTING:return i._("Contacting...");case c("RTCConferenceState").CONNECTED:return c("React").createElement(c("FBRTCCallTimer.react"),{start:this.state.start});case c("RTCConferenceState").TERMINATING:return i._("Hanging up...");case c("RTCConferenceState").TERMINATED:return i._("Call ended");default:return null}};p.prototype.renderParticipants=function(){if(this.props.conferenceState!==c("RTCConferenceState").CONNECTING&&this.props.conferenceState!==c("RTCConferenceState").CONNECTED||this.props.layout===l.ONE_TO_ONE)return null;return c("React").createElement("div",{className:"_5-tc"},c("React").createElement(c("RTCCallControlsAddGroupMembersButton.react"),{localUser:this.props.localUser,participants:this.props.participants,remoteUsers:this.props.remoteUsers,thread:this.props.thread}),c("React").createElement(c("RTCGroupCallRosterRow.react"),{localUser:this.props.localUser,remoteUsers:this.props.remoteUsers}))};f.exports=p}),null);
__d("RTCDialog.react",["LayerFadeOnHide","LayerTabIsolation","React","XUIDialog.react"],(function a(b,c,d,e,f,g){"use strict";var h=function h(i){var j=i.children,k=babelHelpers.objectWithoutProperties(i,["children"]);return c("React").createElement(c("XUIDialog.react"),babelHelpers["extends"]({behaviors:{LayerFadeOnHide:c("LayerFadeOnHide"),LayerTabIsolation:c("LayerTabIsolation")},hideOnEscape:true,shown:true},k),j)};f.exports=h}),null);
__d("RTCDialogBody.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=babelHelpers.objectWithoutProperties(j,["children","className"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")(l,"_zbh")},m),k)};f.exports=i}),null);
__d("RTCDialogHeader.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=babelHelpers.objectWithoutProperties(j,["children","className"]);return c("React").createElement("header",babelHelpers["extends"]({className:c("joinClasses")(l,"_7xt")},m),k)};f.exports=i}),null);
__d("RTCDialogHeaderButton.react",["cx","AbstractButton.react","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.className,l=babelHelpers.objectWithoutProperties(j,["className"]);return c("React").createElement(c("AbstractButton.react"),babelHelpers["extends"]({type:"button",className:c("joinClasses")(k,"_4py8"),label:l.label},l))};f.exports=i}),null);
__d("RTCFeedbackView.react",["cx","fbt","React","AbstractTextArea.react","RTCCallActions","RTCDialog.react","RTCDialogBody.react","RTCDialogHeader.react","RTCDialogHeaderButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={feedbackMessage:null},this.$RTCFeedbackView3=function(){if(this.props.rating!=null)c("RTCCallActions").submitRating(this.props.rating);this.props.onDone()}.bind(this),this.$RTCFeedbackView4=function(){if(this.props.rating!=null)c("RTCCallActions").submitRating(this.props.rating);if(this.state.feedbackMessage)c("RTCCallActions").submitFeedback(this.state.feedbackMessage);this.props.onDone()}.bind(this),o}m.prototype.render=function(){return c("React").createElement("section",null,c("React").createElement(c("RTCDialog.react"),{height:447,hideOnEscape:false,layerHideOnBlur:false,width:544},this.$RTCFeedbackView1(),this.$RTCFeedbackView2()))};m.prototype.$RTCFeedbackView1=function(){return c("React").createElement(c("RTCDialogHeader.react"),null,c("React").createElement("h1",{className:"_10mm"},i._("Give Feedback")),c("React").createElement(c("RTCDialogHeaderButton.react"),{label:i._("Not Now"),onClick:this.$RTCFeedbackView3}),c("React").createElement(c("RTCDialogHeaderButton.react"),{label:i._("Submit"),onClick:this.$RTCFeedbackView4}))};m.prototype.$RTCFeedbackView2=function(){return c("React").createElement(c("RTCDialogBody.react"),null,c("React").createElement(c("AbstractTextArea.react"),{className:"_6162",placeholder:i._("Describe the problem..."),value:this.state.feedbackMessage,onChange:function(n){return this.setState({feedbackMessage:n.target.value})}.bind(this)}))};f.exports=m}),null);
__d("RTCStarRatingInput.react",["cx","React","RTCSVGIcon.react","TooltipLink.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={starsShown:null},this.$RTCStarRatingInput2=function(){this.setState({starsShown:null})}.bind(this),o}l.prototype.render=function(){var n=this.props.rating,o=this.state.starsShown,p=o!=null?o:n||0,q=Array.from({length:this.props.count}).map(function(r,s){return c("React").createElement(c("TooltipLink.react"),{alignH:"center",className:"_2r1w",key:s,onMouseEnter:function(){return this.$RTCStarRatingInput1(s+1)}.bind(this),onMouseLeave:this.$RTCStarRatingInput2,onClick:function(){return this.$RTCStarRatingInput3(s+1)}.bind(this),position:"above"},c("React").createElement(m,{selected:s<p}))}.bind(this));return c("React").createElement("div",{className:c("joinClasses")("_2r1x",this.props.className)},q)};l.prototype.$RTCStarRatingInput1=function(n){this.setState({starsShown:n})};l.prototype.$RTCStarRatingInput3=function(n){this.props.onClick(n)};l.defaultProps={count:5};var m=function m(n){var o=n.className,p=n.selected,q=babelHelpers.objectWithoutProperties(n,["className","selected"]);return c("React").createElement(c("RTCSVGIcon.react"),babelHelpers["extends"]({className:"_2r1y"},q),c("React").createElement("svg",{viewBox:"0 0 25 23"},c("React").createElement("path",{d:"M12.1 1 L9.5 9 H1 l6.9 5-2.7 8 6.9-5 6.8 5-2.6-8 6.8-5 h-8.5z",fill:p?"":"none"})))};f.exports=l}),null);
__d("RTCTextButton.react",["cx","AbstractButton.react","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;l.prototype.render=function(){var m=this.props,n=m.className,o=m.label,p=babelHelpers.objectWithoutProperties(m,["className","label"]);return c("React").createElement(c("AbstractButton.react"),babelHelpers["extends"]({className:c("joinClasses")(n,"_5lc4"),label:o},p))};function l(){i.apply(this,arguments)}f.exports=l}),null);
__d("RTCStarRating.react",["cx","fbt","React","RTCCallActions","RTCStarRatingInput.react","RTCTextButton.react","RTCFeedbackView.react","VideoCallWebDriverIDs","dangerouslyBypassDispatchError"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={rating:null,promptFeedback:false},this.$RTCStarRating2=function(s){this.setState({rating:s})}.bind(this),this.$RTCStarRating5=function(){if(this.state.rating!=null){if(this.state.rating===1){this.setState({promptFeedback:true});return}c("RTCCallActions").submitRating(this.state.rating)}this.props.onDone()}.bind(this),o}m.prototype.render=function(){if(this.state.promptFeedback)return c("React").createElement(c("RTCFeedbackView.react"),{onDone:this.props.onDone,rating:this.state.rating});return c("React").createElement("section",{className:"_4a-a","data-testid":c("VideoCallWebDriverIDs").STAR_RATING_VIEW},this.$RTCStarRating1(),c("React").createElement(c("RTCStarRatingInput.react"),{className:"_4a-b",onClick:this.$RTCStarRating2,rating:this.state.rating}),c("React").createElement("p",{className:"_4a-c"},this.$RTCStarRating3()),this.$RTCStarRating4())};m.prototype.$RTCStarRating1=function(){var n=this.props.isAudioCall?i._("Please rate the quality of your audio call"):i._("Please rate the quality of your video call");return c("React").createElement("p",{className:"_4a-d"},n)};m.prototype.$RTCStarRating3=function(){switch(this.state.rating){case 1:return i._("Poor");case 2:return i._("Fair");case 3:return i._("Good");case 4:return i._("Very good");case 5:return i._("Excellent");default:return null}};m.prototype.$RTCStarRating4=function(){var n=this.props,o=n.isAudioCall,p=n.isGroupCall;return this.state.rating===null?c("React").createElement(c("RTCTextButton.react"),{className:"_4a-e hollow"+(!o&&!p?" white":"")+(o||p?" blue":""),label:i._("Not Now"),onClick:this.$RTCStarRating5}):c("React").createElement(c("RTCTextButton.react"),{className:"_4a-e"+(!o&&!p?" white":"")+(o||p?" blue":""),label:i._("Submit"),onClick:this.$RTCStarRating5})};m.prototype.componentDidMount=function(){try{c("RTCCallActions").ratingShown()}catch(n){c("dangerouslyBypassDispatchError")(function(){return c("RTCCallActions").ratingShown()})}};f.exports=m}),null);
__d("RTCThreadInfo.react",["cx","CurrentUser","MercuryParticipantsImage.react","MercuryThreadTitle.react","messengerProfileImageWrapperReact","messengerThreadImageReact","MercuryParticipantsConstants","React","RTCCallTitle.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("messengerProfileImageWrapperReact").jsComponent,j=c("messengerThreadImageReact").jsComponent,k=function k(l){var m=l.participants,n=l.thread;return n?c("React").createElement("div",{className:"_dzr"},c("React").createElement(j,{className:"_dzs",participants:m,size:100,thread:n,viewer:c("CurrentUser").getID()}),c("React").createElement(c("MercuryThreadTitle.react"),{className:"_dzt",thread:n,viewer:c("CurrentUser").getID()})):c("React").createElement("div",{className:"_dzr"},c("React").createElement(i,{className:"_4j_j",size:c("MercuryParticipantsConstants").BIG_IMAGE_SIZE,showBadge:false},c("React").createElement(c("MercuryParticipantsImage.react"),{participants:Object.keys(m.toJS()),size:c("MercuryParticipantsConstants").BIG_IMAGE_SIZE})),c("React").createElement(c("RTCCallTitle.react"),{className:"_dzt",participants:m,viewer:c("CurrentUser").getID()}))};f.exports=k}),null);
__d("RTCMWAppViewContent.react",["fbt","cx","FBRTCConstants","CurrentUser","FBRTCGroupCallIncallView.react","FBRTCParticipantCallState","MessengerRTCGroupCallParticipantsPickerDialogController","React","RTCAppSpinner.react","RTCAppViewMain.react","RTCCallConnectionStatus.react","RTCCallStateInfo.react","RTCCallState","RTCCallStore","RTCConferenceState","RTCGroupCallStateInfo.react","RTCStarRating.react","RTCTextButton.react","RTCThreadInfo.react","RTCUtils","VideoCallWebDriverIDs","FBRTCLogger","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("FBRTCConstants").CallType,m=c("FBRTCConstants").GroupVideoViewLayout,n=c("FBRTCLogger").Trigger,o=c("React").PureComponent;j=babelHelpers.inherits(p,o);k=j&&j.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.state={wasStarRatingDone:false},this.$RTCMWAppViewContent3=function(){this.setState({wasStarRatingDone:true})}.bind(this),r}p.prototype.render=function(){var q,r,s=this.props,t=s.endCallReason,u=s.remoteUsers,v=babelHelpers.objectWithoutProperties(s,["endCallReason","remoteUsers"]),w=c("RTCUtils").isPartiesCall(this.props.conferenceName);switch(this.props.conferenceState){case c("RTCConferenceState").NEW:return c("React").createElement(c("RTCAppViewMain.react"),{fullBleed:false},c("React").createElement(c("RTCCallStateInfo.react"),null,c("React").createElement(c("RTCThreadInfo.react"),{participants:this.props.participants,thread:this.props.thread}),c("React").createElement(c("RTCAppSpinner.react"),null)));case c("RTCConferenceState").AWAITING_USER_START:var x=h._("Join call"),y=(q=this.props)!=null?(q=q.thread)!=null?(q=q.rtc_call_data)!=null?q.server_info_data:q:q:q,z=(r=this.props)!=null?(r=r.thread)!=null?(r=r.rtc_call_data)!=null?r.call_state:r:r:r;if(z&&z===c("RTCCallState").NO_ONGOING_CALL)x=h._("Start Call");return c("React").createElement(c("RTCAppViewMain.react"),{fullBleed:false},c("React").createElement(c("RTCCallStateInfo.react"),null,c("React").createElement(c("RTCThreadInfo.react"),{participants:this.props.participants,thread:this.props.thread}),c("React").createElement(c("RTCCallConnectionStatus.react"),null,h._("Ready to call?")),c("React").createElement(c("RTCTextButton.react"),{className:"green _2fst","data-testid":c("VideoCallWebDriverIDs").RTC_APP_VIEW_START_CALL_BUTTON,label:x,onClick:function(){return this.$RTCMWAppViewContent1(z,y)}.bind(this)})));case c("RTCConferenceState").CONNECTING:case c("RTCConferenceState").CONNECTED:case c("RTCConferenceState").TERMINATING:return c("React").createElement(c("RTCAppViewMain.react"),{fullBleed:true},c("React").createElement(c("FBRTCGroupCallIncallView.react"),babelHelpers["extends"]({remoteUsers:u.filter(function(C){var D=C.participantState;return D&&D.state===c("FBRTCParticipantCallState").CONNECTED})},v)),this.$RTCMWAppViewContent2());case c("RTCConferenceState").TERMINATED:if(this.props.wasConnected&&!w&&!this.state.wasStarRatingDone){var A=c("RTCCallStore").getState().callSummary.getCallType()!==l.DIRECT_VIDEO,B=c("RTCCallStore").getState().callSummary.getCallType()!==l.ESCALATED;return c("React").createElement(c("RTCAppViewMain.react"),{fullBleed:true},c("React").createElement(c("RTCStarRating.react"),{isAudioCall:A&&B,isGroupCall:true,onDone:this.$RTCMWAppViewContent3}))}else return c("React").createElement(c("RTCAppViewMain.react"),{fullBleed:true},this.$RTCMWAppViewContent2(t?t.toString():null));default:return null}};p.prototype.$RTCMWAppViewContent2=function(q){return c("React").createElement(c("RTCGroupCallStateInfo.react"),babelHelpers["extends"]({callMessage:q},this.props))};p.prototype.$RTCMWAppViewContent1=function(q,r){var s=q!==c("RTCCallState").NO_ONGOING_CALL;if(this.props.layout===m.ONE_TO_ONE||s)this.props.onStartCallClick(this.props.remoteUsers.toArray().map(function(t){return t.FBID}),n.MULTIWAY_POPUP_START_CALL_BUTTON);else c("MessengerRTCGroupCallParticipantsPickerDialogController").render({conferenceName:this.props.conferenceName,handleCall:function(t){return this.props.onStartCallClick(t,n.MULTIWAY_POPUP_START_CALL_BUTTON,r)}.bind(this),hasVideo:true,participants:this.props.participants.filter(function(t){var u=t.fbid;return u!==c("CurrentUser").getID()}),thread:this.props.thread,trigger:n.MULTIWAY_POPUP_START_CALL_BUTTON,viewerID:c("CurrentUser").getID()})};f.exports=p}),null);
__d("RTCElementResizeListener.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$RTCElementResizeListener3=function(s){this.$RTCElementResizeListener1=s&&s.getDOMNode?s.getDOMNode():s}.bind(this),this.$RTCElementResizeListener4=function(s){if(s)s.contentWindow.addEventListener("resize",this.$RTCElementResizeListener5,false);else if(this.$RTCElementResizeListener2)this.$RTCElementResizeListener2.contentWindow.removeEventListener("resize",this.$RTCElementResizeListener5,false);this.$RTCElementResizeListener2=s}.bind(this),this.$RTCElementResizeListener5=m(function(s){var t=s.target,u=this.props.onResize;if(u)u({height:t.innerHeight,width:t.innerWidth})}.bind(this),32),o}l.prototype.getDOMNode=function(){return this.$RTCElementResizeListener1};l.prototype.render=function(){var n=this.props,o=n.children,p=n.className,q=n.component,r=n.onResize,s=babelHelpers.objectWithoutProperties(n,["children","className","component","onResize"]);return c("React").createElement(q,babelHelpers["extends"]({className:c("joinClasses")("_3u0-",p),ref:this.$RTCElementResizeListener3},s),o,r?c("React").createElement("iframe",{className:"_3u11",ref:this.$RTCElementResizeListener4}):null)};l.prototype.componentDidMount=function(){if(this.$RTCElementResizeListener2)this.$RTCElementResizeListener5({target:this.$RTCElementResizeListener2.contentWindow})};l.prototype.componentDidUpdate=function(n){var o=this.props.onResize;if(this.$RTCElementResizeListener2&&o&&o!==n.onResize)this.$RTCElementResizeListener5({target:this.$RTCElementResizeListener2.contentWindow})};l.prototype.componentWillUnmount=function(){if(this.$RTCElementResizeListener2)this.$RTCElementResizeListener2.contentWindow.removeEventListener("resize",this.$RTCElementResizeListener5,false);this.$RTCElementResizeListener5.cancel()};l.defaultProps={component:"div"};function m(n,o){var p=0,q=0,r=function r(){for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];var v=Date.now();if(p&&v<p+o){clearTimeout(q);q=setTimeout(function(){p=v;n.apply(undefined,t)},o)}else{p=v;n.apply(undefined,t)}};r.cancel=function(){return clearTimeout(q)};return r}f.exports=l}),null);
__d("RTCAppViewFooter.react",["cx","React","RTCElementResizeListener.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=babelHelpers.objectWithoutProperties(j,["children","className"]);return c("React").createElement(c("RTCElementResizeListener.react"),babelHelpers["extends"]({component:"footer",className:c("joinClasses")("_u0t",l)},m),k)};f.exports=i}),null);
__d("RTCMouseActivityProvider.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("React").Children,k=c("React").PureComponent,l=500;h=babelHelpers.inherits(m,k);i=h&&h.prototype;function m(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=i.constructor).call.apply(o,[this].concat(r)),this.state={active:true},this.$RTCMouseActivityProvider1=0,this.$RTCMouseActivityProvider2=n(function(){clearTimeout(this.$RTCMouseActivityProvider1);this.props.onActive();this.$RTCMouseActivityProvider1=setTimeout(this.props.onIdle,this.props.idleDelay)}.bind(this),l),p}m.prototype.render=function(){return j.only(this.props.children)};m.prototype.componentDidMount=function(){window.addEventListener("mousemove",this.$RTCMouseActivityProvider2);this.$RTCMouseActivityProvider2()};m.prototype.componentWillUnmount=function(){window.removeEventListener("mousemove",this.$RTCMouseActivityProvider2);clearTimeout(this.$RTCMouseActivityProvider1);this.$RTCMouseActivityProvider2.cancel()};m.defaultProps={idleDelay:3e3};function n(o){var p=arguments.length<=1||arguments[1]===undefined?100:arguments[1],q=0,r=0,s=function s(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];var w=Date.now(),x=function x(){q=w;o.apply(undefined,u)};if(q&&w<q+p){clearTimeout(r);r=setTimeout(x,p)}else x()};s.cancel=function(){return clearTimeout(r)};return s}f.exports=m}),null);
__d("RTCCallControls.react",["cx","React","RTCElementResizeListener.react","RTCMouseActivityProvider.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={hasFocus:false,isMouseActive:true},this.$RTCCallControls6=function(r){this.$RTCCallControls1=r&&r.getDOMNode?r.getDOMNode():r}.bind(this),this.$RTCCallControls2=function(){this.setState({isMouseActive:true})}.bind(this),this.$RTCCallControls3=function(){this.setState({isMouseActive:false})}.bind(this),this.$RTCCallControls5=function(){this.setState({hasFocus:true})}.bind(this),this.$RTCCallControls4=function(){this.setState({hasFocus:false})}.bind(this),n}l.prototype.getDOMNode=function(){return this.$RTCCallControls1};l.prototype.render=function(){var m=this.props,n=m.children,o=m.className,p=m.compact,q=babelHelpers.objectWithoutProperties(m,["children","className","compact"]);return c("React").createElement(c("RTCMouseActivityProvider.react"),{onActive:this.$RTCCallControls2,onIdle:this.$RTCCallControls3},c("React").createElement(c("RTCElementResizeListener.react"),babelHelpers["extends"]({component:"section",className:c("joinClasses")("_2eaq"+(p?" compact":"")+(!this.props.autoHide||this.state.isMouseActive||this.state.hasFocus?" visible":""),o),onBlur:this.$RTCCallControls4,onFocus:this.$RTCCallControls5,ref:this.$RTCCallControls6},q),n))};l.defaultProps={autoHide:true,compact:false};f.exports=l}),null);
__d("RTCCallControlsCloseWindowButton.react",["cx","fbt","React","RTCCallControlsButton.react","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;m.prototype.render=function(){var n=this.props,o=n.className,p=babelHelpers.objectWithoutProperties(n,["className"]);return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({className:c("joinClasses")("closeWindow icon-48",o)},p),c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:"M24 25.4l-4.9 4.9c-.4 .4-1 .4-1.4 0c-.4-.4-.4-1 0-1.4L22.6 24 L17.6 19.1c-.4-.4-.4-1 0-1.4c.4-.4 1-.4 1.4 0L24 22.6l4.9-4.9 c.4-.4 1-.4 1.4 0c.4 .4 .4 1 0 1.4L25.4 24l4.9 4.9c.4 .4 .4 1 0 1.4c-.4 .4-1 .4-1.4 0L24 25.4z"})))};function m(){j.apply(this,arguments)}m.defaultProps={onClick:function n(){window.close()},title:i._("Close")};f.exports=m}),null);
__d("RTCCallControlsEndCallButton.react",["cx","fbt","FBRTCHangupReason","React","RTCCallActions","RTCCallControlsButton.react","VideoCallWebDriverIDs","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;m.prototype.render=function(){var n=this.props,o=n.className,p=babelHelpers.objectWithoutProperties(n,["className"]);return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({"data-testid":c("VideoCallWebDriverIDs").END_CALL_BUTTON,className:c("joinClasses")("opaque endCall icon-48",o)},p),c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:"M12.054 24.58C12.52 19.102 24.34 19.002 24.54 19c.202 0 12.024 -.1 12.408 5.37.284 4.048-1.092 3.74-1.56 3.778-.41.033-4.823 -.767-5.452-1.19-.63-.422-.785-2.703-1.293-3.094-.507-.39-3.092 -.51-4.134-.502-1.043.01-3.63.174-4.143.572-.513.4-.702 2.683 -1.337 3.117-.636.434-5.062 1.31-5.47 1.283-.47-.03-1.85.3 -1.506-3.753",fillRule:"evenodd"})))};function m(){j.apply(this,arguments)}m.defaultProps={onClick:function n(){c("RTCCallActions").hangup(c("FBRTCHangupReason").HANGUP_CALL,"")},title:i._("End Call")};f.exports=m}),null);
__d("RTCCallControlsRedialButton.react",["cx","fbt","React","RTCCallActions","RTCCallControlsButton.react","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;m.prototype.render=function(){var n=this.props,o=n.isAudioCall,p=n.className,q=babelHelpers.objectWithoutProperties(n,["isAudioCall","className"]),r=o?"M32.3 33.3c-4.2 3.5-12.6-4.7-12.8-4.9\n        C19.4 28.3 10.9 20 14.5 15.9\n        C17.2 12.8 17.9 14 18.3 14.3c.3 .3 2.9 4 3 4.7\n        C21.5 19.7 20 21.5 20 22.1c.1 .6 1.8 2.5 2.6 3.3c.7 .7 2.7 2.4 3.3 2.5\n        c.6 .1 2.4-1.4 3.1-1.3c.8 .1 4.5 2.7 4.8 3\n        C34.2 29.9 35.4 30.7 32.3 33.3":"M26 17H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h11\n        c1.126 0 2-.938 2-2V19c0-1.062-.874-2-2-2zm10 12h1V19h-1v10z\n        m-6-2.727L35 29V19l-5 2.727v4.546z";return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({className:c("joinClasses")(p,"opaque redial icon-48")},q),c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",babelHelpers["extends"]({fillRule:"evenodd"},{d:r}))))};function m(){j.apply(this,arguments)}m.defaultProps={isAudioCall:false,title:i._("Redial")};f.exports=m}),null);
__d("RTCCallControlsToggleAudioButton.react",["cx","fbt","React","RTCCallActions","RTCCallControlsButton.react","VideoCallWebDriverIDs","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCCallControlsToggleAudioButton1=function(){c("RTCCallActions").toggleMuteAudio(this.props.highlighted)}.bind(this),o}m.prototype.render=function(){var n=this.props,o=n.className,p=n.highlighted,q=n.onClick,r=babelHelpers.objectWithoutProperties(n,["className","highlighted","onClick"]),s=p?i._("Unmute your microphone"):i._("Mute your microphone"),t=p||this.props.disabled?"M25 31c.7-.1 1.3-.3 1.9-.6l-.5-.9c-.6.3-1.2.5-1.9.5-2.5 0-4.5\n        -2.2-4.5-5v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3z\n        m-.5-2c.5 0 1-.1 1.4-.3L21 20.6v4.9c0 1.9 1.6 3.5 3.5 3.5z\n        m-5.8-16l-.9.5L30.3 34l.9-.5L18.7 13zM30 25.2V20h-1v5c0 .8-.2\n        1.6-.5 2.2l.6 1c.6-.8.9-1.9.9-3zm-2 .3v-9c0-1.9-1.6-3.5-3.5\n        -3.5-1.5 0-2.7.9-3.2 2.2L28 26.3v-.8z":"M29 20v5c0 2.7-2 5-4.5 5S20 27.8 20 25v-5h-1v5.2c0 3.1 2.2\n        5.6 5 5.8v3h-3v1h7v-1h-3v-3c2.8-.3 5-2.8 5-5.8V20h-1z\n        m-4.5 9c1.9 0 3.5-1.6 3.5-3.5v-9c0-1.9-1.6-3.5-3.5-3.5\n        S21 14.6 21 16.5v9c0 1.9 1.6 3.5 3.5 3.5z";return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({className:c("joinClasses")(o,"semiopaque icon-48"),"data-testid":c("VideoCallWebDriverIDs").TOGGLE_AUDIO_BUTTON,onClick:q||this.$RTCCallControlsToggleAudioButton1,title:s},{highlighted:p},r),c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",{d:t})))};m.defaultProps={disabled:false,highlighted:false};f.exports=m}),null);
__d("RTCCallControlsToggleVideoButton.react",["cx","fbt","React","RTCCallActions","RTCCallControlsButton.react","VideoCallWebDriverIDs","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCCallControlsToggleVideoButton1=function(){c("RTCCallActions").toggleMuteVideo(this.props.highlighted)}.bind(this),o}m.prototype.render=function(){var n=this.props,o=n.className,p=n.highlighted,q=n.onClick,r=babelHelpers.objectWithoutProperties(n,["className","highlighted","onClick"]),s=p?i._("Enable Your Video"):i._("Disable Your Video"),t=p||this.props.disabled?"M36 29h1V19h-1v10zm-6-2.727L35 29V19l-5 2.727v4.546z\n        M19.344 17H26c1.126 0 2 .938 2 2v10c0 .54-.225 1.047-.595\n        1.415L19.345 17zm-3.5 0H15c-1.126 0-2 .938-2 2v10c0 1.062.874\n        2 2 2h9.257l-8.413-14zm11.408 17.044l.857-.516-12.362-20.572\n        -.857.516 12.362 20.572z":"M26 17H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h11\n        c1.126 0 2-.938 2-2V19c0-1.062-.874-2-2-2zm10 12h1V19h-1v10z\n        m-6-2.727L35 29V19l-5 2.727v4.546z";return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({className:c("joinClasses")(o,"semiopaque icon-48"),"data-testid":c("VideoCallWebDriverIDs").TOGGLE_VIDEO_BUTTON,onClick:q||this.$RTCCallControlsToggleVideoButton1,title:s},{highlighted:p},r),c("React").createElement("svg",{viewBox:"0 0 48 48"},c("React").createElement("path",babelHelpers["extends"]({fillRule:"evenodd"},{d:t}))))};m.defaultProps={disabled:false,highlighted:false};f.exports=m}),null);
__d("RTCGroupCallRemoteViewThumbnail.react",["cx","FBRTCVideo.react","Image.react","React","RTCSVGIcon.react","RTCRemoteViewPopoverMenuButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("React").PureComponent,j=function j(k){var l=k.isDominantSpeaker,m=k.isPinnedSpeaker,n=k.onClick,o=k.user;return c("React").createElement("div",{className:"_30dp"+(l?" dominant":""),onClick:n},c("React").createElement("div",{className:"_30dq"},c("React").createElement(c("RTCRemoteViewPopoverMenuButton.react"),{user:o})),!m?null:c("React").createElement("div",null,c("React").createElement(c("RTCSVGIcon.react"),{className:"_5-vf"},c("React").createElement("svg",{viewBox:"0 0 36 36"},c("React").createElement("path",{d:"M0 0h32a4 4 0 0 1 4 4v32"}))),c("React").createElement(c("RTCSVGIcon.react"),{className:"_5-vg"},c("React").createElement("svg",{viewBox:"0 0 19 19"},c("React").createElement("path",{d:"M2.5 6.65h13a1 1 0 0 1 1 1v9.637a1 1 0 0 1-1 1H3.5a1 1 0 0 1-1-1V7.65a1 1 0 0 1 1-1M9.192 0h.616a4 4 0 0 1 4 4v.313a4 4 0 0 1-.754 2.337H5.946a4 4 0 0 1-.754-2.337V4a4 4 0 0 1 4-4m0 1h.616a3 3 0 0 1 3 3v.313a3 3 0 0 1-1.12 2.337H7.312a3 3 0 0 1-1.12-2.337V4a3 3 0 0 1 3-3",fillRule:"evenodd"})))),l||o.isVideoMuted()?c("React").createElement(c("Image.react"),{src:o.profilePictureUrl}):c("React").createElement(c("FBRTCVideo.react"),{mediaStream:o.streams.first()}))};f.exports=j}),null);
__d("RTCGroupCallRemoteView.react",["cx","FBRTCGroupCallStore","FluxContainer","React","RTCGroupCallActions","RTCGroupCallDraggableComponent.react","RTCGroupCallRemoteViewThumbnail.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(l){var m=l.dominantSpeakerFBID,n=l.pinnedSpeakerFBID,o=l.remoteUsers;return c("React").createElement(c("RTCGroupCallDraggableComponent.react"),{className:"_1qwn"},o.map(function(p){return c("React").createElement(c("RTCGroupCallRemoteViewThumbnail.react"),{isDominantSpeaker:p.FBID===(n||m),isPinnedSpeaker:p.FBID===n,key:p.FBID,onClick:function q(){if(p.FBID===n)c("RTCGroupCallActions").setPinnedSpeaker(null);else c("RTCGroupCallActions").setPinnedSpeaker(p.FBID)},user:p})}))};function j(){return[c("FBRTCGroupCallStore")]}function k(){var l=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],m=arguments[1],n=c("FBRTCGroupCallStore").getState(),o=n.dominantSpeakerFBID,p=n.pinnedSpeakerFBID;return babelHelpers["extends"]({dominantSpeakerFBID:o,pinnedSpeakerFBID:p},m)}f.exports=c("FluxContainer").createFunctional(i,j,k,{withProps:true})}),null);
__d("RTCSelfViewTile.react",["cx","React","RTCElementResizeListener.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$RTCSelfViewTile2=-1,this.$RTCSelfViewTile6=function(r){var s=r.width;this.$RTCSelfViewTile2=s;this.$RTCSelfViewTile7()}.bind(this),this.$RTCSelfViewTile7=function(){var r=this.$RTCSelfViewTile8(),s=this.$RTCSelfViewTile2-r;if(!(this.$RTCSelfViewTile1&&this.$RTCSelfViewTile3&&this.$RTCSelfViewTile4)){cancelAnimationFrame(this.$RTCSelfViewTile5);this.$RTCSelfViewTile5=requestAnimationFrame(this.$RTCSelfViewTile7)}if(this.$RTCSelfViewTile1)this.$RTCSelfViewTile1.style.width=r!==-1?r+"px":"";if(this.$RTCSelfViewTile3)this.$RTCSelfViewTile3.style.width=this.$RTCSelfViewTile2!==-1?""+this.$RTCSelfViewTile2:"";if(this.$RTCSelfViewTile4)this.$RTCSelfViewTile4.style.transform=s?"translateX("+s+"px)":""}.bind(this),n}l.prototype.getDOMNode=function(){return this.$RTCSelfViewTile1};l.prototype.render=function(){var m=this.props,n=m.children,o=m.className,p=m.collapsed,q=m.onClick,r=babelHelpers.objectWithoutProperties(m,["children","className","collapsed","onClick"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")("_drs"+(this.props.focused?" focused":"")+(this.props.hovered?" hovered":""),o),ref:function(s){return this.$RTCSelfViewTile1=s}.bind(this)},r),c("React").createElement("div",{className:"_drt",ref:function(s){return this.$RTCSelfViewTile3=s}.bind(this)},c("React").createElement(c("RTCElementResizeListener.react"),{className:"_dru",onResize:this.$RTCSelfViewTile6,ref:function(s){return this.$RTCSelfViewTile4=s?s.getDOMNode():s}.bind(this)},n)),c("React").createElement("button",babelHelpers["extends"]({className:"_drv"},{onClick:q})))};l.prototype.$RTCSelfViewTile8=function(){if(this.props.collapsed)return this.props.focused||this.props.hovered?30:22;return this.$RTCSelfViewTile2};l.prototype.componentDidMount=function(){this.$RTCSelfViewTile7()};l.prototype.componentDidUpdate=function(){this.$RTCSelfViewTile7()};l.prototype.componentWillUnmount=function(){cancelAnimationFrame(this.$RTCSelfViewTile5)};l.defaultProps={collapsed:false,focused:false,hovered:false};f.exports=l}),null);
__d("RTCSelfViewTileLayer.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=j.renderBackground,n=m===undefined?false:m,o=j.visible,p=o===undefined?true:o,q=babelHelpers.objectWithoutProperties(j,["children","className","renderBackground","visible"]);return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")("_drw"+(p?" _drx":"")+(n?" _dry":""),l)},q),k)};f.exports=i}),null);
__d("RTCSelfViewCameraStream.react",["cx","fbt","FBRTCVideo.react","Image.react","React","RTCSelfViewTile.react","RTCSelfViewTileLayer.react","RTCSVGIcon.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCSelfViewCameraStream2=function(s){this.$RTCSelfViewCameraStream1=s&&s.getDOMNode?s.getDOMNode():s}.bind(this),o}m.prototype.getDOMNode=function(){return this.$RTCSelfViewCameraStream1};m.prototype.render=function(){var n=this.props,o=n.collapsed,p=n.focused,q=n.hovered,r=n.user,s=babelHelpers.objectWithoutProperties(n,["collapsed","focused","hovered","user"]),t=r.isAudioMuted(),u=r.streams.first(),v=r.isVideoMuted();return c("React").createElement(c("RTCSelfViewTile.react"),babelHelpers["extends"]({collapsed:o,focused:p,hovered:q},{ref:this.$RTCSelfViewCameraStream2},s),c("React").createElement(c("FBRTCVideo.react"),babelHelpers["extends"]({className:"_88q mirror"+(r.isVideoMuted()||!u?" muted":"")},{mediaStream:u},{muted:true})),c("React").createElement(c("RTCSelfViewTileLayer.react"),{renderBackground:t||v,visible:v},c("React").createElement(c("Image.react"),{alt:i._("Profile picture"),className:"_drz",src:r.profilePictureUrl})),c("React").createElement(c("RTCSelfViewTileLayer.react"),{renderBackground:!v,visible:t},c("React").createElement(c("RTCSVGIcon.react"),null,c("React").createElement("svg",{className:"_drz",height:48,viewBox:"0 0 48 48",width:48},c("React").createElement("path",{d:"M25 31c.7-.1 1.3-.3 1.9-.6l-.5-.9c-.6.3-1.2.5-1.9.5-2.5 0-4.5 -2.2-4.5-5v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3z m-.5-2c.5 0 1-.1 1.4-.3L21 20.6v4.9c0 1.9 1.6 3.5 3.5 3.5z m-5.8-16l-.9.5L30.3 34l.9-.5L18.7 13zM30 25.2V20h-1v5c0 .8-.2 1.6-.5 2.2l.6 1c.6-.8.9-1.9.9-3zm-2 .3v-9c0-1.9-1.6-3.5-3.5 -3.5-1.5 0-2.7.9-3.2 2.2L28 26.3v-.8z"})))),c("React").createElement(c("RTCSelfViewTileLayer.react"),{renderBackground:p||q},c("React").createElement(c("RTCSVGIcon.react"),null,c("React").createElement("svg",{className:"_drz _dr_",height:28,viewBox:"0 0 8 28",width:8},c("React").createElement("path",{d:o?"M6 2L2 14L6 26":"M2 2L6 14L2 26",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3})))))};f.exports=m}),null);
__d("RTCSelfViewScreenStream.react",["cx","fbt","FBRTCVideo.react","React","RTCSelfViewTile.react","RTCSelfViewTileLayer.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent;j=babelHelpers.inherits(m,l);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCSelfViewScreenStream2=function(s){this.$RTCSelfViewScreenStream1=s&&s.getDOMNode?s.getDOMNode():s}.bind(this),o}m.prototype.getDOMNode=function(){return this.$RTCSelfViewScreenStream1};m.prototype.render=function(){var n=this.props,o=n.focused,p=n.hovered,q=n.user,r=babelHelpers.objectWithoutProperties(n,["focused","hovered","user"]),s=q.screenStreams.first();if(!s){this.$RTCSelfViewScreenStream1=null;return null}return c("React").createElement(c("RTCSelfViewTile.react"),babelHelpers["extends"]({focused:o,hovered:p},{ref:this.$RTCSelfViewScreenStream2},r),c("React").createElement(c("FBRTCVideo.react"),babelHelpers["extends"]({className:"_88q"},{mediaStream:s},{muted:true})),c("React").createElement(c("RTCSelfViewTileLayer.react"),{renderBackground:true,visible:o||p},c("React").createElement("span",{className:"_dr-"},i._("Stop"))))};f.exports=m}),null);
__d("RTCSelfView.react",["cx","React","RTCCallActions","RTCElementResizeListener.react","RTCSelfViewCameraStream.react","RTCSelfViewScreenStream.react","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("React").PureComponent;i=babelHelpers.inherits(l,k);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={cameraViewCollapsed:false,focused:false,hovered:false},this.$RTCSelfView1=-1,this.$RTCSelfView4=0,this.$RTCSelfView5=0,this.$RTCSelfView11=function(r){if(this.props.onResize)this.props.onResize(r);this.$RTCSelfView15()}.bind(this),this.$RTCSelfView13=function(){this.setState({cameraViewCollapsed:!this.state.cameraViewCollapsed})}.bind(this),this.$RTCSelfView14=function(r){var s=r.width;if(this.$RTCSelfView1<=0){this.$RTCSelfView1=s;return}if(this.$RTCSelfView1===s)return;this.$RTCSelfView4=s-this.$RTCSelfView1;this.$RTCSelfView1=s;this.$RTCSelfView15()}.bind(this),this.$RTCSelfView8=function(){this.setState({focused:true})}.bind(this),this.$RTCSelfView7=function(){this.setState({focused:false})}.bind(this),this.$RTCSelfView9=function(){this.setState({hovered:true})}.bind(this),this.$RTCSelfView10=function(){this.setState({hovered:false})}.bind(this),this.$RTCSelfView12=function(){var r=this.props.user;if(!r.hasScreenStream())return;var s=r.screenStreams.first();c("RTCCallActions").removeLocalScreenStream(s);for(var t=s.getVideoTracks(),u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var w;if(u){if(v>=t.length)break;w=t[v++]}else{v=t.next();if(v.done)break;w=v.value}var x=w;x.stop()}}.bind(this),n}l.prototype.render=function(){if(!this.$RTCSelfView6())return null;var m=this.props,n=m.className,o=m.user,p=babelHelpers.objectWithoutProperties(m,["className","user"]),q=this.state,r=q.focused,s=q.hovered;return c("React").createElement(c("RTCElementResizeListener.react"),babelHelpers["extends"]({className:c("joinClasses")("_u2-",n),onBlur:this.$RTCSelfView7,onFocus:this.$RTCSelfView8,onMouseEnter:this.$RTCSelfView9,onMouseLeave:this.$RTCSelfView10,onResize:this.$RTCSelfView11},p),c("React").createElement(c("RTCSelfViewScreenStream.react"),babelHelpers["extends"]({onClick:this.$RTCSelfView12,ref:function(t){return this.$RTCSelfView3=t?t.getDOMNode():t}.bind(this)},{focused:r,hovered:s,user:o})),c("React").createElement(c("RTCSelfViewCameraStream.react"),babelHelpers["extends"]({collapsed:this.state.cameraViewCollapsed,onClick:this.$RTCSelfView13,onResize:o.hasScreenStream()?this.$RTCSelfView14:null,ref:function(t){return this.$RTCSelfView2=t?t.getDOMNode():t}.bind(this)},{focused:r,hovered:s,user:o})))};l.prototype.$RTCSelfView15=function(){var m,n=this;if(this.$RTCSelfView4===0)return;cancelAnimationFrame(this.$RTCSelfView5);if(this.$RTCSelfView3)(function(){var o=n.$RTCSelfView3.style;o.transform="translateX("+n.$RTCSelfView4+"px)";o.transition="none";n.$RTCSelfView5=requestAnimationFrame(function(){if(this.$RTCSelfView3){o.transform="";o.transition="";this.$RTCSelfView4=0}}.bind(n))})()};l.prototype.$RTCSelfView6=function(){return this.props.user.hasVideo()||this.props.user.hasScreenStream()};l.prototype.componentWillUnmount=function(){cancelAnimationFrame(this.$RTCSelfView5)};f.exports=l}),null);
__d("RTCMWAppViewFooter.react",["cx","FBRTCConstants","FBRTCHangupReason","FBRTCParticipantCallState","FBRTCUtils","React","RTCAppViewFooter.react","RTCCallActions","RTCCallControls.react","RTCCallControlsAddGroupMembersButton.react","RTCCallControlsCloseWindowButton.react","RTCCallControlsEndCallButton.react","RTCCallControlsRedialButton.react","RTCCallControlsToggleAudioButton.react","RTCCallControlsToggleVideoButton.react","RTCCallStore","RTCConferenceState","RTCGroupCallRemoteView.react","RTCGroupCallRosterRow.react","RTCMWProtocolHandler","RTCSelfView.react","RTCUtils","FBRTCLogger"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("FBRTCConstants").CallType,l=c("FBRTCConstants").GroupVideoViewLayout,m=c("FBRTCLogger").Trigger,n=c("React").PureComponent;i=babelHelpers.inherits(o,n);j=i&&i.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.$RTCMWAppViewFooter1=0,this.$RTCMWAppViewFooter2=0,this.$RTCMWAppViewFooter3=0,this.$RTCMWAppViewFooter5=0,this.$RTCMWAppViewFooter6=0,this.$RTCMWAppViewFooter10=function(){c("RTCMWProtocolHandler").endCall(this.props.conferenceName,this.props.serverInfoData,c("FBRTCHangupReason").HANGUP_CALL)}.bind(this),this.$RTCMWAppViewFooter12=function(){var u=c("RTCCallStore").getState().callSummary.getCallType();c("RTCCallActions").reset(this.props.conferenceName);c("RTCUtils").initLocalStream(u===k.DIRECT_VIDEO||u===k.ESCALATED).then(function(v){this.props.onRedial();c("RTCCallActions").addLocalStream(v);new(c("RTCMWProtocolHandler"))(c("FBRTCUtils").generateRandomInt()).startCall(this.props.remoteUsers.map(function(w){return w.FBID}).toArray(),[v],this.props.conferenceName,{callTrigger:m.REDIAL_BUTTON})}.bind(this))["catch"](function(v){})}.bind(this),this.$RTCMWAppViewFooter7=function(u){var v=u.width;if(this.$RTCMWAppViewFooter1===v)return;this.$RTCMWAppViewFooter1=v;this.$RTCMWAppViewFooter13()}.bind(this),this.$RTCMWAppViewFooter8=function(u){var v=u.width;if(this.$RTCMWAppViewFooter3===v)return;this.$RTCMWAppViewFooter3=v;this.$RTCMWAppViewFooter13()}.bind(this),this.$RTCMWAppViewFooter11=function(u){var v=u.width;if(this.$RTCMWAppViewFooter2===v)return;this.$RTCMWAppViewFooter2=v;this.$RTCMWAppViewFooter13()}.bind(this),q}o.prototype.render=function(){var p=this.props,q=p.hasVideoInput,r=p.isAudioCall,s=p.layout,t=p.localUser;switch(this.props.conferenceState){case c("RTCConferenceState").CONNECTING:case c("RTCConferenceState").CONNECTED:var u=!t.hasVideo()&&!q;return c("React").createElement(c("RTCAppViewFooter.react"),{onResize:this.$RTCMWAppViewFooter7},c("React").createElement(c("RTCCallControls.react"),{autoHide:!r,className:"_5rdt"+(!r?" video":""),onResize:this.$RTCMWAppViewFooter8,ref:function(w){return this.$RTCMWAppViewFooter4=w?w.getDOMNode():w}.bind(this)},c("React").createElement(c("RTCCallControlsToggleVideoButton.react"),{disabled:u,highlighted:!u&&t.isVideoMuted(),onClick:this.props.localUser.hasVideo()?null:this.$RTCMWAppViewFooter9}),c("React").createElement(c("RTCCallControlsToggleAudioButton.react"),{highlighted:t.isAudioMuted()}),c("React").createElement(c("RTCCallControlsEndCallButton.react"),{onClick:this.$RTCMWAppViewFooter10})),r||s===l.ONE_TO_ONE?null:c("React").createElement(c("RTCCallControlsAddGroupMembersButton.react"),{localUser:t,participants:this.props.participants,remoteUsers:this.props.remoteUsers,thread:this.props.thread}),r||s!==l.STRIP?null:c("React").createElement(c("RTCGroupCallRosterRow.react"),{localUser:t,remoteUsers:this.props.remoteUsers}),r||s!==l.DOMINANT_SPEAKER?null:c("React").createElement(c("RTCGroupCallRemoteView.react"),{remoteUsers:this.props.remoteUsers.filter(function(w){var x=w.participantState;return x&&x.state===c("FBRTCParticipantCallState").CONNECTED})}),c("React").createElement(c("RTCSelfView.react"),{className:"_3kqh"+(!r?" video":""),onResize:this.$RTCMWAppViewFooter11,user:t}));case c("RTCConferenceState").TERMINATING:return c("React").createElement(c("RTCAppViewFooter.react"),{onResize:this.$RTCMWAppViewFooter7},c("React").createElement(c("RTCCallControls.react"),{autoHide:false,className:"_5rdt",onResize:this.$RTCMWAppViewFooter8,ref:function(w){return this.$RTCMWAppViewFooter4=w?w.getDOMNode():w}.bind(this)},c("React").createElement(c("RTCCallControlsToggleVideoButton.react"),{disabled:true,highlighted:true}),c("React").createElement(c("RTCCallControlsToggleAudioButton.react"),{disabled:true,highlighted:true}),c("React").createElement(c("RTCCallControlsEndCallButton.react"),{disabled:true})));case c("RTCConferenceState").TERMINATED:var v=c("RTCCallStore").getState().callSummary.getCallType();return c("React").createElement(c("RTCAppViewFooter.react"),{onResize:this.$RTCMWAppViewFooter7},c("React").createElement(c("RTCCallControls.react"),{autoHide:false,className:"_5rdt",onResize:this.$RTCMWAppViewFooter8,ref:function(w){return this.$RTCMWAppViewFooter4=w?w.getDOMNode():w}.bind(this)},c("React").createElement(c("RTCCallControlsCloseWindowButton.react"),null),s===l.ONE_TO_ONE?c("React").createElement(c("RTCCallControlsRedialButton.react"),{isAudioCall:v!==k.DIRECT_VIDEO&&v!==k.ESCALATED,onClick:this.$RTCMWAppViewFooter12}):null));default:return c("React").createElement(c("RTCAppViewFooter.react"),null)}};o.prototype.$RTCMWAppViewFooter9=function(){c("RTCMWProtocolHandler").videoEscalation()};o.prototype.$RTCMWAppViewFooter13=function(){var p,q=this;if(this.$RTCMWAppViewFooter1===0||this.$RTCMWAppViewFooter3===0)return;var r=Math.min(0,this.$RTCMWAppViewFooter1/2-(this.$RTCMWAppViewFooter3/2+this.$RTCMWAppViewFooter2));if(r===this.$RTCMWAppViewFooter5)return;this.$RTCMWAppViewFooter5=r;if(this.$RTCMWAppViewFooter4)(function(){var s=q.$RTCMWAppViewFooter4.style;s.transition="none";q.$RTCMWAppViewFooter6=requestAnimationFrame(function(){s.transform="translateX("+this.$RTCMWAppViewFooter5+"px)";s.transition=""}.bind(q))})()};o.prototype.componentWillUnmount=function(){cancelAnimationFrame(this.$RTCMWAppViewFooter6)};f.exports=o}),null);
__d("RTCLogo.react",["cx","ix","Image.react","React","WorkModeConfig","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";var j={messenger:{color:i("28187"),mono:i("28188")},workplace:{color:i("28198"),mono:i("28199")}},k=function k(m){var n=m.className,o=m.mode,p=o===undefined?"color":o,q=babelHelpers.objectWithoutProperties(m,["className","mode"]),r=l();return c("React").createElement(c("Image.react"),babelHelpers["extends"]({alt:"",className:c("joinClasses")(n,"_4ytt"),src:j[r][p]},q))};function l(){return c("WorkModeConfig").is_work_user?"workplace":"messenger"}f.exports=k}),null);
__d("RTCAppViewHeader.react",["cx","React","RTCLogo.react","RTCUtils","VideoCallWebDriverIDs","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(j){var k=j.children,l=j.className,m=j.conferenceName,n=j.isAudioCall,o=babelHelpers.objectWithoutProperties(j,["children","className","conferenceName","isAudioCall"]),p=m?c("RTCUtils").isPartiesCall(m):false,q=p?null:c("React").createElement(c("RTCLogo.react"),{className:"_4key",mode:n?"color":"mono","data-testid":c("VideoCallWebDriverIDs").RTC_APP_VIEW_LOGO});return c("React").createElement("header",babelHelpers["extends"]({className:c("joinClasses")("_4keu",l)},o),q,k)};f.exports=i}),null);
__d("RTCSVGIconDropShadowFilter.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("React").PureComponent,k=0;h=babelHelpers.inherits(l,j);i=h&&h.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.$RTCSVGIconDropShadowFilter1="filter:blur."+k+++"."+Date.now().toString(24),n}l.prototype.render=function(){var m=this.props,n=m.blur,o=m.x,p=m.y,q=Math.ceil(n*3*Math.sqrt(2*Math.PI)/8);return c("React").createElement("filter",{id:this.getID(),height:this.props.height+q*2,width:this.props.width+q*2,x:o-q,y:p-q},c("React").createElement("feGaussianBlur",{"in":"SourceAlpha",result:"blur",stdDeviation:n}),c("React").createElement("feOffset",{dx:o,dy:p,"in":"blur",result:"offsetBlur"}),c("React").createElement("feFlood",{floodColor:this.props.color,floodOpacity:this.props.opacity}),c("React").createElement("feComposite",{in2:"offsetBlur",operator:"in",result:"shadow"}),c("React").createElement("feMorphology",{operator:"dilate",radius:"1","in":"SourceAlpha",result:"outline"}),c("React").createElement("feFlood",{floodColor:"#000",floodOpacity:.1}),c("React").createElement("feComposite",{in2:"outline",operator:"in",result:"stroke"}),c("React").createElement("feMerge",null,c("React").createElement("feMergeNode",{"in":"shadow"}),c("React").createElement("feMergeNode",{"in":"stroke"}),c("React").createElement("feMergeNode",{"in":"SourceGraphic"})))};l.prototype.getID=function(){return this.props.id||this.$RTCSVGIconDropShadowFilter1};l.prototype.getURL=function(){return"url(#"+this.getID()+")"};l.defaultProps={blur:2,color:"#000",opacity:.2,x:0,y:1};f.exports=l}),null);
__d("RTCCallControlsDominantSpeakerSwitchButton.react",["cx","fbt","FBRTCConstants","React","RTCCallControlsButton.react","RTCGroupCallActions","RTCSVGIconDropShadowFilter.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("FBRTCConstants").GroupVideoViewLayout,m=c("React").PureComponent;j=babelHelpers.inherits(n,m);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$RTCCallControlsDominantSpeakerSwitchButton3=function(t){if(t){this.$RTCCallControlsDominantSpeakerSwitchButton1=t.getURL();this.forceUpdate()}}.bind(this),p}n.prototype.render=function(){return c("React").createElement(c("RTCCallControlsButton.react"),{className:"transparent icon-50",onClick:this.$RTCCallControlsDominantSpeakerSwitchButton2,title:i._("Switch to dominant speaker view")},c("React").createElement("svg",{viewBox:"-11 -12 50 50"},c("React").createElement("defs",null,c("React").createElement(c("RTCSVGIconDropShadowFilter.react"),{ref:this.$RTCCallControlsDominantSpeakerSwitchButton3,height:20,width:20})),c("React").createElement("g",{filter:this.$RTCCallControlsDominantSpeakerSwitchButton1},c("React").createElement("path",{d:"M5.5 2.5h17a2 2 30 0 1 2 2v17a-2 2 30 0 1-2 2h-17a-2-2 30 0 1-2-2v-17a2-2 30 0 1 2-2zm0 2h17v11h-17zm0 13h4v4h-4zm6.5 0h4v4h-4zm6.5 0h4v4h-4z",fillRule:"evenodd"}))))};n.prototype.$RTCCallControlsDominantSpeakerSwitchButton2=function(){c("RTCGroupCallActions").setLayout(l.DOMINANT_SPEAKER)};f.exports=n}),null);
__d("RTCCallControlsGridSwitchButton.react",["cx","fbt","FBRTCConstants","React","RTCCallControlsButton.react","RTCGroupCallActions","RTCSVGIconDropShadowFilter.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("FBRTCConstants").GroupVideoViewLayout,m=c("React").PureComponent;j=babelHelpers.inherits(n,m);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$RTCCallControlsGridSwitchButton3=function(t){if(t){this.$RTCCallControlsGridSwitchButton1=t.getURL();this.forceUpdate()}}.bind(this),p}n.prototype.render=function(){return c("React").createElement(c("RTCCallControlsButton.react"),{className:"transparent icon-50",onClick:this.$RTCCallControlsGridSwitchButton2,title:i._("Switch to grid view")},c("React").createElement("svg",{viewBox:"-11 -12 50 50"},c("React").createElement("defs",null,c("React").createElement(c("RTCSVGIconDropShadowFilter.react"),{ref:this.$RTCCallControlsGridSwitchButton3,height:20,width:20})),c("React").createElement("g",{filter:this.$RTCCallControlsGridSwitchButton1},c("React").createElement("path",{d:"M5.5 2.5h17a2 2 30 0 1 2 2v17a-2 2 30 0 1-2 2h-17a-2-2 30 0 1-2-2v-17a2-2 30 0 1 2-2zm0 2H13V12H5.5zm9.5 0h7.5V12H15zM5.5 14H13v7.5H5.5zm9.5 0h7.5v7.5H15z",fillRule:"evenodd"}))))};n.prototype.$RTCCallControlsGridSwitchButton2=function(){c("RTCGroupCallActions").setLayout(l.GRID)};f.exports=n}),null);
__d("RTCCallControlsStripSwitchButton.react",["cx","fbt","FBRTCConstants","React","RTCCallControlsButton.react","RTCGroupCallActions","RTCSVGIconDropShadowFilter.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("FBRTCConstants").GroupVideoViewLayout;j=babelHelpers.inherits(m,c("React").PureComponent);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$RTCCallControlsStripSwitchButton3=function(s){if(s){this.$RTCCallControlsStripSwitchButton1=s.getURL();this.forceUpdate()}}.bind(this),o}m.prototype.render=function(){return c("React").createElement(c("RTCCallControlsButton.react"),{className:"transparent icon-50",onClick:this.$RTCCallControlsStripSwitchButton2,title:i._("Switch to strip view")},c("React").createElement("svg",{viewBox:"-11 -12 50 50"},c("React").createElement("defs",null,c("React").createElement(c("RTCSVGIconDropShadowFilter.react"),{height:20,ref:this.$RTCCallControlsStripSwitchButton3,width:20})),c("React").createElement("g",{filter:this.$RTCCallControlsStripSwitchButton1},c("React").createElement("path",{d:"M5.5 2.5h17a2 2 30 0 1 2 2v17a-2 2 30 0 1-2 2h-17a-2-2 30 0 1-2-2v-17a2-2 30 0 1 2-2zm0 2h4v17h-4zm6.5 0h4v17h-4zm6.5 0h4v17h-4z",fillRule:"evenodd"}))))};m.prototype.$RTCCallControlsStripSwitchButton2=function(){c("RTCGroupCallActions").setLayout(l.STRIP)};f.exports=m}),null);
__d("RTCCallControlsToggleFullScreenButton.react",["cx","fbt","React","RTCCallControlsButton.react","RTCSVGIconDropShadowFilter.react","RTCUtils","VideoCallWebDriverIDs","joinClasses","debounce"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent,m=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"];j=babelHelpers.inherits(n,l);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={highlighted:false},this.$RTCCallControlsToggleFullScreenButton3=function(t){var u=this.props.onClick;this.setState({highlighted:true});this.$RTCCallControlsToggleFullScreenButton1=setTimeout(function(){return this.setState({highlighted:false})}.bind(this),100);if(u){u(t);return}c("RTCUtils").toggleFullScreen()}.bind(this),this.$RTCCallControlsToggleFullScreenButton4=function(t){if(t){this.$RTCCallControlsToggleFullScreenButton2=t.getURL();this.forceUpdate()}}.bind(this),this.$RTCCallControlsToggleFullScreenButton7=c("debounce")(function(){return this.forceUpdate()}.bind(this),10),p}n.prototype.render=function(){var o=this.props,p=o.className,q=babelHelpers.objectWithoutProperties(o,["className"]),r=c("RTCUtils").isFullScreen()||this.state.highlighted,s=r?i._("Exit Full Screen"):i._("Enter Full Screen");return c("React").createElement(c("RTCCallControlsButton.react"),babelHelpers["extends"]({className:c("joinClasses")(p,"transparent icon-50"),"data-testid":c("VideoCallWebDriverIDs").FULL_SCREEN_BUTTON,title:s},{highlighted:r},q,{onClick:this.$RTCCallControlsToggleFullScreenButton3}),c("React").createElement("svg",{viewBox:"0 0 50 50"},c("React").createElement("defs",null,c("React").createElement(c("RTCSVGIconDropShadowFilter.react"),{ref:this.$RTCCallControlsToggleFullScreenButton4,height:20,width:20})),c("React").createElement("g",{filter:this.$RTCCallControlsToggleFullScreenButton2},this.$RTCCallControlsToggleFullScreenButton5(r),this.$RTCCallControlsToggleFullScreenButton6(r))))};n.prototype.$RTCCallControlsToggleFullScreenButton5=function(o){return c("React").createElement("path",{className:(o?"showIfHighlighted":"")+(!o?" hideIfHighlighted":""),d:"M33.7 16.3c-.2-.2-.4-.3-.7-.3h-6c-.5 0-1 .4-1 1s.4 1 1 1h3.6 l-4.8 4.8c-.4.4-.4 1 0 1.4s1 .4 1.4 0l4.8-4.8V23c0 .5.4 1 1 1 s1-.4 1-1v-6c0-.3-.1-.5-.3-.7zM16.3 33.7c-.2-.2-.3-.4-.3-.7v-6 c0-.5.4-1 1-1s1 .4 1 1v3.6l4.8-4.8c.4-.4 1-.4 1.4 0s.4 1 0 1.4 L19.5 32h3.6c.5 0 1 .4 1 1s-.4 1-1 1h-6c-.3 0-.6-.1-.8-.3z"})};n.prototype.$RTCCallControlsToggleFullScreenButton6=function(o){return c("React").createElement("path",{className:(!o?"showIfHighlighted":"")+(o?" hideIfHighlighted":""),d:"M25.8 24.2c.2.2.4.3.7.3h6c.5 0 1-.4 1-1s-.4-1-1-1h-3.6l4.8-4.8 c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0l-4.8 4.8v-3.6c0-.5-.4-1-1-1 s-1 .4-1 1v6c0 .3.1.5.3.7zM24.2 25.8c.2.2.3.5.3.8v6c0 .6-.4 1-1 1 s-1-.5-1-1V29l-4.8 4.7c-.4.4-1 .4-1.4 0s-.4-1 0-1.4l4.8-4.8h-3.6 c-.6 0-1-.4-1-1s.5-1 1-1h6c.3 0 .5.1.7.3z"})};n.prototype.componentDidMount=function(){for(var o=m,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var event=r;document.addEventListener(event,this.$RTCCallControlsToggleFullScreenButton7)}};n.prototype.componentWillUnmount=function(){clearTimeout(this.$RTCCallControlsToggleFullScreenButton1);for(var o=m,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var event=r;document.removeEventListener(event,this.$RTCCallControlsToggleFullScreenButton7)}};f.exports=n}),null);
__d("RTCMWAppViewHeader.react",["FBRTCGroupCallStore","FBRTCConstants","React","RTCAppViewHeader.react","RTCCallControls.react","RTCCallControlsDominantSpeakerSwitchButton.react","RTCCallControlsGridSwitchButton.react","RTCCallControlsStripSwitchButton.react","RTCCallControlsToggleFullScreenButton.react","RTCConferenceState"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCConstants").GroupVideoViewLayout,i=function i(j){var k=j.conferenceName,l=j.conferenceState,m=j.hideLayoutSwitchButton,n=j.isAudioCall,o=j.layout,p=c("FBRTCGroupCallStore").getState(),q=p.useDominantSpeakeView,r=p.useGridView,s=p.useStripView;switch(l){case c("RTCConferenceState").CONNECTED:return c("React").createElement(c("RTCAppViewHeader.react"),{conferenceName:k,isAudioCall:n},c("React").createElement(c("RTCCallControls.react"),{autoHide:!n,compact:true},!n&&!m&&q&&o!==h.DOMINANT_SPEAKER?c("React").createElement(c("RTCCallControlsDominantSpeakerSwitchButton.react"),null):null,!n&&!m&&r&&o!==h.GRID?c("React").createElement(c("RTCCallControlsGridSwitchButton.react"),null):null,!n&&!m&&s&&o!==h.STRIP?c("React").createElement(c("RTCCallControlsStripSwitchButton.react"),null):null,c("React").createElement(c("RTCCallControlsToggleFullScreenButton.react"),null)));default:return c("React").createElement(c("RTCAppViewHeader.react"),{conferenceName:k,isAudioCall:n},c("React").createElement(c("RTCCallControls.react"),{autoHide:!n,compact:true},c("React").createElement(c("RTCCallControlsToggleFullScreenButton.react"),null)))}};f.exports=i}),null);
__d("RTCUserMediaRequest",["immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("immutable").Record({error:null,state:null});h=babelHelpers.inherits(k,j);i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("RTCGroupCallView.react",["cx","Promise","FBRTCGroupCallStore","FBRTCParticipantCallState","FBRTCConstants","React","RTCAppView.react","RTCConferenceState","RTCGrantUserMediaAccessView.react","RTCMWAppViewContent.react","RTCMWAppViewFooter.react","RTCMWAppViewHeader.react","RTCUserMediaRequest","RTCUserMediaRequestState"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=c("FBRTCConstants").GroupVideoViewLayout,l=c("React").PureComponent,m=8;i=babelHelpers.inherits(n,l);j=i&&i.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={hasVideoInput:false,wasConnected:false},this.$RTCGroupCallView2=function(){this.setState({wasConnected:false})}.bind(this),p}n.prototype.render=function(){var o=this.props.userMediaRequest;switch(o.state){case c("RTCUserMediaRequestState").PENDING:case c("RTCUserMediaRequestState").REJECTED:return c("React").createElement(c("RTCGrantUserMediaAccessView.react"),{isAudioCall:this.props.isAudioCall,userMediaRequest:o});default:return this.$RTCGroupCallView1()}};n.prototype.$RTCGroupCallView1=function(){var o=this.props,p=o.layout,q=o.remoteUsers,r=babelHelpers.objectWithoutProperties(o,["layout","remoteUsers"]);q=q.toList().sort(function(u,v){return u.lastConnectedAt===v.lastConnectedAt?u.FBID>v.FBID?1:u.FBID<v.FBID?-1:0:u.lastConnectedAt-v.lastConnectedAt});var s=q.count(function(u){var v=u.participantState;return v&&v.state===c("FBRTCParticipantCallState").CONNECTED});if(this.props.conferenceState===c("RTCConferenceState").CONNECTED)this.setState({wasConnected:true});var t=c("FBRTCGroupCallStore").getState().useDominantSpeakeView&&s>m;p=t?k.DOMINANT_SPEAKER:p;return c("React").createElement("div",{className:"_38jq _li"+(this.props.conferenceState===c("RTCConferenceState").TERMINATED?" _17cj":"")},c("React").createElement(c("RTCAppView.react"),{isAudioCall:this.props.isAudioCall},c("React").createElement(c("RTCMWAppViewHeader.react"),babelHelpers["extends"]({conferenceName:this.props.conferenceName,hideLayoutSwitchButton:t,layout:p},r)),c("React").createElement(c("RTCMWAppViewContent.react"),babelHelpers["extends"]({layout:p,remoteUsers:q,wasConnected:this.state.wasConnected},r)),c("React").createElement(c("RTCMWAppViewFooter.react"),babelHelpers["extends"]({hasVideoInput:this.state.hasVideoInput,layout:p,onRedial:this.$RTCGroupCallView2,remoteUsers:q},r))))};n.prototype.componentDidMount=function(){new(c("Promise"))(function(o){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)o(navigator.mediaDevices.enumerateDevices().then(function(p){return p.some(function(q){var r=q.kind;return r==="videoinput"})}));else o(true)}).then(function(o){return this.setState({hasVideoInput:o})}.bind(this))["catch"](function(o){})};f.exports=n}),null);
__d("RTCMWThreadDeltaHandler",["Arbiter","CurrentUser","ChannelConstants","MercurySyncDeltaTypes","RTCGroupCallActions","MercuryIDs","MercuryParticipants","idx"],(function a(b,c,d,e,f,g){"use strict";var h={initHandler:function i(j){c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("delta"),function(k,l){var m,n,o=l&&l.obj&&l.obj.queue;if(o&&o.toString()!==c("CurrentUser").getID())return;var p=(m=l)!=null?(m=m.obj)!=null?m.delta:m:m,q=(n=p)!=null?(n=n.messageMetadata)!=null?(n=n.threadKey)!=null?n.threadFbId:n:n:n;if(!p||q!==j)return;switch(p["class"]){case c("MercurySyncDeltaTypes").ParticipantLeftGroupThread:c("RTCGroupCallActions").onParticipantLeft(p.leftParticipantFbId);break;case c("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:c("MercuryParticipants").getMulti(p.addedParticipants.map(function(r){var s=r.userFbId;return c("MercuryIDs").getParticipantIDFromUserID(s)}),c("RTCGroupCallActions").onParticipantsAdded);break}})}};f.exports=h}),null);
__d("RTCGroupCallContainer.react",["cx","fbt","invariant","PageHooks","CSS","CurrentUser","FBRTCGroupCallStore","FBRTCHangupReason","FluxContainer","immutable","MercuryIDs","MercuryParticipants","MercuryThreads","MessengerBugNub.react","MessengerRTCFunnelLogger","React","RTCCallActions","RTCCallStore","RTCConferenceState","FBRTCConstants","RTCGroupCallActions","RTCGroupCallDispatcher","RTCGroupCallView.react","RTCMWProtocolHandler","RTCMWThreadDeltaHandler","RTCUser","RTCUserMediaRequest","RTCUserMediaRequestState","RTCUtils","Run","URI","guid"],(function a(b,c,d,e,f,g,h,i,j){"use strict";var k,l;c("PageHooks");var m=c("MercuryThreads").get(),n=c("FBRTCConstants").ChildWindowMessageType,o=c("FBRTCConstants").GroupVideoViewLayout,p=c("React").PureComponent;k=babelHelpers.inherits(q,p);l=k&&k.prototype;q.getStores=function(){return[c("RTCCallStore"),c("FBRTCGroupCallStore")]};q.calculateState=function(){var r=c("RTCCallStore").getState(),s=r.callInfo,t=r.localUser,u=r.remoteUsers,v=c("FBRTCGroupCallStore").getState(),w=v.endCallReason,x=v.layout,y=v.participants,z=v.thread;return{conferenceState:s.conferenceState,endCallReason:w,layout:x,localUser:t,participants:y,remoteUsers:u,thread:z}};function q(r){var s,t=this,u;l.constructor.call(this,r);this.state=babelHelpers["extends"]({},q.calculateState(),{userMediaRequest:new(c("RTCUserMediaRequest"))()});this.$RTCGroupCallContainer1=0;this.$RTCGroupCallContainer7=function(y,z,A){c("MessengerRTCFunnelLogger").appendAction("click_start_call_button");this.$RTCGroupCallContainer5(y,z,A)}.bind(this);c("RTCGroupCallDispatcher").explicitlyRegisterStores([c("RTCCallStore"),c("FBRTCGroupCallStore")]);this.$RTCGroupCallContainer2=new(c("RTCMWProtocolHandler"))(this.props.callID);if(this.props.nonce)c("MessengerRTCFunnelLogger").setWindowNonce(this.props.nonce);var v=c("RTCUtils").isGroupCall(this.props.conferenceName),w=c("RTCUtils").isMessengerCall(this.props.conferenceName),x=c("RTCUtils").isPartiesCall(this.props.conferenceName);if(v||w||x)c("RTCGroupCallActions").setLayout(this.props.useStripView?o.STRIP:this.props.useGridView?o.GRID:this.props.useDominantSpeakeView?o.DOMINANT_SPEAKER:o.STRIP);else c("RTCGroupCallActions").setLayout(o.ONE_TO_ONE);c("RTCGroupCallActions").setUseDominantSpeakeView(this.props.useDominantSpeakeView);c("RTCGroupCallActions").setUseGridView(this.props.useGridView);c("RTCGroupCallActions").setUseStripView(this.props.useStripView);if(w||x)(function(){var y=c("MercuryIDs").getParticipantIDFromUserID(c("CurrentUser").getID());c("MercuryParticipants").get(y,function(z){var A={};A[y]=z;var B=c("immutable").Map(A);c("RTCGroupCallActions").initThread(null,B);this.initializeParticipantsAndStartCall(B,false)}.bind(t))})();else(function(){var y=v?t.props.conferenceName.split(":")[1]:c("RTCUtils").getPeerID(t.props.conferenceName),z=v?c("MercuryIDs").getThreadIDFromThreadFBID(y):c("MercuryIDs").getThreadIDFromUserID(y);m.getThreadMeta(z,function(A){c("MercuryParticipants").getMulti(A.participants,function(B){var C=c("immutable").Map(B);c("RTCGroupCallActions").initThread(A,C);c("RTCMWThreadDeltaHandler").initHandler(y);this.initializeParticipantsAndStartCall(C,true)}.bind(this))}.bind(t))})()}q.prototype.initializeParticipantsAndStartCall=function(r,s){var t=r.keySeq().toArray();c("MercuryParticipants").getBigImageMulti(t,function(u){if(s)c("RTCCallActions").initRemoteUsers(r.filter(function(w){var x=w.fbid;return x!==c("CurrentUser").getID()}).map(function(w){return this.$RTCGroupCallContainer3(w,u)}.bind(this)).toSet());var v=c("MercuryIDs").getParticipantIDFromUserID(c("CurrentUser").getID());c("RTCCallActions").initLocalUser(this.$RTCGroupCallContainer3(r.get(v),u));this.$RTCGroupCallContainer4()}.bind(this),100)};q.prototype.$RTCGroupCallContainer3=function(r,s){var t=r.big_image_src,u=r.fbid,v=r.href,w=r.image_src,x=r.is_messenger_user,y=r.name,z=r.short_name;u||j(0);if(s){var A=c("MercuryIDs").getParticipantIDFromUserID(u);t=s[A]}return new(c("RTCUser"))({FBID:u,profileUrl:new(c("URI"))(v),profilePictureUrl:t||w,isMessengerUser:!!x,userName:y,userShortName:z})};q.prototype.$RTCGroupCallContainer4=function(){var r=c("guid")(),s=function(event){if(event.origin!==window.location.origin||!event.data||event.data.nonce!==r)return;if(event.data.type===n.CHILD_WINDOW_START_CALL){window.removeEventListener("message",s);this.$RTCGroupCallContainer5(this.props.usersToRing)}}.bind(this);window.addEventListener("message",s);if(window.opener&&window.opener.postMessage)window.opener.postMessage({type:n.CHILD_WINDOW_READY,nonce:this.props.nonce,childNonce:r,peerID:"2012185469013708"},window.location.origin);setTimeout(function(){return c("RTCCallActions").waitForUserInput()},1500)};q.prototype.$RTCGroupCallContainer5=function(r,s,t){this.$RTCGroupCallContainer1=setTimeout(function(){this.setState(function(u){var v=u.userMediaRequest;return{userMediaRequest:v.set("state",v.state||c("RTCUserMediaRequestState").PENDING)}})}.bind(this),200);c("MessengerRTCFunnelLogger").appendAction("user_media_requested");c("RTCUtils").initLocalStream(this.props.hasVideo).then(function(u){clearTimeout(this.$RTCGroupCallContainer1);this.setState(function(v){var w=v.userMediaRequest;return{userMediaRequest:w.set("state",c("RTCUserMediaRequestState").FULFILLED)}});c("MessengerRTCFunnelLogger").appendAction("user_media_succeeded");this.$RTCGroupCallContainer6(u,r,s,t)}.bind(this))["catch"](function(u){this.setState(function(v){var w=v.userMediaRequest;return{userMediaRequest:w.set("error",u).set("state",c("RTCUserMediaRequestState").REJECTED)}});c("MessengerRTCFunnelLogger").appendAction("user_media_rejected")}.bind(this))};q.prototype.componentDidMount=function(){if(document.documentElement)c("CSS").addClass(document.documentElement,"_2ujx");c("MessengerRTCFunnelLogger").appendAction("call_popup_mounted");c("Run").onBeforeUnload(function(){var r=c("RTCCallStore").getState().callInfo.conferenceState;switch(r){case c("RTCConferenceState").CONNECTING:case c("RTCConferenceState").CONNECTED:case c("RTCConferenceState").TERMINATING:return i._("Leaving this page will end your call.")}return null},false);c("Run").onUnload(function(){c("MessengerRTCFunnelLogger").endFunnel("call_page_unloaded");var r=c("RTCCallStore").getState().callInfo.conferenceState;if(r===c("RTCConferenceState").TERMINATED)return;c("RTCMWProtocolHandler").endCall(this.props.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,c("FBRTCHangupReason").HANGUP_CALL,"BrowserClosed")}.bind(this))};q.prototype.render=function(){var r=this.state,s=r.participants,t=r.remoteUsers,u=r.thread;if(!s)return null;if(!u&&!c("RTCUtils").isMessengerCall(this.props.conferenceName)&&!c("RTCUtils").isPartiesCall(this.props.conferenceName))return null;var v=t.some(function(w){return w.hasStream()&&!w.areAllTracksMuted(w.streams.first().getVideoTracks())});return c("React").createElement("div",null,c("React").createElement(c("RTCGroupCallView.react"),{aspectRatio:this.props.aspectRatio,conferenceName:this.props.conferenceName,conferenceState:this.state.conferenceState,endCallReason:this.state.endCallReason,gridLayout:this.props.gridLayout,isAudioCall:!v,isGroupCall:c("RTCUtils").isGroupCall(this.props.conferenceName),layout:this.state.layout,localUser:this.state.localUser,onStartCallClick:this.$RTCGroupCallContainer7,participants:s,remoteUsers:t,serverInfoData:c("RTCCallStore").getState().callInfo.serverInfoData,thread:u,userMediaRequest:this.state.userMediaRequest}),c("CurrentUser").isEmployee()?c("React").createElement(c("MessengerBugNub.react"),{isBetaEnabled:this.props.isBetaEnabled,unixName:this.props.unixName}):null)};q.prototype.$RTCGroupCallContainer6=function(r,s,t,u){var v=this.props.conferenceName;u=u?u:this.props.serverInfoData;c("RTCCallActions").addLocalStream(r);var w={};if(u)w.serverInfoData=u;if(t)w.callTrigger=t;this.$RTCGroupCallContainer2.startCall(s,[r],v,w)};f.exports=c("FluxContainer").create(q,{withProps:true})}),null);